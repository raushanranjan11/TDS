Ext.ns("TDS.panel");TDS.panel.Standard=Ext.extend(Ext.Panel,{border:false,layout:"card",activeItem:0,initComponent:function(){Ext.apply(this,{interfaces:new Ext.util.MixedCollection()});this.addEvents("beforeinit","ready","viewready");this.fireEvent("beforeinit",this);var a=this.sbar;var d=[];if(a){delete this.sbar;for(var b=0;b<a.length;b++){var c=a[b];c.xtype="button";d.push(c);if(c.selected){this.selected=c.name}this.interfaces.add(c.name,{interfaceURI:c.interfaceURI,index:false})}}this.tbar=d;this.on("add",this.onAdd);TDS.panel.Standard.superclass.initComponent.apply(this,arguments)},addInterface:function(c){var a=this.getTopToolbar().addButton(Ext.apply(c,{xtype:"button"}));a.on("click",this.onButtonClick,this);this.interfaces.add(c.name,{interfaceURI:c.interfaceURI,index:false})},onRender:function(){TDS.panel.Standard.superclass.onRender.apply(this,arguments);this.initSession();this.initButtons()},getAjaxPanel:function(){if(!this.ajaxpanel){this.ajaxpanel=this.findParentByType("ajaxpanel")}return this.ajaxpanel},getSession:function(a){if(a){return this.getAjaxPanel().sessionObj[a]}else{return this.getAjaxPanel().sessionObj}},getSessionValue:function(a){return this.getSession(a)},getSessionData:function(){return this.getSession()},getDataURI:function(){return this.getAjaxPanel().dataURI},getSessionURI:function(){return this.getAjaxPanel().sessionURI},initSession:function(){var a=this.getSession();if(a){if(a.view){this.selected=a.view}}},initButtons:function(){this.getTopToolbar().items.each(function(a){if(a.xtype=="button"){a.on("click",this.onButtonClick,this)}},this)},afterRender:function(){this.toggleButton(this.selected);this.initInterface(this.selected);TDS.panel.Standard.superclass.afterRender.apply(this,arguments);this.fireEvent("ready",this)},initInterface:function(a){var c=this.interfaces.get(a);if(typeof c!="undefined"){var b=this.add({xtype:"ajaxpanel",name:a,layout:"fit",border:false,autoLoadPanel:true,baseDataURI:this.getDataURI(),interfaceURI:c.interfaceURI,sessionURI:this.getSessionURI()+"/"+a})}},toggleButton:function(a){this.getTopToolbar().items.each(function(b){if(b.xtype=="button"){if(b.name==a){b.toggle(true)}else{b.toggle(false)}}})},displayInterface:function(a){var c=this.interfaces.get(a);if(typeof c.index=="number"){var b=this.getComponent(c.index);this.getLayout().setActiveItem(b.id);this.doLayout()}else{var b=this.add({xtype:"ajaxpanel",name:a,layout:"fit",border:false,autoLoadPanel:false,baseDataURI:this.getDataURI(),interfaceURI:c.interfaceURI,sessionURI:this.getSessionURI()+"/"+a});b.on("ready",function(){this.fireEvent("viewready",b,this)},this);this.getLayout().setActiveItem(b.id);this.doLayout();b.initLoad()}},onButtonClick:function(a,b){if(typeof a.name!="undefined"){if(a.pressed){a.toggle(true);return}this.toggleButton(a.name);this.displayInterface(a.name);TDS.session.setByPath(this.getSessionURI(),{view:a.name})}},onViewReady:function(){this.fireEvent("viewready",this)},onAdd:function(b,d,a){var c=this.interfaces.get(d.name);if(typeof c!="undefined"){c.index=a}},focusView:function(b,a){this.toggleButton(b,a);this.displayInterface(a)},getView:function(){return this.getLayout().activeItem},isViewRendered:function(a){var b=this.interfaces.get(a);if(typeof b.index=="number"){return true}return false}});Ext.reg("stdpanel",TDS.panel.Standard);