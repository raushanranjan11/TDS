Ext.form.AwesomeComboBox=Ext.extend(Ext.form.ClearableComboBox,{minChars:3,requestInProgress:false,hideTrigger:true,emptyText:"Type a name...",queryParam:"nameLike",queryDelay:500,forceSelection:true,initComponent:function(){Ext.form.AwesomeComboBox.superclass.initComponent.call(this);this.addEvents("beforesearch");Ext.apply(this,this.initialConfig);if(!this.store){this.store=new Ext.data.CollectionStore({url:"",id:"dataURI",fields:["dataURI","name"]});this.valueField="dataURI";this.displayField="name"}this.on("beforequery",this.onBeforeQuery,this)},onBeforeQuery:function(qe){var sc={searchURI:this.searchURI,searchIdentifier:this.searchIdentifier,cancel:false};if(this.fireEvent("beforesearch",sc)===false||sc.cancel){return false}var store=this.getStore();with(store){proxy.conn.url=sc.searchURI;reader.meta.identifier=sc.searchIdentifier+"?"+this.queryParam+"="+escape(qe.query);proxy.conn.method="GET"}},setValue:function(b){Ext.form.AwesomeComboBox.superclass.setValue.apply(this,arguments);if(b==""){return}var a=this.getStore().getById(b);if(typeof a=="undefined"){this.clearValue();this.resourceURI=b;this.getResource()}},getResource:function(){if(this.requestInProgress){return}this.requestInProgress=true;Ext.Ajax.request({method:"GET",url:TDS.env.dataPath+this.resourceURI,callback:this.resourceResponse,scope:this})},resourceResponse:function(g,b,d){if(b){try{var c=Ext.decode(d.responseText)}catch(f){}this.requestInProgress=false;var h=this.getStore().recordType;c.dataURI=this.resourceURI;var a=new h(c,c.dataURI);this.getStore().add(a);this.setValue(this.resourceURI)}}});Ext.reg("awesomecombo",Ext.form.AwesomeComboBox);