Ext.ns("TDS.panel");TDS.panel.PassengerNameRecord=Ext.extend(Ext.Panel,{border:false,layout:"card",activeItem:0,initComponent:function(){Ext.apply(this,{interfaces:new Ext.util.MixedCollection()});this.addEvents("ready","viewready");var a=this.sbar;var f=[],g=[];if(a){delete this.sbar;for(var d=0;d<a.length;d++){var e=a[d];e.xtype="button";e.text="<b>"+e.text+"</b>";f.push(e);if(a[d].items){for(var b=0;b<a[d].items.length;b++){var e=a[d].items[b];if(!typeof e.groupPermission&&!TDS.env.user.hasGroupPermission(e.groupPermission)){continue}e.parentName=a[d].name;if(e.name=="bookingSummary"){e.cls="x-button-orange";e.overCls="x-button-orange-over";e.xtype="redbutton"}else{e.xtype="button"}g.push(e);if(e.selected){this.selected={parentName:e.parentName,name:e.name}}this.interfaces.add(e.name,{interfaceURI:e.interfaceURI,index:false})}delete a[d].items}}}f.push("-");f=f.concat(g);this.tbar=f;this.on("add",this.onAdd);TDS.panel.PassengerNameRecord.superclass.initComponent.apply(this,arguments)},onRender:function(){TDS.panel.PassengerNameRecord.superclass.onRender.apply(this,arguments);this.initSession();this.initButtons()},getAjaxPanel:function(){if(!this.ajaxpanel){this.ajaxpanel=this.findParentByType("ajaxpanel")}return this.ajaxpanel},getSession:function(a){if(a){return this.getAjaxPanel().sessionObj[a]}else{return this.getAjaxPanel().sessionObj}},getSessionValue:function(a){return this.getSession(a)},getSessionData:function(){return this.getSession()},getDataURI:function(){return this.getAjaxPanel().dataURI},getSessionURI:function(){return this.getAjaxPanel().sessionURI},initSession:function(){var a=this.getSession();if(a){if(a.view){this.selected.parentName=a.view}if(a.option){this.selected.name=a.option}}},initButtons:function(){this.getTopToolbar().items.each(function(a){if(a.xtype=="button"||a.xtype=="redbutton"){a.on("click",this.onButtonClick,this)}},this)},afterRender:function(){this.toggleButton(this.selected.parentName,this.selected.name);this.initInterface(this.selected.name);TDS.panel.PassengerNameRecord.superclass.afterRender.apply(this,arguments);this.fireEvent("ready",this)},initInterface:function(a){var c=this.interfaces.get(a);var b=this.add({xtype:"ajaxpanel",name:a,layout:"fit",border:false,autoLoadPanel:true,baseDataURI:this.getDataURI(),interfaceURI:c.interfaceURI,sessionURI:this.getSessionURI()+"/"+a})},toggleButton:function(b,a){this.getTopToolbar().items.each(function(c){if(c.xtype=="button"||c.xtype=="redbutton"){if(typeof c.parentName=="undefined"){if(c.name==b){c.toggle(true)}else{c.toggle(false)}}else{if(c.parentName==b){c.show();if(c.name==a){c.toggle(true)}else{c.toggle(false)}}else{c.hide()}}}})},displayInterface:function(a){var c=this.interfaces.get(a);if(typeof c!="undefined"&&typeof c.index!="undefined"&&typeof c.index=="number"){var b=this.getComponent(c.index);this.getLayout().setActiveItem(b.id);this.doLayout()}else{var b=this.add({xtype:"ajaxpanel",name:a,layout:"fit",border:false,autoLoadPanel:false,baseDataURI:this.getDataURI(),interfaceURI:c.interfaceURI,sessionURI:this.getSessionURI()+"/"+a});b.on("ready",function(){this.fireEvent("viewready",b,this)},this);this.getLayout().setActiveItem(b.id);this.doLayout();b.initLoad()}},onButtonClick:function(a,b){if(typeof a.parentName!="undefined"){if(a.pressed){a.toggle(true);return}this.toggleButton(a.parentName,a.name);this.displayInterface(a.name);TDS.session.setByPath(this.getSessionURI(),{view:a.parentName,option:a.name})}else{this.toggleButton(a.name)}},onViewReady:function(){this.fireEvent("viewready",this)},onAdd:function(b,d,a){var c=this.interfaces.get(d.name);if(typeof c!="undefined"){c.index=a}},focusView:function(b,a){this.toggleButton(b,a);this.displayInterface(a)},getView:function(){return this.getActiveView()},getActiveView:function(){return this.getLayout().activeItem},getViewByName:function(a){if(a&&this.isViewRendered(a)){var b=this.interfaces.get(a);return this.items.itemAt(b.index)}return false},isViewRendered:function(a){var b=this.interfaces.get(a);if(typeof b!="undefined"&&typeof b.index!="undefined"&&typeof b.index=="number"){return true}return false}});Ext.reg("pnrpanel",TDS.panel.PassengerNameRecord);