Ext.ns("TDS.panel");TDS.panel.Price=Ext.extend(Ext.Panel,{border:false,hideBorders:true,getField:function(c){var a=this.ownerCt.findParentByType("form");var b=a.getForm().findField(c);if(b){return b}},calculateCommission:function(b){if(b){var a=(this.getField("pricingPriceCommissionPercentage").getValue()/100)*this.getField("pricingPriceSell").getValue();if(!isNaN(a)){this.getField("pricingPriceCommission").setValue(a.toFixed(2))}}else{var a=(this.getField("pricingPriceCommission").getValue()*100)/this.getField("pricingPriceSell").getValue();if(!isNaN(a)){this.getField("pricingPriceCommissionPercentage").setValue(a.toFixed(2))}}var c=this.getField("pricingPriceSell").getValue()-this.getField("pricingPriceCommission").getValue();this.getField("pricingPriceNett").setValue(c.toFixed(2))},initComponent:function(){TDS.panel.Price.superclass.initComponent.apply(this,arguments);this.add({xtype:"fieldset",collapsed:false,title:"Pricing",autoHeight:true,hideBorders:true,defaults:{xtype:"panel",layout:"table",bodyStyle:"padding: 2px;",layoutConfig:{columns:6}},items:[{items:[{xtype:"combo",forceSubmit:true,name:"pricingPriceIsNett",mode:"local",width:60,listWidth:59,triggerAction:"all",editable:false,value:"false",store:[["false","Gross"],["true","Nett"]],updateInterface:function(f){var e=this.ownerCt.ownerCt.items.itemAt(1);var c=this.ownerCt.items.itemAt(3);var d=this.ownerCt.items.itemAt(5);var b=0;if(f=="true"){e.items.itemAt(1).setValue();e.items.itemAt(3).setValue();this.ownerCt.items.itemAt(3).setValue(b.toFixed(2));e.hide();c.hide();d.show()}else{this.ownerCt.items.itemAt(5).setValue("false");if(e.items.itemAt(1).getValue()==""){e.items.itemAt(3).setValue()}this.ownerCt.items.itemAt(3).setValue(this.ownerCt.items.itemAt(2).getValue()!=""?parseInt(this.ownerCt.items.itemAt(2).getValue()).toFixed(2):b.toFixed(2));e.show();c.show();d.hide()}},listeners:{select:function(d,b,a){this.updateInterface(b.get("value"))},render:function(){this.updateInterface(this.getValue())}}},{xtype:"label",style:"padding: 0 2px 0 6px;",html:TDS.util.Price.formatCurrency(this.currency)},{xtype:"textfield",forceSubmit:true,name:"pricingPriceSell",width:60,enableKeyEvents:true,listeners:{keyup:function(){var a=this.ownerCt.ownerCt.ownerCt;a.calculateCommission()}}},{xtype:"label",name:"pricingPriceNett",allowHTML:true,style:"padding: 0 4px;",textPrefix:"(nett "+TDS.util.Price.formatCurrency(this.currency)+" ",textSuffix:")",setText:function(a,b){this.text=a;a=this.textPrefix+a+this.textSuffix;if(this.rendered){this.el.dom.innerHTML=b!==false?Ext.util.Format.htmlEncode(a):a}return this},isFormField:true,getName:function(){return this.name},setValue:function(b){var a=this.allowHTML?false:true;this.setText(b,a)},isDirty:function(){return false},getValue:Ext.emptyFn,clearInvalid:Ext.emptyFn},{xtype:"label",style:"padding: 0 2px 0 6px;"},{xtype:"combo",labelStyle:"padding-left: 10px;",listWidth:59,forceSubmit:true,name:"priceIsCredit",mode:"local",width:60,triggerAction:"all",editable:false,value:"false",store:[["false","Debit"],["true","Credit"]]}]},{items:[{xtype:"label",style:"padding-right: 2px;",html:"Commission  Amount"+TDS.util.Price.formatCurrency(this.currency)},{xtype:"textfield",forceSubmit:true,name:"pricingPriceCommission",width:60,enableKeyEvents:true,listeners:{keyup:function(){var a=this.ownerCt.ownerCt.ownerCt;a.calculateCommission()}}},{xtype:"label",style:"padding: 0 4px;",text:"or"},{xtype:"textfield",forceSubmit:true,name:"pricingPriceCommissionPercentage",width:40,enableKeyEvents:true,listeners:{keyup:function(){var a=this.ownerCt.ownerCt.ownerCt;a.calculateCommission(true)}}},{xtype:"label",style:"padding-left: 4px;",text:"%",listeners:{render:function(){var a=this.ownerCt.ownerCt.ownerCt;a.calculateCommission()}}}]}]})}});Ext.reg("pricepanel",TDS.panel.Price);