Ext.tree.DynamicTreeLoader=Ext.extend(Ext.tree.TreeLoader,{setDataUrl:function(a){this.dataUrl=a},getDataUrl:function(){return this.dataUrl},requestData:function(b,c){var a=this.dataUrl||this.url;if(b.attributes.baseDataURI){a+="/"+b.attributes.baseDataURI}if(b.attributes.isChild){a+="/children"}if(this.fireEvent("beforeload",this,b,c)!==false){this.transId=Ext.Ajax.request({method:this.requestMethod,url:a,success:this.handleResponse,failure:this.handleFailure,scope:this,argument:{callback:c,node:b},params:this.getParams(b)})}else{if(typeof c=="function"){c()}}},processResponse:function(response,node,callback){var json=response.responseText;try{var o=eval("("+json+")");node.beginUpdate();var nodes=[];for(var n in o){var record=TDS.data.permissions.getById(n.substring(6));node.appendChild({text:record.get("name"),leaf:false,baseDataURI:n,isChild:true,checked:o[n]})}node.endUpdate();if(typeof callback=="function"){callback(this,node)}}catch(e){this.handleFailure(response)}}});