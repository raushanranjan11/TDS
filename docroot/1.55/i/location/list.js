{xtype:"panel",layout:"fit",border:false,bodyStyle:"padding: 8px;",autoScroll:true,requireStores:[{dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["name","dataURI"]}],items:[{hidden:true,xtype:"awesomegrid",searchURI:"",pinnable:false,enableRowExpander:false,iconCls:"icon-grid",getDataURI:function(){if(TDS.env.user.hasGroupPermission("ADMINISTRATION")||TDS.env.user.hasGroupPermission("UPLOAD_ADMINISTRATION")){var a=this.getTopToolbar();var b=a.items.itemAt(0);return b.getValue()+"/locations"}},appendQueryParams:{manual:true},tbar:[{xtype:"awesomecombo",name:"countryFromCode",emptyText:"Type a country...",minChars:1,enableKeyEvents:true,mode:"local",width:120,hidden:true,typeAhead:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"name",valueField:"dataURI",listeners:{select:function(b){var a=this.ownerCt.items.itemAt(2);a.setValue("")}},store:TDS.data.getStore({dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["name","dataURI"]})}," ",{xtype:"awesomecombo",name:"provinceURI",hidden:true,emptyText:"Type a province...",excludeFromSession:true,hideTrigger:false,listeners:{beforesearch:function(c){var b=this.ownerCt;var a=b.items.itemAt(0);if(a.getValue()==""){a.markInvalid("Please select a country.");return false}c.searchURI=TDS.env.dataPath+a.getValue()+"/provinces/collection";c.searchIdentifier=a.getValue()+"/provinces"}}}," ",{xtype:"textfield",name:"nameLike",hidden:true,enableKeyEvents:true,width:120}," ",{xtype:"checkbox",name:"isNew",hidden:true,enableKeyEvents:true,boxLabel:"New only",width:120},"->",{xtype:"redbutton",text:"Create",handler:function(){var e=this.ownerCt.ownerCt;var c=e.getDataURI();var b=e.getDataURI();var d=this.ownerCt.ownerCt.ownerCt.items.items[1].getSelectionModel().getSelected();var a=d.data.dataURI;if(!c){return}TDS.window.setWindow({title:"Location details",information:"Please enter details of a new location.",interfaceURI:"location/externalLocation/create.js",postDataURI:c+"/"+a+"/external",callback:{fn:function(f){if(f){e.submitQuery(true)}},scope:e}})}}," ",{xtype:"button",text:"Back to Cities",value:"rate",firstClick:true,id:"bt1",handler:function(){this.ownerCt.ownerCt.ownerCt.items.items[0].hide();this.ownerCt.ownerCt.ownerCt.items.items[1].show()}}],store:new Ext.data.JsonStore({url:"",id:"dataURI",fields:["dataURI","locationName","provinceName","latitude1","longitude1","hotusa1","hotusaCode1","externalCountryId","externalProvince","externalUni","supplierName","externalProvince2","externalCountryid2","externalUni2"]}),sm:new Ext.grid.RowSelectionModel(),cm:new Ext.grid.ColumnModel([{header:"Name",dataIndex:"locationName"},{header:"Province",dataIndex:"provinceName",renderer:function(c,b,a){return c}},{header:"External Country1",dataIndex:"externalCountryId"},{header:"External Province1",dataIndex:"externalProvince"},{header:"External Location1",dataIndex:"externalUni"},{header:"External Country2",dataIndex:"externalCountryid2"},{header:"External Province2",dataIndex:"externalProvince2"},{header:"External Location2",dataIndex:"externalUni2"},{header:"Supplier",dataIndex:"supplierName"}]),viewConfig:{forceFit:true},listeners:{beforequery:function(a){},render:function(){},rowdblclick:function(c,f,d){;var b=c.getStore().getAt(f);var a=b.data.dataURI;var a="location/"+a;TDS.window.setWindow({title:"Location details",interfaceURI:"location/externalLocation/edit.js",sourceDataURI:a,destinationDataURI:a,callback:{fn:c.submitQuery,scope:c}})}}},{xtype:"awesomegrid",searchURI:"",pinnable:false,enableRowExpander:false,iconCls:"icon-grid",getDataURI:function(){if(TDS.env.user.hasGroupPermission("ADMINISTRATION")||TDS.env.user.hasGroupPermission("UPLOAD_ADMINISTRATION")){var a=this.getTopToolbar();var b=a.items.itemAt(1);return b.getValue()+"locations"}},appendQueryParams:{manual:true},tbar:["Country: ",{xtype:"awesomecombo",name:"countryFromCode",emptyText:"Type a country...",minChars:1,enableKeyEvents:true,mode:"local",width:120,typeAhead:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"name",valueField:"dataURI",listeners:{select:function(b){var a=this.ownerCt.items.itemAt(3);a.setValue("")}},store:TDS.data.getStore({dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["name","dataURI"]})},"Province ",{xtype:"awesomecombo",name:"provinceURI",emptyText:"Type a province...",excludeFromSession:true,hideTrigger:false,listeners:{beforesearch:function(c){var b=this.ownerCt;var a=b.items.itemAt(1);if(a.getValue()==""){a.markInvalid("Please select a country.");return false}c.searchURI=TDS.env.dataPath+a.getValue()+"/provinces/collection";c.searchIdentifier=a.getValue()+"/provinces"}}}," ","City: ",{xtype:"textfield",name:"nameLike",enableKeyEvents:true,width:120}," ",{xtype:"checkbox",name:"isNew",enableKeyEvents:true,boxLabel:"New only",width:120},"->",{xtype:"redbutton",text:"Create",handler:function(){var b=this.ownerCt.ownerCt;var a=b.getDataURI();if(!a){return}TDS.window.setWindow({title:"Location details",information:"Please enter details of a new location.",interfaceURI:"location/create.js",postDataURI:a,callback:{fn:function(c){if(c){b.submitQuery(true)}},scope:b}})}}," ",{xtype:"button",text:"External Cities",value:"rate",firstClick:true,disabled:true,handler:function(){;var c=this;this.ownerCt.ownerCt.ownerCt.items.items[0].show();this.ownerCt.ownerCt.ownerCt.items.items[1].hide();var d=this.ownerCt.ownerCt.ownerCt.items.items[1].getSelectionModel().last;var e=this.ownerCt.ownerCt.ownerCt.items.items[1].getSelectionModel().getSelected();var b=e.data.dataURI;this.ownerCt.ownerCt.ownerCt.items.items[0].searchURI=this.ownerCt.ownerCt.ownerCt.items.items[1].searchURI+"/"+b+"/external";this.ownerCt.ownerCt.ownerCt.items.items[0].submit()}}],store:new Ext.data.JsonStore({url:"",id:"dataURI",fields:["dataURI","name","locationName","provinceName","latitude","longitude","hotusa","hotusaCode","active"]}),cm:new Ext.grid.ColumnModel([{header:"Name",dataIndex:"name"},{header:"Province",dataIndex:"provinceName",renderer:function(c,b,a){if(a.get("name")==""){}if(a.get("hotusa")){return c}}},{header:"Latitude",dataIndex:"latitude"},{header:"Longitude",dataIndex:"longitude"},{header:"Active",dataIndex:"active",renderer:function(b,a){if(b){return'<input type="checkbox" checked/>'}else{return'<input type="checkbox" />'}}}]),viewConfig:{forceFit:true},listeners:{beforequery:function(a){var b=a.getTopToolbar().items.itemAt(1);if(b.getValue()==""){return false}a.setSearchURI(TDS.env.dataPath+b.getValue()+"/allLocations")},render:function(){;this.getSelectionModel().on("rowselect",function(){;var b=this;this.items.itemAt(12).setDisabled(false)},this.getTopToolbar());this.getSelectionModel().on("rowdeselect",function(){this.items.itemAt(12).setDisabled(false)},this.getTopToolbar())},rowdblclick:function(c,f,d){var b=c.getStore().getAt(f);var a=b.get("dataURI");TDS.window.setWindow({title:"Location details",interfaceURI:"location/edit.js",sourceDataURI:a,destinationDataURI:a,callback:{fn:c.submitQuery,scope:c}})}}}]}