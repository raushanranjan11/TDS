{xtype:"form",border:false,width:500,markDataDirtyOnLoad:true,beforeSubmit:function(m){var u=this.items.itemAt(0).items.itemAt(1).items.itemAt(0);var o=u.getSelections();var s=u.mainStore;var l=[];for(var r=0;r<o.length;r++){l[r]=o[r].data.dataURI}var p=[];for(var r=0;r<s.length;r++){p[r]=s[r].data.dataURI}m.selectedGroupAgents=l;m.selectedGroupAgentsOldData=p;if(m.markUpAmountApplied=="USD"){m.markUpPercentage=""}else{m.markUpAmount=""}var q=this.items.itemAt(0).items.itemAt(2).items.itemAt(0);var n=[];var i=q.getSelections();for(var r=0;r<i.length;r++){n[r]=i[r].data.dataURI}if(q.selectionsLoaded){m.exemptionAgencyURIs=n}return m},items:[{xtype:"tabpanel",activeTab:0,layoutOnTabChange:true,height:400,width:500,defaults:{bodyStyle:"padding: 6px 4px 6px 4px;"},items:[{layout:"form",title:"Details",width:300,border:false,labelWidth:80,defaults:{style:"padding: 2px 4px 2px 4px;"},autoScroll:true,items:[{xtype:"panel",border:false,layout:"table",width:400,layoutConfig:{columns:1},defaults:{border:false},items:[{name:"name",width:380,listeners:{render:function(){var a=this.ownerCt.ownerCt.ownerCt.ownerCt;var b=a.ownerCt.aw.data.name;if(b!=null&&b!=""){this.html="<center><b><u>"+b+"</u></b></center>"}}}}]},{xtype:"panel",style:"padding: 0; margin-top: 4px;",border:false,layout:"table",layoutConfig:{columns:3},defaults:{border:false},items:[{html:"&nbsp;",width:Ext.isIE?30:27},{xtype:"checkbox",name:"onMobile",forceSubmit:true,width:20},{html:"Available on Mobile",bodyStyle:"padding: 0 4px;"}]},{xtype:"panel",style:"padding: 0; margin-top: 4px;",border:false,layout:"table",layoutConfig:{columns:3},defaults:{border:false},items:[{html:"&nbsp;",width:Ext.isIE?30:27},{xtype:"checkbox",name:"mailServiceAvailable",forceSubmit:true,width:20},{html:"Mail Service Available",bodyStyle:"padding: 0 4px;"}]},{xtype:"panel",style:"padding: 0; margin-top: 4px;",border:false,layout:"table",layoutConfig:{columns:3},defaults:{border:false},items:[{html:"&nbsp;",width:Ext.isIE?30:27},{xtype:"checkbox",name:"paymentGatewayAllowed",forceSubmit:true,width:20},{html:"Payment Gateway Available",bodyStyle:"padding: 0 4px;"}]},{xtype:"panel",style:"padding: 0; margin-top: 4px; margin-bottom: 4px;",border:false,layout:"table",layoutConfig:{columns:8},defaults:{border:false},items:[{html:"&nbsp;",width:Ext.isIE?30:27},{xtype:"checkbox",name:"supplierActive",forceSubmit:true,width:20},{html:"Active Supplier",bodyStyle:"padding: 0 4px;"},{name:"activeInactiveLasrModified",listeners:{render:function(){var l=this.ownerCt.ownerCt.ownerCt.ownerCt;var m=l.ownerCt.aw.data.activeInactiveLastModified;if(m!=null&&m!=""){if(!Ext.isIE){var r=new Date(m)}else{var o=m.substring(0,4);var p=m.substring(5,7)-1;var n=m.substring(8,10);var b=m.substring(11,13);var q=m.substring(14,16);var a=m.substring(17,19);alert(o+" "+p+" "+n+" "+b+" "+q+" "+a);var r=new Date(o,p,n,b,q,a)}this.html=r.format(TDS.env.dateFormatDisplay)}else{this.html="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"}}}},{html:"&nbsp;",width:Ext.isIE?15:15},{html:" Authority Code:",bodyStyle:"padding: 0 0px;"},{xtype:"textfield",inputType:"password",allowBlank:false,name:"authorityCodeFromClint",width:100}]},{xtype:"superboxselect",name:"countriesURIs",fieldLabel:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Countries",forceSelection:true,mode:"local",width:280,triggerAction:"all",displayField:"name",valueField:"isoCode",emptyText:"countries",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["name","isoCode"]})},{xtype:"panel",style:"padding: 0; margin-top: 4px;",border:false,layout:"table",layoutConfig:{columns:2},defaults:{border:false},items:[{html:"&nbsp;",width:Ext.isIE?30:27},{html:'<hr align="left" />',width:350}]},{xtype:"panel",style:"padding: 0; margin-top: 4px;",border:false,layout:"table",layoutConfig:{columns:7},defaults:{border:false},items:[{html:"&nbsp;",width:Ext.isIE?30:27},{xtype:"checkbox",name:"transactionFeeApplied",forceSubmit:true,width:20},{html:"Set Transaction fee",width:130,bodyStyle:"padding: 0 4px;"},{html:"&nbsp;",width:10},{html:"US$",width:30},{xtype:"numberfield",forceSubmit:true,name:"transactionFee",width:50},{name:"activeInactiveLasrModified",listeners:{render:function(){var l=this.ownerCt.ownerCt.ownerCt.ownerCt;var m=l.ownerCt.aw.data.activeInactiveLastModified;if(m!=null&&m!=""){if(!Ext.isIE){var r=new Date(m)}else{var o=m.substring(0,4);var p=m.substring(5,7)-1;var n=m.substring(8,10);var b=m.substring(11,13);var q=m.substring(14,16);var a=m.substring(17,19);alert(o+" "+p+" "+n+" "+b+" "+q+" "+a);var r=new Date(o,p,n,b,q,a)}this.html="&nbsp;&nbsp;"+r.format(TDS.env.dateFormatDisplay)}}}}]},{xtype:"panel",style:"padding: 0; margin-top: 4px;",border:false,layout:"table",layoutConfig:{columns:1},defaults:{border:false},items:[{html:"&nbsp;",height:10,width:Ext.isIE?30:27}]},{xtype:"panel",style:"padding: 0; margin-top: 4px;",border:false,layout:"table",layoutConfig:{columns:7},defaults:{border:false},items:[{html:"&nbsp;",width:Ext.isIE?30:27},{xtype:"radio",name:"markUpAmountApplied",inputValue:"USD",forceSubmit:true,width:20},{html:"Markup Amount on Net",width:130,bodyStyle:"padding: 0 4px;"},{html:"&nbsp;",width:10},{html:"US$",width:30},{xtype:"numberfield",name:"markUpAmount",forceSubmit:true,width:50},{name:"activeInactiveLasrModified",listeners:{render:function(){var l=this.ownerCt.ownerCt.ownerCt.ownerCt;var m=l.ownerCt.aw.data.activeInactiveLastModified;if(m!=null&&m!=""){if(!Ext.isIE){var r=new Date(m)}else{var o=m.substring(0,4);var p=m.substring(5,7)-1;var n=m.substring(8,10);var b=m.substring(11,13);var q=m.substring(14,16);var a=m.substring(17,19);alert(o+" "+p+" "+n+" "+b+" "+q+" "+a);var r=new Date(o,p,n,b,q,a)}this.html="&nbsp;&nbsp;"+r.format(TDS.env.dateFormatDisplay)}}}}]},{xtype:"panel",style:"padding: 0; margin-top: 4px;",border:false,layout:"table",layoutConfig:{columns:7},defaults:{border:false},items:[{html:"&nbsp;",width:Ext.isIE?30:27},{xtype:"radio",name:"markUpAmountApplied",inputValue:"PERCENTAGE",forceSubmit:true,width:20},{html:"Markup Percentage on Net",width:150,bodyStyle:"padding: 0 4px;"},{html:"&nbsp;",width:10},{html:" ",width:10},{xtype:"numberfield",name:"markUpPercentage",forceSubmit:true,width:50},{name:"activeInactiveLasrModified",listeners:{render:function(){var m=this.ownerCt.ownerCt.ownerCt.ownerCt;var n=m.ownerCt.aw.data.activeInactiveLastModified;var u=m.ownerCt.aw.data.markUpPercentage;if(u!=null&&u!=""&&typeof u!="undefined"){this.ownerCt.items.itemAt(1).setValue(true)}else{this.ownerCt.ownerCt.items.itemAt(9).items.itemAt(1).setValue(true)}if(n!=null&&n!=""){if(!Ext.isIE){var s=new Date(n)}else{var p=n.substring(0,4);var q=n.substring(5,7)-1;var o=n.substring(8,10);var b=n.substring(11,13);var r=n.substring(14,16);var a=n.substring(17,19);alert(p+" "+q+" "+o+" "+b+" "+r+" "+a);var s=new Date(p,q,o,b,r,a)}this.html="&nbsp;&nbsp;"+s.format(TDS.env.dateFormatDisplay)}}}}]},{xtype:"panel",style:"padding: 0; margin-top: 4px;",border:false,layout:"table",layoutConfig:{columns:7},defaults:{border:false},items:[{html:"&nbsp;",width:Ext.isIE?30:27},{xtype:"checkbox",name:"adminMaintainedExcRate",forceSubmit:true,width:20},{html:" Edit FX Rates",width:130,bodyStyle:"padding: 0 4px;"}]},{xtype:"panel",style:"padding: 0; margin-top: 4px;",border:false,layout:"table",layoutConfig:{columns:7},defaults:{border:false},items:[{html:"&nbsp;",width:Ext.isIE?30:27},{xtype:"checkbox",name:"suplierOwnTC",forceSubmit:true,width:20},{html:"Suplier Own T&C",width:130,bodyStyle:"padding: 0 4px;"}]},{xtype:"panel",style:"padding: 0; margin-top: 4px;",border:false,layout:"table",layoutConfig:{columns:1},defaults:{border:false},items:[{html:"&nbsp;",height:10,width:Ext.isIE?30:27}]},{xtype:"panel",style:"padding: 0; margin-top: 4px;",border:false,layout:"table",layoutConfig:{columns:2},defaults:{border:false},items:[{html:"&nbsp;",width:Ext.isIE?30:27},{html:'<hr align="left" />',width:350}]},{xtype:"panel",style:"padding: 0; margin-top: 4px;",border:false,layout:"table",layoutConfig:{columns:3},defaults:{border:false},items:[{html:"&nbsp;",height:30,width:Ext.isIE?78:75},{html:"Signed up by:",bodyStyle:"padding: 0 4px;"},{xtype:"textfield",name:"createdByUserFullNameString",width:200,style:"border:#FFFFFF; display:compact; font:Verdana; background: none;"}]}]},{title:"Agency Groups",hidden:true,layout:"form",width:300,items:[{xtype:"grid",width:400,height:320,border:true,enableColumnHide:false,enableColumnMove:false,enableColumnResize:false,enableHdMenu:false,viewConfig:{forceFit:true},store:new Ext.data.JsonStore({id:"dataURI",fields:["dataURI","pinned","agencyArenaCode","name","locality","state","postcode","countryURI","homeCurrency","phoneNumber","email","createdDate","updatedDate","status","selected"],data:[["Gokul","30"],["Vinay","99"],["Bhai","100"],["Lalit","75"]]}),mainStore:new Ext.data.JsonStore({id:"dataURIOld",fields:["dataURI","pinned","agencyArenaCode","name","locality","state","postcode","countryURI","homeCurrency","phoneNumber","email","createdDate","updatedDate","status","selected"]}),sm:new Ext.grid.CheckboxSelectionModel(),columns:[new Ext.grid.CheckboxSelectionModel(),{header:"Group name",dataIndex:"name",width:200}],listeners:{render:function(){var d=this;var a=this.ownerCt.items.itemAt(1).items.itemAt(0);this.getSelectionModel().on("rowselect",function(){if(d.selModel.selections.length!=1&&a.getValue()){Ext.Msg.alert("Info Alert","Only one Agency Group should be selected for Special supplier.",function(){a.setValue(false)})}},this);this.getSelectionModel().on("rowdeselect",function(){if(t.selModel.selections.length!=1&&a.getValue()){Ext.Msg.alert("Info Alert","Only one Agency Group should be selected for Special supplier.",function(){a.setValue(false)})}},this)},beforerender:function(){var f=this.ownerCt.ownerCt.ownerCt.ownerCt.initialConfig.sourceDataURI;var d=TDS.env.dataPath+f+"/adminAgency/collection";Ext.Ajax.request({url:d,method:"GET",callback:function e(a,o,m){var n=Ext.util.JSON.decode(m.responseText);var b=n.adminAgencies;if(typeof b=="undefined"){return}var c=[];for(var p=0;p<b.length;p++){n[b[p]].dataURI=b[p];c.push(n[b[p]])}var i=this.store;i.loadData(c);for(var p=0;p<i.data.items.length;p++){if(i.data.items[p].data.selected){this.getSelectionModel().selectRow(p,true,false)}}this.mainStore=this.getSelections()},scope:this})}}},{xtype:"panel",style:"padding: 0; margin-top: 4px;",border:false,layout:"table",layoutConfig:{columns:1},defaults:{border:false},items:[{xtype:"checkbox",name:"specialSupplier",inputValue:"true",boxLabel:"Specai supplier",listeners:{change:function(h,f){var a=this;if(f){var g=this.ownerCt.ownerCt.items.itemAt(0);if(g.selModel.selections.length!=1){Ext.Msg.alert("Info Alert","Only one Agency Group should be selected for Special supplier.",function(){a.setValue(false)})}}}}}]}]},{title:"Agency Execptions",layout:"form",width:300,items:[{xtype:"grid",width:400,height:320,border:true,enableColumnHide:false,enableColumnMove:false,enableColumnResize:false,selectionsLoaded:false,enableHdMenu:false,viewConfig:{forceFit:true},store:TDS.data.getStore({dataURI:TDS.env.dataPath+"agencies/collection",identifier:"agencies",fields:["name","dataURI"]}),sm:new Ext.grid.CheckboxSelectionModel(),columns:[new Ext.grid.CheckboxSelectionModel(),{header:"Group name",dataIndex:"name",width:200}],listeners:{beforerender:function(){},render:function(){var i=this.ownerCt.ownerCt.ownerCt.ownerCt.aw.data;var j=i.exemptionAgencyURIs;var h=j.split(",");var f=this.store;var g=this;setTimeout(function(){g.selectionsLoaded=true;for(var a=0;a<f.data.items.length;a++){if(h.indexOf(f.data.items[a].data.dataURI)!=-1){g.getSelectionModel().selectRow(a,true,false)}}},500)}}}]}]}]}