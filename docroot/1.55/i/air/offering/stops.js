{xtype:"panel",border:false,height:300,getButtonAdd:function(){return this.getBottomToolbar().items.itemAt(2)},getButtonRemove:function(){return this.getBottomToolbar().items.itemAt(4)},getFieldAirport:function(){return this.getBottomToolbar().items.itemAt(0)},getGrid:function(){return this.items.itemAt(0).items.itemAt(0)},beforeSubmit:function(a){return this.getGrid().getData()},items:[{xtype:"fieldset",layout:"fit",height:260,items:{xtype:"grid",store:new Ext.data.CollectionStore({url:"",id:"dataURI",fields:["dataURI","name","code"]}),sm:new Ext.grid.RowSelectionModel({singleSelect:true}),cm:new Ext.grid.ColumnModel([{dataIndex:"name",renderer:function(c,b,a){return a.get("name")+" ("+a.get("code")+")"}}]),hideHeaders:true,viewConfig:{forceFit:true},toggleButtonRemove:function(a){var b=this.ownerCt.ownerCt;if(a){b.getButtonRemove().enable()}else{b.getButtonRemove().disable()}},enableButtonRemove:function(){this.toggleButtonRemove(true)},disableButtonRemove:function(){this.toggleButtonRemove(false)},getData:function(){var a=[];this.getStore().each(function(b){a.push(b.get("dataURI"))},this);return a},listeners:{render:function(){var w=this.ownerCt.findParentByType("awesomewindow");var store=this.getStore();with(store){proxy.conn.url=TDS.env.dataPath+w.getConfigValue("destinationDataURI")+"/collection";reader.meta.identifier=w.getConfigValue("destinationDataURI")}store.loadData(w.getData());this.getSelectionModel().on("rowselect",this.enableButtonRemove,this);this.getSelectionModel().on("rowdeselect",this.disableButtonRemove,this)}}}}],bbar:[{xtype:"airportcombo",name:"airportStopURI",fieldLabel:"Stop",width:200,getSelectedRecord:function(){return this.selectedRecord||-1},listeners:{select:function(c,b,a){this.selectedRecord=b;var d=this.ownerCt.ownerCt;d.getButtonAdd().enable()}}}," ",{xtype:"button",text:"Add",disabled:true,handler:function(){var b=this.ownerCt.ownerCt;var a=b.getFieldAirport().getSelectedRecord();var c=b.getGrid().getStore().find("dataURI",a.get("dataURI"));if(c==-1&&a!=-1){b.getGrid().getStore().add(a)}this.disable()}}," ",{xtype:"button",text:"Remove",disabled:true,handler:function(){var b=this.ownerCt.ownerCt.getGrid();var a=b.getSelectionModel().getSelected();if(a!=-1){b.getStore().remove(a)}this.disable()}}]}