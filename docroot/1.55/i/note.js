{xtype:"form",border:false,id:"forms",items:[{xtype:"checkbox",name:"sendToSupplier",hidden:true,fieldLabel:"Send to supplier"},{xtype:"checkbox",name:"sendToAgent",hidden:true,fieldLabel:"Send to consultant"},{xtype:"checkbox",name:"pnrNote",fieldLabel:"PNR-Note",listeners:{check:function(b,a){if(a){Ext.getCmp("html").setValue();Ext.getCmp("html").setValue("<center><u>PNR-Notes</u></center><br>")}else{Ext.getCmp("html").setValue()}}}},{xtype:"htmleditor",id:"html",name:"note",height:200,hideLabel:true,labelSeparator:"",anchor:"100%",enableLinks:false,enableLists:true,enableSourceEdit:false,enableFontSize:false,enableFont:false,enableColors:false,enableAlignments:false,listeners:{render:function(){}}}],listeners:{render:function(){var c=this.items.itemAt(0);var e=this.items.itemAt(1);if(TDS.env.user.isSupplier()){e.show()}else{if(TDS.env.user.isAgencyUser()){c.show()}}var d=this.findParentByType("awesomewindow").aw.dataURI.component;Ext.Ajax.request({url:TDS.env.dataPath+d+"/messages/collection",method:"GET",success:function(a,h){var g=Ext.decode(a.responseText);var k=g[d+"/messages"];if(typeof k=="undefined"){return}var j=[];var f="";for(var b=0;b<k.length;b++){g[k[b]].dataURI=k[b];if(TDS.env.user.isAgencyUser()){if(!g[k[b]].messageForAgency){f+="<p><b><u>Sent</u></b> &nbsp;&nbsp;&nbsp;"+TDS.util.Format.dateSpecial(g[k[b]].lastUpdatedDate,TDS.env.dateDayFormatDisplay)+"</p>"}else{f+="<p><b><u>Received</u></b> &nbsp;&nbsp;&nbsp;"+TDS.util.Format.dateSpecial(g[k[b]].lastUpdatedDate,TDS.env.dateDayFormatDisplay)+"</p>"}}else{if(g[k[b]].messageForAgency){f+="<p><b><u>Sent</u></b> &nbsp;&nbsp;&nbsp;"+TDS.util.Format.dateSpecial(g[k[b]].lastUpdatedDate,TDS.env.dateDayFormatDisplay)+"</p>"}else{f+="<p><b><u>Received</u></b>&nbsp;&nbsp;&nbsp;"+TDS.util.Format.dateSpecial(g[k[b]].lastUpdatedDate,TDS.env.dateDayFormatDisplay)+"</p>"}}f+="<p>"+g[k[b]].changeDescription+"</p>"}Ext.getCmp("html").setValue(f)}})}}}