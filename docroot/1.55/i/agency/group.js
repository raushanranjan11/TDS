{xtype:"panel",layout:Ext.isIE?"fit":"",autoScroll:true,bodyStyle:"padding: 8px;",border:false,getDataURI:function(){return this.getAgencyDataURI()?this.getAgencyDataURI()+"/customers":undefined},getAgencyDataURI:function(){if(TDS.env.user.hasGroupPermission("ADMINISTRATION")){var a=this.items.itemAt(0).getTopToolbar();var b=a.items.itemAt(1);if(b.getValue()){return b.getValue()}}else{if(TDS.env.user.isAgencyUser()){return TDS.env.user.getAgencyURI()}}},items:{xtype:"awesomegrid",enableRowExpander:true,alwaysUseCollection:true,tbar:["Agent:",{xtype:"combo",name:"agencyURI",mode:"local",width:160,triggerAction:"all",editable:false,displayField:"name",valueField:"dataURI",store:new Ext.data.Store(),excludeFromSession:true,toggleButtons:function(){var b=this.ownerCt.ownerCt;var a=b.ownerCt;b.searchURI=TDS.env.dataPath+a.getDataURI();this.setValue(this.getValue)}}," ","Email:",{xtype:"textfield",name:"emailLike",enableKeyEvents:true,width:150}," ","Country:",{xtype:"combo",allowBlank:false,name:"fromCountryURI",emptyText:"Type a country...",tpl:TDS.util.Templates.ComboNoLabel,minChars:1,enableKeyEvents:true,mode:"local",width:150,typeAhead:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"name",valueField:"isoCode",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["name","isoCode"]}),appendData:[{name:"",dataURI:""}]}," ","Locality:",{xtype:"textfield",enableKeyEvents:true,name:"locationFromURI",width:150,style:"margin-left: 2px;"}," ","Postcode:",{xtype:"textfield",enableKeyEvents:true,name:"postCode",width:150,style:"margin-left: 2px;"},"->",{xtype:"button",text:"Edit",disabled:true,handler:function(){var b=this.ownerCt.ownerCt;var a=b.getSelectionModel().getSelected();if(!a){return}TDS.window.setWindow({title:"Edit group",interfaceURI:"agency/group/edit.js",destinationDataURI:a.get("dataURI")+"/editGroup",record:a,buttonOK:"Submit",callback:{fn:function(c){if(c){this.submitQuery(true)}},scope:b}})}}],store:new Ext.data.JsonStore({id:"dataURI",fields:["dataURI","pinned","agencyArenaCode","name","locality","state","postcode","countryURI","homeCurrency","phoneNumber","email","createdDate","modifiedDate","status","parentDatURI","registeredDate","notes"]}),sm:new Ext.grid.RowSelectionModel({singleSelect:true}),cm:new Ext.grid.ColumnModel([{header:"Agent",dataIndex:"name",width:250,fixed:true,sortable:true},{header:"Email",dataIndex:"email",width:150,fixed:true,sortable:true},{header:"Locality",dataIndex:"locality",width:150,fixed:true,sortable:true},{header:"State",dataIndex:"state",width:120,fixed:true,sortable:true},{header:"Post Code",dataIndex:"postcode",width:100,fixed:true,sortable:true},{header:"Country",dataIndex:"countryURI",width:150,fixed:true,sortable:true,renderer:TDS.util.Format.displayResourceNameRenderer()},{header:"Phone",dataIndex:"phoneNumber",width:100,fixed:true,sortable:true},{header:"Last Modified",dataIndex:"modifiedDate",width:100,fixed:true,sortable:true,renderer:TDS.util.Format.dateSpecialRenderer(TDS.env.dateTimeFormatDisplay)},{header:"Registered",dataIndex:"registeredDate",width:100,fixed:true,sortable:true,renderer:TDS.util.Format.dateSpecialRenderer(TDS.env.dateTimeFormatDisplay)},{header:"Status",dataIndex:"status",width:70,fixed:true,sortable:true,renderer:function(b,c,a){if(a.get("status")=="A"){return"Active"}else{if(a.get("status")=="C"){return"Canceled"}else{if(a.get("status")=="S"){return"Suspend"}else{return"In Active"}}}}},{header:"active",dataIndex:"active",width:100,fixed:true,sortable:true,hidden:true},{header:"canceled",dataIndex:"canceled",width:100,fixed:true,sortable:true,hidden:true},{header:"suspend",dataIndex:"suspend",width:100,fixed:true,sortable:true,hidden:true}]),viewConfig:{forceFit:true},getRowInterface:function(){return"agency/group/layout.js"},listeners:{sessioninit:function(){var a=this.ownerCt.findParentByType("stdpanel");if(!a.getDataURI()){return}this.searchURI=TDS.env.dataPath+a.getDataURI()+"/agencysInGroup"},render:function(){if(TDS.env.user.hasGroupPermission("ADMINISTRATION")){var a=this.getTopToolbar().items.itemAt(1);a.store=TDS.data.getStore({dataURI:TDS.env.dataPath+"agencies/collection",identifier:"agencies",fields:["name","dataURI"]});a.setValue(a.getValue())}this.getSelectionModel().on("rowselect",function(){this.items.itemAt(15).setDisabled(false)},this.getTopToolbar());this.getSelectionModel().on("rowdeselect",function(){this.items.itemAt(15).setDisabled(true)},this.getTopToolbar())}}}}