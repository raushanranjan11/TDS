{xtype:"panel",layout:"fit",border:false,bodyStyle:"padding: 8px;",autoScroll:true,requireStores:[{dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["name","dataURI"]}],items:{xtype:"awesomegrid",searchURI:TDS.env.dataPath+"agencies/external",pinnable:true,enableRowExpander:false,iconCls:"icon-grid",tbar:["Name: ",{xtype:"textfield",name:"nameLike",enableKeyEvents:true,width:120}," ","Email: ",{xtype:"textfield",name:"emailLike",enableKeyEvents:true,width:120}," ","Country: ",{xtype:"clearablecombo",name:"countryURI",fieldLabel:"Country",emptyText:"Type a country...",minChars:1,enableKeyEvents:true,mode:"local",width:160,typeAhead:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"name",valueField:"dataURI",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"countries/collection/custom",identifier:"countries",fields:["name","dataURI"]})},"->",{text:"Create",handler:function(){var a=this.buttonContainer.ownerCt;TDS.window.setWindow({title:"External Agency",information:"Please enter details of a new external agency.",interfaceURI:"agency/externalAgents/create.js",postDataURI:"agency/external",callback:{fn:function(b){if(b){a.submitQuery(true)}},scope:a}})}}," ",{text:"Copy",handler:function(){var c=this.buttonContainer.ownerCt;var b=c.selModel.getSelected();if(!b){return}var a=b.get("dataURI");TDS.window.setWindow({title:"Copy external agency",information:"This interface will create a new external agency with the following details, you may edit these details before you submit.",interfaceURI:"agency/externalAgents/create.js",sourceDataURI:a,postDataURI:"agency/external",data:{email:""},buttonOK:"Submit",callback:{fn:function(d){if(d){c.submitQuery(true)}},scope:c}})}}],store:new Ext.data.JsonStore({url:"",id:"dataURI",fields:["dataURI","pinned","code","name","group","licenceNumber","postcode","countryURI","locationURI","locationString","phoneNumber","email","createdDate","updatedDate"]}),sm:new Ext.grid.RowSelectionModel(),cm:new Ext.grid.ColumnModel([{header:"Name",dataIndex:"name"},{header:"Code",dataIndex:"code",width:60,fixed:true},{header:"Email",dataIndex:"email"},{header:"Group",dataIndex:"group"},{header:"Licence No",dataIndex:"licenceNumber"},{header:"Country",dataIndex:"countryURI",sortable:true,renderer:TDS.util.Format.displayResourceNameRenderer()},{header:"City",dataIndex:"locationString",sortable:true},{header:"Phone number",dataIndex:"phoneNumber"},{header:"Registered",dataIndex:"createdDate",sortable:true,renderer:TDS.util.Format.dateSpecialRenderer(TDS.env.dateTimeFormatDisplay)},{header:"Last modified",dataIndex:"updatedDate",sortable:true,renderer:TDS.util.Format.dateSpecialRenderer(TDS.env.dateTimeFormatDisplay)}]),viewConfig:{forceFit:true},listeners:{rowdblclick:function(c,f,d){var b=c.getStore().getAt(f);if(!b){return}var a=b.get("dataURI");TDS.window.setWindow({title:"Copy external agency",information:"This interface will create a new external agency with the following details, you may edit these details before you submit.",interfaceURI:"agency/externalAgents/edit.js",sourceDataURI:a,destinationDataURI:a,buttonOK:"Submit",callback:{fn:function(e){if(e){c.submitQuery(true)}},scope:c}})}}}}