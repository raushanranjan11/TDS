{xtype:"panel",layout:Ext.isIE?"fit":"",autoScroll:true,bodyStyle:"padding: 8px;",border:false,getDataURI:function(){return this.ownerCt.ownerCt.getDataURI()},items:{xtype:"awesomegrid",alwaysUseCollection:true,tbar:["->",{xtype:"button",text:"Edit",disabled:true,handler:function(){var b=this.ownerCt.ownerCt;var a=b.getSelectionModel().getSelected();if(!a){return}if(!a.get("dataURI")){return}TDS.window.setWindow({title:"Edit exclusion",interfaceURI:"agency/exclusion/edit.js",sourceDataURI:a.get("dataURI"),destinationDataURI:a.get("dataURI"),buttonOK:"Submit",callback:{fn:function(c){if(c){this.submitQuery(true)}},scope:b}})}},{xtype:"button",text:"Remove",disabled:true,handler:function(){Ext.Msg.show({title:"Remove exclusion",msg:"This action is not irreversible, are you sure you want to remove this exclusion?",buttons:Ext.Msg.OKCANCEL,fn:this.processResult,icon:Ext.MessageBox.QUESTION,scope:this})},processResult:function(c){if(c=="ok"){var b=this.ownerCt.ownerCt;var a=b.getSelectionModel().getSelected();Ext.Ajax.request({method:"DELETE",url:TDS.env.dataPath+a.get("dataURI"),callback:function(f,d,e){if(d){b.getStore().remove(a)}}});this.items.itemAt(1).setDisabled(true);this.items.itemAt(2).setDisabled(true)}}},{xtype:"redbutton",text:"Add",handler:function(){var b=this.ownerCt.ownerCt;var a=this.ownerCt.ownerCt.ownerCt.getDataURI();if(!a){return}TDS.window.setWindow({title:"Add exclusion",interfaceURI:"agency/exclusion/create.js",postDataURI:a+"/supplierExclusions",buttonOK:"Submit",callback:{fn:function(c){if(c){this.submitQuery(true)}},scope:b}})}}],store:new Ext.data.JsonStore({id:"dataURI",fields:["dataURI","supplierURI","excludeComponentAccommodation","excludeComponentAir","excludeComponentAttraction","excludeComponentCar","excludeComponentCruise","excludeComponentHostel","excludeComponentRail","excludeComponentSightseeing","excludeComponentTransfer","excludeComponentTour","createdDate","updatedDate"]}),sm:new Ext.grid.RowSelectionModel({singleSelect:true}),cm:new Ext.grid.ColumnModel([{header:"Supplier",dataIndex:"supplierURI",width:200,fixed:true,sortable:true,renderer:TDS.util.Format.displayResourceConciseNameRenderer()},{header:"Exclusions",dataIndex:"excludeComponentAccommodation",renderer:function(c,b,a){var d=[];if(a.get("excludeComponentAccommodation")){d.push("Accommodation")}if(a.get("excludeComponentAir")){d.push("Air")}if(a.get("excludeComponentAttraction")){d.push("Services")}if(a.get("excludeComponentCar")){d.push("Car rental")}if(a.get("excludeComponentCruise")){d.push("Cruise")}if(a.get("excludeComponentHostel")){d.push("Hostel")}if(a.get("excludeComponentRail")){d.push("Rail")}if(a.get("excludeComponentSightseeing")){d.push("Sightseeing")}if(a.get("excludeComponentTour")){d.push("Tour")}if(a.get("excludeComponentTransfer")){d.push("Transfer")}return TDS.util.arrayToEnglishSentenceList(d)}},{header:"Created",dataIndex:"createdDate",width:200,fixed:true,sortable:true,renderer:TDS.util.Format.dateSpecialRenderer(TDS.env.dateTimeFormatDisplay)},{header:"Last modified",dataIndex:"updatedDate",width:200,fixed:true,sortable:true,renderer:TDS.util.Format.dateSpecialRenderer(TDS.env.dateTimeFormatDisplay)}]),viewConfig:{forceFit:true},listeners:{sessioninit:function(){var a=this.ownerCt.findParentByType("stdpanel");if(!a.getDataURI()){return}this.searchURI=TDS.env.dataPath+a.getDataURI()+"/supplierExclusions"},render:function(){this.getSelectionModel().on("rowselect",function(){this.items.itemAt(1).setDisabled(false);this.items.itemAt(2).setDisabled(false)},this.getTopToolbar());this.getSelectionModel().on("rowdeselect",function(){this.items.itemAt(1).setDisabled(true);this.items.itemAt(2).setDisabled(true)},this.getTopToolbar())}}}}