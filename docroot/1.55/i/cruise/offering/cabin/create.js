{xtype:"form",border:false,height:390,markDataDirtyOnLoad:true,fieldMap:{rateClass:"rateClassURI",ratePer:"ratePerURI",rateOccupancy:"rateOccupancyURI",defaultMaxHoldTimeSeconds:["defaultMaxHoldTimeHours","defaultMaxHoldTimeMinutes"]},beforeSubmit:function(a){a.cabinInfo=this.items.itemAt(0).items.itemAt(1).items.itemAt(3).getData();return a},items:[{xtype:"tabpanel",activeTab:0,layoutOnTabChange:true,height:390,defaults:{bodyStyle:"padding: 6px 4px 6px 4px;"},items:[{title:"Cabin",items:[{xtype:"panel",layout:"form",border:false,labelWidth:95,defaults:{style:"padding: 2px 4px 2px 4px;"},items:[{xtype:"panel",style:"padding-bottom: 4px;",border:false,layout:"table",layoutConfig:{columns:6},defaults:{border:false},items:[{html:"Cabin Number:",width:100},{xtype:"textfield",name:"cabinNumber",width:85},{html:"&nbsp;&nbsp;&nbsp;&nbsp;Status:",width:55},{xtype:"combo",name:"cabinStatus",excludeSubmit:true,minChars:1,enableKeyEvents:true,mode:"local",width:85,typeAhead:true,excludeFromSession:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"name",valueField:"dataURI",store:new Ext.data.SimpleStore({fields:["dataURI","name"],data:[["OK","OK"],["GTD","GTD"],["WL","WL"],["RQ","RQ"],["FS","FS"],["NA","NA"],["Sold","Sold"]]})}]},{xtype:"panel",style:"padding-bottom: 4px;",border:false,layout:"table",layoutConfig:{columns:6},defaults:{border:false},items:[{html:"Deck:",width:100},{xtype:"combo",name:"deck",excludeSubmit:true,minChars:1,enableKeyEvents:true,mode:"local",width:70,typeAhead:true,excludeFromSession:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"text",valueField:"text",store:TDS.data.cruiseDeckNew},{width:7,html:""},{xtype:"textfield",name:"deckDescription",emptyText:"Deck Description",fieldLabel:"Deck ",width:150}]},{xtype:"textfield",name:"cabinTypeText",readOnly:true,fieldLabel:"Cabin type",width:230},{style:"padding: 0px 3px 2px 0px;",xtype:"omnicrementer",name:"maximumOccupancy",fieldLabel:"Max. in cabin",width:60},{xtype:"combo",name:"position",excludeSubmit:true,minChars:1,fieldLabel:"Position",enableKeyEvents:true,mode:"local",width:70,typeAhead:true,excludeFromSession:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"text",valueField:"text",store:TDS.data.cruisePositions},{xtype:"panel",style:"padding: 3px 0px 0px 0px;",border:false,layout:"table",layoutConfig:{columns:3},defaults:{border:false},items:[{xtype:"radio",name:"smoking",labelSeparator:"",boxLabel:"Non Smoking",inputValue:true,value:true,width:300,listeners:{render:function(){var c=this.ownerCt.findParentByType("awesomewindow");var b=c.aw.data;this.setValue(b.smoking)}}}]},{xtype:"panel",style:"padding: 3px 0px 0px 0px;",border:false,layout:"table",layoutConfig:{columns:3},defaults:{border:false},items:[{xtype:"radio",name:"smoking",labelSeparator:"",boxLabel:"Smoking",inputValue:false,width:300,listeners:{render:function(){var c=this.ownerCt.findParentByType("awesomewindow");var b=c.aw.data;this.setValue(b.smoking)}}}]},{xtype:"panel",style:"padding: 3px 0px 0px 0px;",border:false,layout:"table",layoutConfig:{columns:3},defaults:{border:false},items:[{xtype:"checkbox",name:"disableCabin",labelSeparator:"",boxLabel:"Disabled Cabin",inputValue:false,width:300}]},{xtype:"panel",style:"padding: 3px 0px 0px 0px;",border:false,layout:"table",layoutConfig:{columns:3},defaults:{border:false},items:[{xtype:"checkbox",name:"connectCheck",labelSeparator:"",boxLabel:"Connect",inputValue:true,width:100,listeners:{check:function(){if(this.getValue()){this.ownerCt.items.itemAt(1).enable(true)}else{this.ownerCt.items.itemAt(1).setValue("");this.ownerCt.items.itemAt(1).disable(true)}}}},{xtype:"textfield",name:"connect",disabled:true,width:200}]},{xtype:"panel",style:"padding: 3px 0px 0px 0px;",border:false,layout:"table",layoutConfig:{columns:3},defaults:{border:false},items:[{xtype:"checkbox",name:"obstructCheck",labelSeparator:"",boxLabel:"Obstruct",inputValue:true,width:100,listeners:{check:function(){if(this.getValue()){this.ownerCt.items.itemAt(1).enable(true)}else{this.ownerCt.items.itemAt(1).setValue("");this.ownerCt.items.itemAt(1).disable(true)}}}},{xtype:"textfield",name:"obstruct",disabled:true,width:200}]},{xtype:"panel",style:"padding: 3px 0px 0px 0px;",border:false,layout:"table",layoutConfig:{columns:3},defaults:{border:false},items:[{xtype:"checkbox",name:"berthsCheck",labelSeparator:"",boxLabel:"Berths",inputValue:true,width:100,listeners:{check:function(){if(this.getValue()){this.ownerCt.items.itemAt(1).enable(true)}else{this.ownerCt.items.itemAt(1).setValue("");this.ownerCt.items.itemAt(1).disable(true)}}}},{xtype:"textfield",name:"berths",disabled:true,width:200}]},{xtype:"panel",style:"padding: 3px 0px 0px 0px;",border:false,layout:"table",layoutConfig:{columns:3},defaults:{border:false},items:[{xtype:"checkbox",name:"rollawayCheck",labelSeparator:"",boxLabel:"Rollaway",inputValue:true,width:100,listeners:{check:function(){if(this.getValue()){this.ownerCt.items.itemAt(1).enable(true)}else{this.ownerCt.items.itemAt(1).setValue("");this.ownerCt.items.itemAt(1).disable(true)}}}},{name:"rollaway",style:"padding: 0px 3px 2px 0px;",xtype:"omnicrementer",disabled:true,width:60}]},{xtype:"panel",style:"padding: 3px 0px 0px 0px;",border:false,layout:"table",layoutConfig:{columns:3},defaults:{border:false},items:[{xtype:"checkbox",name:"cribCheck",labelSeparator:"",boxLabel:"Crib",inputValue:true,width:100,listeners:{check:function(){if(this.getValue()){this.ownerCt.items.itemAt(1).enable(true)}else{this.ownerCt.items.itemAt(1).setValue("");this.ownerCt.items.itemAt(1).disable(true)}}}},{name:"crib",style:"padding: 0px 3px 2px 0px;",xtype:"omnicrementer",disabled:true,width:60}]}]}]},{title:"Details",autoScroll:true,items:[{xtype:"panel",border:false,layout:"table",column:3,items:[{html:'<form action="fileUpload" enctype="multipart/form-data" method="post" style="border="0""><td width= "100"><input width= "100" name="fileUpLoad" id="cabinfileUpLoads"type="file"  /></td></form>',width:250,style:"padding: 0px 30px 0px 25px; "},{xtype:"button",text:"Delete",style:'border="0";',handler:function(a){document.images.cabinImageName.src="";document.getElementById("shipUpLoads").value="";Ext.getCmp("gip").reset()}},{xtype:"button",text:"Upload",style:"padding: 0px 50px 0px 15px;",handler:function(b){;Ext.getCmp("cabinPanel").html='<img border="0" id="cabinImageId" name="cabinImageName" src="" ><input type="hidden" id ="imageName"  name="imageName" value="">';var i=this.ownerCt.findParentByType("awesomewindow");var a=i.aw.sourceDataURI;var h=document.getElementById("cabinfileUpLoads").value;var d=document.getElementById("cabinfileUpLoads").files[0];if(d){var e=0;j()}function j(){var l=new FormData();l.append("image",d);var m=new XMLHttpRequest();m.upload.addEventListener("progress",f,false);m.addEventListener("load",g,false);m.addEventListener("error",c,false);m.addEventListener("abort",k,false);m.open("POST",TDS.env.dataPath+"fileUpload?&imageName="+Ext.getCmp("gip").getValue()+"&imageStorePath="+a);m.send(l);m.onreadystatechange=function(){if(m.readyState==4){var p=m.getAllResponseHeaders();var q=m.responseText;var o=a;var n="GraphicsImg/"+q;Ext.getCmp("cabinPanel").show();document.getElementById("imageName").value=n;Ext.getCmp("gip").setValue(n);document.images.cabinImageName.src="../"+n;document.getElementById("imageName").value=n}}}function f(l){}function g(l){}function c(l){Ext.Msg.alert("","There was an error attempting to upload the file.")}function k(l){Ext.Msg.alert("","The upload has been canceled by the user or the browser dropped the connection.")}}}]},{html:"cabinImage",id:"cabinPanel",border:false,style:"padding: 5px; 0px; 0px; 0px;",height:"auto",width:"auto",hidden:true,listeners:{render:function(){;var b="";var d=this.ownerCt.ownerCt.findParentByType("awesomewindow");var c=d.aw.data.graphicImgPath;if(typeof c=="undefined"){c=""}var a=c.substring(0,4);if(a=="http"){this.html='<img border="0" height ="190px" width="360px" id="cabinImageId" name="cabinImageName" src='+c+' ><input type="hidden" id ="imageName"  name="imageName" value='+c+">"}else{b="../"+c;this.html='<img border="0"height ="190px" width="360px" id="cabinImageId" name="cabinImageName" src='+b+' ><input type="hidden" id ="imageName"  name="imageName" value='+b+">"}}}},{xtype:"textfield",id:"gip",hidden:true,name:"graphicImgPath",style:"padding: 25px; 5px; 25px; 25px;"},{xtype:"editorgrid",width:385,height:200,tbar:[" ",{xtype:"combo",excludeSubmit:true,minChars:1,enableKeyEvents:true,mode:"local",width:160,typeAhead:true,excludeFromSession:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"text",valueField:"text",store:TDS.data.cruiseInfoDropDown}," &nbsp;&nbsp;&nbsp;&nbsp;",{xtype:"textfield",width:80},"&nbsp;&nbsp;&nbsp;&nbsp;","-",{xtype:"button",text:"Save",handler:function(){;var f=this.ownerCt.ownerCt;var e=f.getStore();var b=this.ownerCt.items;var a=e.data.items;var d=true;for(var c=0;c<a.length;c++){if(a[c].data.name==b.itemAt(1).getValue()){d=false}}if(d){e.add([new e.recordType({name:b.itemAt(1).getValue(),value:b.itemAt(3).getValue()})])}}},"-",{xtype:"button",text:"Delete",handler:function(){var b=this.ownerCt.ownerCt;var a;while(a=b.selModel.getSelected()){b.store.remove(a)}}}],height:220,getData:function(){var b=this.getStore().data;for(var a=0,c=[];a<b.length;a++){c.push(b.items[a].data)}return{cabinInfo:c}},enableRowExpander:false,clicksToEdit:1,store:new Ext.data.JsonStore({url:"",id:"dataURI",fields:["name","value"]}),hideHeaders:true,sm:new Ext.grid.RowSelectionModel(),cm:new Ext.grid.ColumnModel([{header:"Name",dataIndex:"name",width:200,fixed:true,sortable:true},{header:"Value",dataIndex:"value",width:200,fixed:true,sortable:true}]),viewConfig:{forceFit:true},listeners:{render:function(){}}}]},{title:"Floor Plan",items:[{border:false,xtype:"panel",border:false,layout:"table",column:3,items:[{html:'<form action="fileUpload" enctype="multipart/form-data" method="post" style="border="0""><td width= "100"><input width= "100" name="fileUpLoad" id="floorfileUpLoads"type="file"  /></td></form>',width:250,style:"padding: 0px 30px 0px 25px; "},{xtype:"button",text:"Delete",style:'border="0";',handler:function(a){document.images.floorImageName.src="";document.getElementById("floorfileUpLoads").value="";Ext.getCmp("floorPlanId").reset()}},{xtype:"button",text:"Upload",style:"padding: 0px 50px 0px 15px;",handler:function(b){;Ext.getCmp("floorPanel").html='<img border="0" id="floorImageId" name="floorImageName" src="" ><input type="hidden" id ="imageName"  name="imageName" value="">';var i=this.ownerCt.findParentByType("awesomewindow");var a=i.aw.sourceDataURI;var h=document.getElementById("floorfileUpLoads").value;var d=document.getElementById("floorfileUpLoads").files[0];if(d){var e=0;j()}function j(){var l=new FormData();l.append("image",d);var m=new XMLHttpRequest();m.upload.addEventListener("progress",f,false);m.addEventListener("load",g,false);m.addEventListener("error",c,false);m.addEventListener("abort",k,false);m.open("POST",TDS.env.dataPath+"fileUpload?&imageName="+Ext.getCmp("floorPlanId").getValue()+"&imageStorePath="+a);m.send(l);m.onreadystatechange=function(){if(m.readyState==4){var p=m.getAllResponseHeaders();var q=m.responseText;var o=a;var n="GraphicsImg/"+q;Ext.getCmp("floorPanel").show();document.getElementById("imageName").value=n;Ext.getCmp("floorPlanId").setValue(n);document.images.floorImageName.src="../"+n;document.getElementById("imageName").value=n}}}function f(l){}function g(l){}function c(l){Ext.Msg.alert("","There was an error attempting to upload the file.")}function k(l){Ext.Msg.alert("","The upload has been canceled by the user or the browser dropped the connection.")}}}]},{html:"floorImage",id:"floorPanel",border:false,style:"padding: 5px; 0px; 0px; 0px;",height:"auto",width:"auto",hidden:true,listeners:{render:function(){;var b="";var d=this.ownerCt.ownerCt.findParentByType("awesomewindow");var c=d.aw.data.graphicImgPath;if(typeof c=="undefined"){c=""}var a=c.substring(0,4);if(a=="http"){this.html='<img border="0" height ="190px" width="360px" id="floorImageId" name="floorImageName" src='+c+' ><input type="hidden" id ="imageName"  name="imageName" value='+c+">"}else{b="../"+c;this.html='<img border="0"height ="190px" width="360px" id="floorImageId" name="floorImageName" src='+b+' ><input type="hidden" id ="imageName"  name="imageName" value='+b+">"}}}},{xtype:"textfield",id:"floorPlanId",hidden:true,name:"floorGraphicImgPath",style:"padding: 25px; 5px; 25px; 25px;"}]}]}]}