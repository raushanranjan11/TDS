{xtype:"panel",layout:"fit",border:false,bodyStyle:"padding: 8px;",autoScroll:true,getDataURI:function(){if(this.ownerCt.ownerCt.title=="Advertisement "){return null}else{return this.ownerCt.ownerCt.getDataURI()}},items:{xtype:"awesomegrid",searchURI:"",enableRowExpander:false,iconCls:"icon-grid",tbar:[{xtype:"tbspecialtext",text:"Advertisement Text: "},{xtype:"textfield",name:"advertisementText",enableKeyEvents:true,width:200},{xtype:"textfield",name:"agencyId",hidden:true,enableKeyEvents:true,width:200},"  ",{xtype:"tbspecialtext",text:"Start Date: "},{xtype:"datefield",name:"dateStart",format:"dMy",excludeFromSession:true,enableKeyEvents:true,width:70},"  ",{xtype:"tbspecialtext",text:"End Date: "},{xtype:"datefield",name:"dateEnd",format:"dMy",excludeFromSession:true,enableKeyEvents:true,width:70},"->",{xtype:"redbutton",text:"Create",handler:function(){var b=this.ownerCt.findParentByType("panel");var a=b.getDataURI();var c=this.ownerCt.ownerCt;TDS.window.setWindow({title:"Advertisement",information:"Please enter details of a New Advertisement.",interfaceURI:"/advertisement/create.js",postDataURI:"advertisement/createadvertisement",agencydatauri:a,callback:{fn:function(d){if(d){c.submitQuery(true)}},scope:c}})}}," ",{text:"Delete",handler:function(){var d=this.buttonContainer.ownerCt;var c=d.selModel.getSelected();if(!c){return}var a=c.get("dataURI");if(!a){return}Ext.Msg.show({title:"Alert",msg:"Are you sure you want to delete this announcement",buttons:Ext.Msg.YESNO,fn:b,animEl:"elId",icon:Ext.MessageBox.QUESTION});function b(f,e,g){if(f=="yes"){Ext.Ajax.request({url:TDS.env.dataPath+a+"/delete",method:"DELETE",callback:function(){d.submitQuery(true)},scope:this,disableCaching:true})}}}}," ",{text:"Archive",handler:function(){var c=this.buttonContainer.ownerCt;var b=c.selModel.getSelected();if(!b){return}var a=b.get("dataURI");if(!a){return}TDS.window.setWindow({title:"Archive Announcement",message:"Are you sure you want to archive this announcement?",destinationDataURI:a+"/edit",data:{archived:true},callback:{fn:function(d){if(d){c.submitQuery(true)}},scope:c}})}}],store:new Ext.data.JsonStore({url:"",id:"dataURI",fields:["dataURI","advertisementText","clickurl","dateStart","dateEnd","createdDate","updatedDate","active"]}),sm:new Ext.grid.RowSelectionModel(),cm:new Ext.grid.ColumnModel([{header:"Advertisement Text",dataIndex:"advertisementText",sortable:true},{header:"URL",dataIndex:"clickurl",sortable:true},{header:"Start Date",dataIndex:"dateStart",sortable:true,renderer:TDS.util.Format.dateSpecialRenderer(TDS.env.dateFormatDisplay)},{header:"End Date",dataIndex:"dateEnd",sortable:true,renderer:TDS.util.Format.dateSpecialRenderer(TDS.env.dateFormatDisplay)},{header:"Published",dataIndex:"createdDate",sortable:true,renderer:TDS.util.Format.dateSpecialRenderer(TDS.env.dateTimeFormatDisplay)},{header:"Last Modified",dataIndex:"updatedDate",sortable:true,renderer:TDS.util.Format.dateSpecialRenderer(TDS.env.dateTimeFormatDisplay)},{header:"Active",dataIndex:"active",sortable:true,renderer:function(c,b,a){if(!c){return"No"}else{return"Yes"}}}]),viewConfig:{forceFit:true},listeners:{sessioninit:function(){;var c=this.ownerCt.findParentByType("panel");var b=c.initialConfig.dataURI;var a=this.topToolbar.items.itemAt(2);a.setValue(b);this.searchURI=TDS.env.dataPath+"advertisement/ads"},rowdblclick:function(d,h,f){;var b=this.ownerCt.findParentByType("form");var c=d.getStore().getAt(h);var a=c.get("dataURI");TDS.window.setWindow({title:"Update Advertisement",interfaceURI:"advertisement/edit.js",sourceDataURI:a+"/details",destinationDataURI:a+"/edit",buttonOK:"Submit",callback:{fn:function(e){if(e){this.submitQuery(true)}},scope:d}})}}}}