{xtype:"form",border:false,fileUpload:true,markDataDirtyOnLoad:true,width:500,height:350,items:[{xtype:"tabpanel",activeTab:0,layoutOnTabChange:true,height:350,width:500,items:[{title:"Description",layout:"fit",items:[{xtype:"panel",layout:"fit",height:340,width:250,frame:true,autoScroll:false,items:[{xtype:"htmleditor",name:"description",hideLabel:true,labelSeparator:"",anchor:"90%",enableLinks:true,enableLists:true,enableSourceEdit:false,enableFontSize:true,enableFont:false,enableColors:true,enableAlignments:true,region:"center",margin:"0 0 0 0",autoScroll:false,listeners:{render:function(){}}}]}]},{title:"Graphics",xtype:"panel",layout:"form",alias:"widget.fileuploadform",autoScroll:true,width:500,border:false,hideBorders:true,items:[{xtype:"textfield",id:"graphicImgPath",hidden:true,name:"graphicImgPath"},{html:"Image size maximum of 220 x 140 pixels.",style:"padding: 5px 0px 5px 0px;"},{html:"",style:"margin-left: 10px; "},{html:'<form action="fileUpload" enctype="multipart/form-data" method="post"><td width= "300"><input width= "300" name="fileUpLoad" id="fileUpLoad"type="file"  /></td></form>',width:300},{html:"",style:"margin-left: 10px; "},{xtype:"button",text:"Delete",style:"padding: 6px 0px 0px 425px;",handler:function(d){document.images.image1.src="";Ext.getCmp("imagePanel").html='<img border="0" id="imageId" name="image1" src="" ><input type="hidden" id ="imgName"  name="imgName" value="">';var c=this.ownerCt.findParentByType("awesomewindow");var a=c.aw.sourceDataURI;var b=document.getElementById("imgName").value;if(b){var e={};if(b){e.removefile=b}if(b){e.imageStorePath=a}e.imageName=Ext.getCmp("graphicImgPath").getValue();Ext.Ajax.request({url:TDS.env.dataPath+"fileUpload",method:"POST",params:e,callback:function(i,g,h){if(g){Ext.Msg.alert("","Deleted succussefully.");document.images.image1.src="";document.getElementById("imgName").value="";document.getElementById("fileUpLoad").value="";var f={deletePath:true,imagePath:document.getElementById("imgName").value};Ext.Ajax.request({url:TDS.env.dataPath+a+"/graphicImage",method:"POST",jsonData:f,scope:this})}else{Ext.Msg.alert("","Error coocured..")}}})}}},{xtype:"button",text:"Upload",style:"padding: 6px 0px 0px 425px;",handler:function(b){document.images.image1.src="";Ext.getCmp("imagePanel").html='<img border="0" id="imageId" name="image1" src="" ><input type="hidden" id ="imgName"  name="imgName" value="">';var i=this.ownerCt.findParentByType("awesomewindow");var a=i.aw.sourceDataURI;var h=document.getElementById("fileUpLoad").value;var d=document.getElementById("fileUpLoad").files[0];if(d){var e=0;if(d.size>(220*140)){Ext.Msg.alert("","Image too large. Maximum size 220 x 140 pixels.")}else{j()}}function j(){var l=new FormData();l.append("image",d);var m=new XMLHttpRequest();m.upload.addEventListener("progress",f,false);m.addEventListener("load",g,false);m.addEventListener("error",c,false);m.addEventListener("abort",k,false);m.open("POST",TDS.env.dataPath+"fileUpload?&imageName="+Ext.getCmp("graphicImgPath").getValue()+"&imageStorePath="+a);m.send(l);m.onreadystatechange=function(){if(m.readyState==4){var q=m.getAllResponseHeaders();var r=m.responseText;var p=a;var o="GraphicsImg/"+r;document.getElementById("imgName").value=o;var n={deletePath:false,imagePath:document.getElementById("imgName").value};Ext.Ajax.request({url:TDS.env.dataPath+a+"/graphicImage",method:"POST",jsonData:n,callback:function(w,t,v){if(t){Ext.Msg.alert("","Graphics Uploaded successfully..");var u=Ext.util.JSON.decode(v.responseText);Ext.getCmp("graphicImgPath").setValue(u.graphicImgPath);document.images.image1.src="../"+u.graphicImgPath;document.getElementById("imgName").value=u.graphicImgPath}else{Ext.Msg.alert("","Error coocured..")}},scope:this})}}}function f(l){}function g(l){}function c(l){Ext.Msg.alert("","There was an error attempting to upload the file.")}function k(l){Ext.Msg.alert("","The upload has been canceled by the user or the browser dropped the connection.")}}},{id:"imagePanel",border:false,height:"auto",width:"auto",style:"padding-top:10px;",listeners:{beforerender:function(){var b="";var c=Ext.getCmp("graphicImgPath").getValue();var a=c.substring(0,4);if(a=="http"){this.html='<img border="0" height ="300px" width="480px" id="imageId" name="image1" src='+c+' ><input type="hidden" id ="imgName"  name="imgName" value='+c+">"}else{b="../"+c;this.html='<img border="0" height ="300px" width="480px" id="imageId" name="image1" src='+b+' ><input type="hidden" id ="imgName"  name="imgName" value='+b+">"}}}}]}]}]}