{xtype:"form",border:false,height:450,width:650,markDataDirtyOnLoad:true,beforeSubmit:function(E){try{var u=Ext.getCmp("noOfPassengesId").getValue();var o=Ext.getCmp("noOfquantityId").getValue();var z=this.getPassengerGrid();var l=z.getSelectionModel().getCount();var m=z.selModel.selections.items;var p=this.ownerCt;p.clearValidation();var t=this.ownerCt.initialConfig.params.reservedAvailable;var s=0;if(u>t&&t!=-1){s=u-t}var d=[];var n=[];n=o.split("$");if(n[0]==""){n.remove(n[0])}var c=false;var h=false;var q=0;var r=[];for(var y=0;y<E.rateMultipleSelectedRateURI.length;y++){c=false;var k=0;var C={};C.rateURI=E.rateMultipleSelectedRateURI[y].id;C.noOfPass=p.getParam("numberToReserveRequested");r[y]=C;q=p.getParam("numberToReserveRequested");d[y]=E.rateMultipleSelectedRateURI[y].id;for(var v=0;v<m.length;v++){if(E.rateMultipleSelectedRateURI.length==1){m[v].data.rateURI=E.rateMultipleSelectedRateURI[y].id;k++;c=true}else{if(m[v].data.rateURI===E.rateMultipleSelectedRateURI[y].data.nameString||m[v].data.rateURI===E.rateMultipleSelectedRateURI[y].id){m[v].data.rateURI=E.rateMultipleSelectedRateURI[y].id;k++;c=true}}}if(!c||k!=q){if(k!=q){h=true}break}}if(c&&!h){var x=[];for(var v=0;v<m.length;v++){var D={};D.rateURI=m[v].data.rateURI;D.passengerURI=m[v].id;x[v]=D}this.validateBooking(E);if(u==l){try{var f="";var B=p.getData("noOfCountries");for(var y=0;y<5;y++){if(B>y){var D=this.items.itemAt(1).items.itemAt(0).items.itemAt(0).items.itemAt(6).items.itemAt(0).items.itemAt(y).getRawValue();if(y>0&&D!=null&&D!=""){f+=", "}if(D!=null&&D!=""){f+=D}}else{if(f!=null&&f!=""){f+="."}break}}var E={submitDataAsParams:true,paramData:{action:E.action,currency:E.priceCurrency},data:{parameters:{countries:f},rateURI:E.rateURI,rateMultipleSelectedRateURI:d,noOfPer:n,offeringURI:E.offeringURI,inventoryAmount:this.getDetail("inventoryAmount"),dateFrom:E.dateFrom,duration:1,noOfPerPerRate:r,noOfPassToWaiting:s,passengerURIs:x,selectedNonMandatoryExtras:TDS.data[p.getParam("rateId")],releaseDate:E.action=="request"?E.releaseDate:""}};return E}catch(A){p.showValidation(A);return false}}else{Ext.Msg.alert("Alert","No.of person and Passenger should be match.")}}else{if(h){Ext.Msg.alert("Alert","select no. of passengers not matching against the rate.")}else{Ext.Msg.alert("Alert","select rate against the passenger")}}}catch(A){p.showValidation(A);return false}},validateBooking:function(a){var c=this.getPassengerGrid();var d=this.getDetail("numberOfPaxRequired");var b=c.getSelectionModel().getCount();if(b<d){throw"You must select "+(d-b)+" passengers to complete this booking."}if(!a.action){throw"You must select an available booking option to proceed."}},initBooking:function(){var e=this.ownerCt;var g=e.getParam("numberToReserveRequested");var i=e.getParam("rateClassURI");var d=e.getParam("ratePerURI");var f=e.getParam("rateOccupancyURI");var b=e.getParam("priceCurrency");var c=e.getParam("priceSell");var h=c*g;var a=TDS.data.passengerTypeLookup.ADULT;this.setDetail({inventoryAmount:g,paxType:a,numberOfPaxRequired:1,ratePriceUnit:c,ratePriceTotal:h,ratePriceCurrency:b})},initPassengerSelection:function(){var a=this.ownerCt;var b=this.getPassengerGrid();var d=this.getDetail("paxType");var c=this.getDetail("numberOfPaxRequired");b.getStore().on("load",function(){var e=b.preselect(d,c)},this)},getPassengerTab:function(){return this.items.itemAt(1).items.itemAt(1)},getPassengerGrid:function(){return this.getPassengerTab().items.itemAt(1).items.itemAt(0)},shared:{details:{}},setDetail:function(b,c){if(typeof b=="object"){for(var a in b){this.shared.details[a]=b[a]}}else{this.shared.details[b]=c}},getDetail:function(a){return this.shared.details[a]},listeners:{render:function(){var c=this.ownerCt;var a=new Date().add(Date.SECOND,240).format(TDS.env.dateFormat);this.items.itemAt(0).activate(a);var d=this.items.itemAt(1);var b=Ext.TimerMgr.lookup(c.getDataURI("offering")+"/availability");if(b){d.setTimer(b)}this.initBooking();this.initRadioButtons();this.initPassengerSelection()}},items:[{xtype:"timerlabel",text:"",activate:function(b){var c=this.ownerCt.ownerCt;var a=Ext.TimerMgr.start(new Ext.Timer({id:c.getDataURI()+"/availability",useServerTime:false,expireTime:b,interval:1000}));this.setTimer(a)},reset:function(){var a=this.ownerCt.ownerCt;this.cancelTimer();this.setText('<b>Availability:  <font color="#cc0000">Checking...</font></b>',false)},listeners:{timerexpire:function(a){this.setText("Your availability has expired.")},timerrefresh:function(a,b){this.setText('<b>This availability will expire in...<font color="#cc0000">'+b+"</font></b>",false)}}},{xtype:"tabpanel",border:false,activeTab:0,layoutOnTabChange:true,deferredRender:false,height:450,autoScroll:true,width:650,defaults:{bodyStyle:"padding: 6px 4px 6px 4px;"},items:[{title:"Details",autoScroll:true,items:{xtype:"panel",layout:"form",labelWidth:80,border:false,items:[{xtype:"panel",style:"padding: 0;",border:false,layout:"table",layoutConfig:{columns:2},defaults:{height:20,border:false},items:[{html:"<u><b>Rail Pass:</b></u>",width:Ext.isIE?88:85},{listeners:{render:function(){var a=this.ownerCt.findParentByType("awesomewindow");this.html="<b>"+a.getParam("offeringName")}}}]},{xtype:"panel",style:"padding: 0;",border:false,layout:"table",format:"dMy",layoutConfig:{columns:2},defaults:{height:20,border:false},items:[{html:"<u><b>Countries:</b></u> ",width:Ext.isIE?88:85},{width:Ext.isIE?438:435,listeners:{render:function(){var b=this.ownerCt.findParentByType("awesomewindow");var c=b.getData("noOfCountries");var a=b.getData("validity");this.html="<b>"+c+"&nbsp;(Select Countries Bellow)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><u>Validity:</u></b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+a}}}]},{xtype:"panel",style:"padding: 0; margin-top: 4px;",border:false,layout:"table",layoutConfig:{columns:1},defaults:{border:false},items:[{colspan:2,name:"EXTRA_RATE_DISP_AREA",tpl:new Ext.XTemplate(['<br><table class="x-tds-dataview" border=1; style="width: 90%; margin-left: 3px;">',"<thead>",'<tr style="background-color: #d0def0;">','<th style="padding-bottom: 2px; width: 325px;">Extra</th>','<th style="width: 85px; padding-bottom: 2px;">Min. required</th>','<th style="width: 70px; padding-bottom: 2px;">Pricing</th>','<th style="width: 70px; padding-bottom: 2px;">Markup</th>','<th style="width: 35px; padding-bottom: 2px;">Basis</th>','<th style="width: 30px; padding-bottom: 2px;">Comm</th>',"</tr>","</thead>",'<tpl for=".">',"<tr >",'<td style=" {[values.required ? " color: gray;" : "" ]}">&nbsp;{nameString}</td>',"<td ALIGN=CENTER >{minimumInventoryRequired}</td>","<td ALIGN=RIGHT >{priceCurrency} {[values.priceIsNett ? values.priceNett:values.priceGross]}</td>",'<td ALIGN=RIGHT >{[(values.priceIsNett? (values.priceCurrency+" "+values.markUp):"")]}</td>','<td ALIGN=CENTER >{[values.priceIsNett ? "Nett":"Gross"]}</td>','<td ALIGN=CENTER >{priceCommissionPercentage}{[(values.priceCommissionPercentage || values.priceCommissionPercentage == 0 )? "%":""]}</td>',"</tr>","</tpl>","</table>"])}]},{xtype:"panel",style:"padding: 0;",border:false,layout:"table",layoutConfig:{columns:1},defaults:{border:false},items:[{html:"<br><u><b>Booked Rates</b></u>",width:300}]},{xtype:"panel",style:"padding: 0; margin-top: 4px;",border:false,layout:"table",layoutConfig:{columns:2},defaults:{border:false},items:[{xtype:"numberfield",id:"noOfPassengesId",name:"noOfPassenges",hidden:true},{xtype:"textfield",id:"noOfquantityId",name:"noOfquantity",hidden:true},{width:620,listeners:{render:function(){var b="";var p=this.ownerCt.findParentByType("awesomewindow");var l=this.ownerCt.findParentByType("form");var f=p.getParam("rateMultipleSelectedRateURI");var k=f.length-1;var y;var h;var g;var C="";var B=0;var j=0;var n="";var u=TDS.data.selectedRates;u.removeAll();u.data.addAll(f);for(var z=0;z<f.length;z++){var q=p.getParam("numberToReserveRequested");j=parseInt(j)+parseInt(q);n+="$"+q;var t=f[z].json.nameString;var r=f[z].json.groupName;var E=r.split(", ");var m=E[0].split("per ");var D=m[1];var c=E[1];var A=f[z].data.conversionCurrency;var e=f[z].data.convertedPricingPriceSell;var d=f[z].data.convertedPricingPriceCommission;var s=f[z].data.convertedPricingPriceIsNett;if(s){y="Nett"}else{y="Gross"}if(typeof g=="undefined"||g==""){g=0}if(typeof e=="undefined"||e==""){e=0}var v=f[z].json.rateClassURI;var x=TDS.util.Price.calculateFixedGrossNettPrice({pricingPriceCurrency:A,pricingPriceSell:e,pricingPriceCommission:d,pricingPriceIsNett:s});if(q!=""&&q!=0){if(f[z].data.noOfChild==0){var o='<table class="x-tds-dataview" style="width: 100%;" border=1 cellpadding = 0 cellspacing=0  >';o+='<thead><tr style="background-color: #d0def0;" class="x-tds-dataview-item">';o+='<th style="padding: 2px; width: 50%;">Fare Type</th>';o+='<th style="padding: 2px; width: 11%;">Pax Type</th>';o+='<th style="padding: 2px; width: 3%;">Adult</th>';o+='<th style="padding: 2px; width: 10%;">Class</th>';o+='<th style="padding: 2px; width: 25%;">Fare per Person</th>';o+="</tr></thead>";o+="<tr>";o+="<td>&nbsp;"+t+"</td>",o+="<td>&nbsp;"+f[z].data.passType+"</td>",o+="<td ALIGN=CENTER>"+f[z].data.noOfAdults+"</td>",o+="<td>&nbsp;"+f[z].data.passClass+"</td>",o+="<td ALIGN=CENTER> "+TDS.util.Price.formatPrice(p.getParam("adultRate"),A)+" Per Adult</td>",o+="</tr>"}else{var o='<table class="x-tds-dataview" style="width: 100%;" border=1 cellpadding = 0 cellspacing=0  >';o+='<thead><tr style="background-color: #d0def0;" class="x-tds-dataview-item">';o+='<th style="padding: 2px; width: 50%;">Fare Type</th>';o+='<th style="padding: 2px; width: 11%;">Pax Type</th>';o+='<th style="padding: 2px; width: 3%;">Adult</th>';o+='<th style="padding: 2px; width: 3%;">Child</th>';o+='<th style="padding: 2px; width: 10%;">Class</th>';o+='<th style="padding: 2px; width: 25%;">Fare per Person</th>';o+="</tr></thead>";o+="<tr>";o+="<td>&nbsp;"+t+"</td>",o+="<td>&nbsp;"+f[z].data.passType+"</td>",o+="<td ALIGN=CENTER>"+f[z].data.noOfAdults+"</td>",o+="<td ALIGN=CENTER>"+f[z].data.noOfChild+"</td>",o+="<td>&nbsp;"+f[z].data.passClass+"</td>",o+="<td ALIGN=CENTER> "+TDS.util.Price.formatPrice(p.getParam("adultRate"),A)+" Per Adult</br>"+TDS.util.Price.formatPrice(p.getParam("childRate"),A)+" Per Child</td>",o+="</tr>"}}}o+="</table></div>";Ext.getCmp("noOfPassengesId").setValue(j);Ext.getCmp("noOfquantityId").setValue(n);this.html=o}}}]},{xtype:"panel",style:"padding: 0; margin-top: 4px;",border:false,layout:"table",layoutConfig:{columns:2},defaults:{border:false},items:[{html:"<u><b>Total:</b></u>",width:Ext.isIE?88:40},{xtype:"textfield",readOnly:true,style:"border:#FFFFFF; display:compact; font:Verdana; font-weight: bold; background: none;  text-decoration: none; div {text-align: left; } ",listeners:{render:function(){var o=this.ownerCt.findParentByType("awesomewindow");var m=this.ownerCt.findParentByType("form");var e=o.getParam("rateMultipleSelectedRateURI");var y=[];for(var t=0;t<e.length;t++){y[t]=e[t].get("dataURI")}var l=e.length-1;var s;var h;var g=0;var x="";var u=0;var A={};A.extras=[];var f=0;for(var t=0;t<e.length;t++){var p=o.getParam("numberToReserveRequested");var r=o.getParam("adultRate");var n=o.getParam("childRate");var v=e[t].data.conversionCurrency;var c=e[t].data.convertedPricingPriceSell;var b=e[t].data.convertedPricingPriceCommission;var q=e[t].data.convertedPricingPriceIsNett;if(q){s="Nett"}else{s="Gross"}if(typeof g=="undefined"||g==""){g=0}if(typeof c=="undefined"||c==""){c=0}u=u+parseInt(e[t].data.noOfAdults)*parseFloat(r);u=u+parseInt(e[t].data.noOfChild)*parseFloat(n);var k=new Ext.data.CollectionStore({autoLoad:true,url:TDS.env.dataPath+e[t].data.offeringURI+"/searchExtras/collection?rateURI="+e[t].data.dataURI+"&currency="+v,identifier:e[t].data.offeringURI+"/searchExtras?rateURI="+e[t].data.dataURI+"&currency="+v,fields:["dataURI","nameString","termsAndConditions","extraCategoryURI","required","minimumInventoryRequired","conversionCurrency","convertedPricingPriceSell","convertedPricingPriceIsNett","convertedPricingPriceCommission","rateClassURI","ratePerURI","rateOccupancyURI","shareAvailabilitywith","flagCount","offeringURI","childChbox","markUp"]});var z=this.html;k.on("load",function(i,a){var C=A.extras;var B=A.extras.length;var w=0;for(var d=B;d<(B+a.length);d++){if(!a[(d-B)].data.required){w++;continue}A.extras[(d-w)]=a[(d-B)].data;Ext.apply(A.extras[(d-w)],TDS.util.Price.calculateGrossNettPrice(A.extras[(d-w)]));f+=a[(d-B)].data.priceSell;if(A.extras[(d-w)].priceIsNett){A.extras[(d-w)].priceNett=A.extras[(d-w)].priceSell.toFixed(2);A.extras[(d-w)].markUp=(A.extras[(d-w)].priceSell*TDS.env.user.agencyDefaultComm()/100).toFixed(2);f+=(A.extras[(d-w)].priceSell*TDS.env.user.agencyDefaultComm()/100)}else{A.extras[(d-w)].priceGross=A.extras[(d-w)].priceGross.toFixed(2)}}var D=this.ownerCt.ownerCt.items.itemAt(2).items.itemAt(0);if(A.extras.length>0){D.tpl.overwrite(D.body,A.extras)}var E=" "+v+" "+((f*parseInt(p))+(u)).toFixed(2)+" ";this.setValue(E)},this);if(e[t].data.convertedPricingPriceIsNett){u+=(c*TDS.env.user.agencyDefaultComm()/100)}var j=TDS.util.Price.formatPrice((f*parseInt(p))+(u),v);this.setValue(j)}if(v==""||v==null){v="AUD"}this.html=TDS.util.Price.formatPrice(u,v)}}}]},{xtype:"panel",style:"margin-top: 8px;",layout:"table",border:false,layoutConfig:{columns:2},autoHeight:true,items:[{xtype:"panel",width:440,border:false,layout:"form",defaults:{labelSeparator:""},items:[{xtype:"combo",name:"countryURI1",fieldLabel:"1. ",emptyText:"Type a country...",excludeFromSession:true,tpl:TDS.util.Templates.ComboNoLabel,minChars:1,enableKeyEvents:true,mode:"local",width:120,typeAhead:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"name",valueField:"dataURI",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["dataURI","name","isoCode"]}),appendData:[{name:"",dataURI:""}]},{xtype:"combo",name:"countryURI2",fieldLabel:"2. ",emptyText:"Type a country...",excludeFromSession:true,tpl:TDS.util.Templates.ComboNoLabel,minChars:1,enableKeyEvents:true,mode:"local",width:120,typeAhead:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"name",valueField:"dataURI",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["dataURI","name","isoCode"]}),appendData:[{name:"",dataURI:""}]},{xtype:"combo",name:"countryURI3",fieldLabel:"3. ",emptyText:"Type a country...",excludeFromSession:true,tpl:TDS.util.Templates.ComboNoLabel,minChars:1,enableKeyEvents:true,mode:"local",width:120,typeAhead:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"name",valueField:"dataURI",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["dataURI","name","isoCode"]}),appendData:[{name:"",dataURI:""}]},{xtype:"combo",name:"countryURI4",fieldLabel:"4. ",emptyText:"Type a country...",excludeFromSession:true,tpl:TDS.util.Templates.ComboNoLabel,minChars:1,enableKeyEvents:true,mode:"local",width:120,typeAhead:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"name",valueField:"dataURI",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["dataURI","name","isoCode"]}),appendData:[{name:"",dataURI:""}]},{xtype:"combo",name:"countryURI5",fieldLabel:"5. ",emptyText:"Type a country...",excludeFromSession:true,tpl:TDS.util.Templates.ComboNoLabel,minChars:1,enableKeyEvents:true,mode:"local",width:120,typeAhead:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"name",valueField:"dataURI",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["dataURI","name","isoCode"]}),appendData:[{name:"",dataURI:""}]}]},{xtype:"fieldset",style:"margin-top: 8px;",layout:"table",layoutConfig:{columns:2},autoHeight:true,width:180,defaults:{colspan:2,xtype:"radio",name:"action",forceSubmit:true,hideLabel:true},items:[{boxLabel:"Book available",inputValue:"book",hidden:true},{colspan:1,boxLabel:"Request",inputValue:"request",hidden:true,handler:function(a,b){var c=this.ownerCt.items.itemAt(2);if(b){c.enable().focus()}else{c.disable()}}},{colspan:1,xtype:"datefield",name:"releaseDate",hidden:true,disabled:true,showToday:false,width:80,format:TDS.env.dateFormatDisplay,minValue:Ext.TimerMgr.getServerCalculatedDate().clearTime(),listeners:{render:function(){var a=Ext.TimerMgr.getServerCalculatedDate().add(Date.DAY,28);this.setValue(a)}}},{boxLabel:"Quote only",inputValue:"quote"}]}]},{xtype:"checkbox",name:"makeAnotherBooking",forceSubmit:true,hideLabel:true,checked:false,hidden:true,boxLabel:"Make another booking"}]}},{title:"Passengers",items:[{xtype:"panel",border:false,style:"margin-bottom: 6px;",html:"<p>Please select the passengers for this booking below.</p>",listeners:{beforerender:function(){var a=this.ownerCt.findParentByType("form");var b=a.getDetail("numberOfPaxRequired");if(b>0){this.html="<p>Please select the "+b+" passengers required for this booking below.</p>"}}}},{xtype:"panel",border:false,layout:"fit",items:[{xtype:"editorgrid",height:350,store:new Ext.data.CollectionStore({url:"",identifier:"",fields:["type","code","nameFirst","nameLast","salutation","displayName","dateOfBirth","paxAge"]}),viewConfig:{forceFit:true},getData:function(){var b=this.selModel.getSelections();var c=[];for(var a=0;a<b.length;a++){c[a]=b[a].get("dataURI")}return c},preselect:function(c,b){var a=[];this.getStore().each(function(d){if(a.length>=b){return false}if((!c||d.get("type")==c)&&d.get("nameFirst")&&d.get("nameLast")){a[a.length]=d}},this);if(a.length>0){this.getSelectionModel().selectRecords(a)}return a.length},validatePassenger:function(d,a,c,b){if(!b.get("nameFirst")&&!b.get("nameLast")){return false}},sm:new Ext.grid.CheckboxSelectionModel(),columns:[new Ext.grid.CheckboxSelectionModel(),{header:"Type",dataIndex:"type",width:40,fixed:true,editor:new Ext.form.ComboBox({editable:false,forceSelection:true,mode:"local",displayField:"text",valueField:"text",triggerAction:"all",tpl:'<tpl for="."><div class="x-combo-list-item">{text}, <span style="font-style: italic; font-size: 10px; color: #999;">{description}</span></div></tpl>',store:TDS.data.passengerType})},{header:"Title",dataIndex:"salutation",width:40,fixed:true,editor:new Ext.form.ComboBox({store:TDS.data.salutations,editable:false,forceSelection:true,mode:"local",triggerAction:"all",displayField:"text",valueField:"text"})},{header:"First name",dataIndex:"nameFirst",editor:new Ext.form.TextField({allowBlank:false}),renderer:function(a,c,b){return a.substr(0,1).toUpperCase()+a.substr(1)}},{header:"Last name",dataIndex:"nameLast",editor:new Ext.form.TextField({allowBlank:false}),renderer:function(a,c,b){return a.substr(0,1).toUpperCase()+a.substr(1)}},{header:"Code",dataIndex:"code",width:40,fixed:true},{header:"Age",dataIndex:"paxAge",renderer:function(c,b,a){if(c){return c}else{return TDS.util.Format.age(a.get("dateOfBirth"))}}},{header:"Rate",dataIndex:"rateURI",fixed:true,editor:new Ext.form.ComboBox({editable:false,forceSelection:true,mode:"local",displayField:"nameString",valueField:"nameString",triggerAction:"all",store:TDS.data.selectedRates})}],bbar:[{xtype:"button",text:"Add",handler:function(){var b=this.ownerCt.items.itemAt(1);var a=this.ownerCt.items.itemAt(2);a.enable();b.enable();this.disable();var d=this.ownerCt.ownerCt;var c=d.getStore();c.add([new c.recordType({type:"AD",nameFirst:"",nameLast:""})]);d.newRecordIndex=c.getCount()-1;d.startEditing(d.newRecordIndex,2)}},{xtype:"button",text:"Cancel",disabled:true,handler:function(){var c=this.ownerCt.items.itemAt(0);var b=this.ownerCt.items.itemAt(2);c.enable();b.disable();var d=this.ownerCt.ownerCt;var a=d.getStore().getAt(d.newRecordIndex);if(a==-1||typeof a.get("dataURI")!="undefined"){return}d.getStore().remove(a);this.disable()}},{xtype:"button",text:"Save",disabled:true,handler:function(){var b=this.ownerCt.findParentByType("awesomewindow");var e=this.ownerCt.ownerCt;var d=this.ownerCt.items.itemAt(0);var c=this.ownerCt.items.itemAt(1);c.disable();this.disable();var a=e.getStore().getAt(e.newRecordIndex);if(a==-1||typeof a.get("dataURI")!="undefined"){return}Ext.Ajax.request({url:TDS.env.dataPath+b.getDataURI("pnr")+"/passengers",jsonData:a.data,method:"POST",callback:function(h,f,g){if(f){e.getStore().load();d.enable()}else{c.enable();this.enable()}},scope:this})}}],listeners:{render:function(){var w=this.ownerCt.findParentByType("awesomewindow");this.getSelectionModel().on("beforerowselect",this.validatePassenger,this);with(this.store){reader.meta.identifier=w.getDataURI("pnr")+"/passengers";proxy.conn.url=TDS.env.dataPath+w.getDataURI("pnr")+"/passengers/concise";load()}}}}]}]}]}],initRadioButtons:function(e){var j=this.ownerCt;var k=j.getParam("daysAvailable");var a=j.getParam("daysRequestable");var g=this.items.itemAt(1).items.itemAt(0).items.itemAt(0).findByType("fieldset")[0];var d=g.items.itemAt(0);var b=g.items.itemAt(1);var h=g.items.itemAt(2);if(k>0){d.show()}if(a>0){b.show()}var c=j.getData("noOfCountries");for(var f=0;f<5;f++){if(c<=f){this.items.itemAt(1).items.itemAt(0).items.itemAt(0).items.itemAt(6).items.itemAt(0).items.itemAt(f).disable(true)}}}}