{xtype:"form",border:false,width:800,markDataDirtyOnLoad:true,beforeSubmit:function(e){var c=this;var d=e;var g=this.getFlightGrid().getSelectionModel().selections.items;var h=[],i={};for(var f=0;f<g.length;f++){h.push({dataURI:g[f].data.dataURI,rateURI:g[f].json.rateIds})}i.root=h;return e.root=i},beforeDataLoad:function(b,a){return b},getRateURI:function(){return this.ownerCt.getDataURI("rateOffering")},getTermsURI:function(){return this.ownerCt.getDataURI("terms")},getFlightGrid:function(){return this.items.itemAt(0).items.itemAt(0).items.itemAt(0).items.itemAt(0).items.itemAt(0)},getPriceCurrency:function(){return this.ownerCt.getData("priceCurrency")},getCity:function(){return this.ownerCt.getData("airportToURI")},getPassGrid:function(){return this.items.itemAt(0).items.itemAt(1).items.itemAt(0).items.itemAt(0).items.itemAt(0)},getBaggageGrid:function(){},items:[{xtype:"tabpanel",activeTab:0,id:"tab",layoutOnTabChange:true,height:450,defaults:{bodyStyle:"padding: 6px 4px 6px 4px;"},items:[{title:"Flights",items:[{xtype:"panel",layout:"table",frame:true,layoutConfig:{columns:1},labelWidth:110,border:false,style:"padding: 2px;",defaultType:"textfield",items:[{xtype:"panel",width:735,height:325,border:true,style:"padding: 2px;",items:[{xtype:"grid",alwaysUseCollection:true,width:735,height:275,border:false,store:new Ext.data.JsonStore({fields:["noOfSeats","rateId","travelDate","rateName","nameString","airportFromURI","airportFromString","airportToURI","airportToString","departure","stopOvers","expiryDate","dataURI","departureDate","arrivalDate","arrivalTime","departureTime","airportFrom","airportTo","bookStatus","adultRate","childRate","infantRate","adultNo","childNo","infantNo","offeringURI","dateFrom","restrictions","farePerFlight"]}),sm:new Ext.grid.CheckboxSelectionModel(),columns:[new Ext.grid.CheckboxSelectionModel(),{header:"Flight Nos",dataIndex:"nameString",width:80,fixed:true},{header:"Class",dataIndex:"rateName"},{header:"From",dataIndex:"airportFromURI",sortable:true,renderer:function(a){return a.substring(a.lastIndexOf("/")+1)}},{header:"Date",dataIndex:"departureDate"},{header:"Time",dataIndex:"departureTime",sortable:true},{header:"To",dataIndex:"airportToURI",sortable:true,renderer:function(a){return a.substring(a.lastIndexOf("/")+1)}},{header:"Date",dataIndex:"arrivalDate",sortable:true},{header:"Time",dataIndex:"arrivalTime"},{header:"Stop",dataIndex:"stopOvers",sortable:true,renderer:function addTooltip(e,d,a,f,c,b){d.attr='ext:qtip="'+a.get("stopOversString")+'"';return e}},{header:"Seats",dataIndex:"noOfSeats"},{header:"Status",dataIndex:"bookStatus"}],viewConfig:{forceFit:true},listeners:{beforerender:function(){},celldblclick:function(f,h,d,g){;var b=f;var c=g;f.getSelectionModel().selectRow(h);var a=f.getSelectionModel().getSelections()[0].get("restrictions");if(d==2){new Ext.Window({height:250,width:350,border:false,layout:"fit",items:[{xtype:"panel",border:false,layout:"fit",width:320,height:375,autoScroll:true,items:[{html:"",style:"padding-left:20px;padding-top:10px;padding-buttom:20px;font-size: 12px;",autoScroll:true,border:false,listeners:{render:function(){this.html=a}}}]}]}).show()}},sessioninit:function(){},render:function(){var b={rateURI:this.findParentByType("form").getRateURI()};Ext.Ajax.request({url:TDS.env.dataPath+"search/air/rateOffering",method:"POST",jsonData:b,callback:function(j,c,e){if(c){var d=Ext.util.JSON.decode(e.responseText);var h=d["air/rateOffering/collection"];if(typeof h=="undefined"){return}var g=[];for(var a=0;a<h.length;a++){d[h[a]].dataURI=h[a];g.push(d[h[a]])}var f=this.store;f.loadData(g)}},scope:this})}}},{xtype:"panel",style:"padding: 0; margin-top: 25px; margin-bottom: 4px;",border:false,layout:"table",layoutConfig:{columns:9},defaults:{border:false},items:[{html:"",width:Ext.isIE?125:100},{xtype:"radio",name:"payBy",inputValue:false,listeners:{render:function(){var c=this.ownerCt.findParentByType("awesomewindow");var b=c.aw.data},check:function(d,c){if(c){this.ownerCt.items.itemAt(3).setValue(false);var b=this.findParentByType("tabpanel").findByType("grid");var a=b[3];a.disable()}}}},{html:"Agency Credit",style:"padding: 0; margin-left: 1px; margin-right: 25px;"},{xtype:"radio",inputValue:true,name:"payBy",config:{windowData:""},listeners:{render:function(){var c=this.ownerCt.findParentByType("awesomewindow");var b=c.aw.data},check:function(h,i){if(i){;this.ownerCt.items.itemAt(1).setValue(false);var l=this.findParentByType("tabpanel").findByType("grid");var a=l[0].getSelectionModel().getSelections();var g=l[0].getSelectionModel().selections.items;var q=l[1].getSelectionModel().selections.items;var d=l[1].getSelectionModel().selections.items.length;var l=this.findParentByType("tabpanel").findByType("grid");var c=0;var r=g.length;var f=0;for(var p=0;p<g.length;p++){c=c+g[p].data.farePerFlight;for(var m=0;m<q.length;m++){var b=q[m].data.additinalBaggae;if(b==1){f=f+35}else{if(b==2){f=f+70}}}}var o=7.7*d;var n=c+f+o;var e;var s=this;var k="<b>Total Fare:</b> AUD "+c.toFixed(2)+"<br><br> <b>CC Charges:</b> AUD "+o.toFixed(2)+"<br><br> <b>Baggage Price:</b> AUD "+f.toFixed(2)+"<br><br><b> Grand Total :</b> AUD "+n.toFixed(2);e=new Ext.Window({height:350,width:550,closable:true,border:false,layout:"fit",modal:true,items:[{xtype:"form",border:false,width:550,items:[{xtype:"tabpanel",activeTab:0,layoutOnTabChange:true,height:300,defaults:{bodyStyle:"padding: 6px 4px 6px 4px;"},items:[{title:"Credit Card Payment",layout:"fit",items:[{xtype:"panel",layout:"column",labelWidth:110,border:false,style:"padding: 2px;",defaultType:"textfield",items:[{xtype:"panel",width:"40%",height:255,border:true,style:"padding: 2px;",columnWidth:0.4,items:[{xtype:"panel",layout:"form",border:false,labelWidth:90,style:"padding: 20px;",defaults:{},items:[{html:" <b>Fare Details<b> ",style:"padding-bottom: 12px;",border:false},{html:k,border:false}]}]},{xtype:"panel",width:"60%",height:255,border:true,style:"padding: 2px;",columnWidth:0.6,items:[{xtype:"panel",layout:"form",border:false,labelWidth:90,style:"padding: 20px;",defaults:{},items:[{html:" <b>Please Provide Credit Card Information<b> ",style:"padding-bottom: 20px;",border:false},{xtype:"combo",allowBlank:false,name:"cardType",mode:"local",fieldLabel:"Card Type",width:140,triggerAction:"all",editable:false,displayField:"cardTyp",valueField:"cardType",value:"AX",store:new Ext.data.SimpleStore({storeId:"cardId",fields:["cardTyp","cardType"],data:[["AX","AX"],["VI","VI"],["CA","CA"],["DC","DC"],["DS","DS"],["JB","JB"]]})},{xtype:"textfield",allowBlank:false,name:"cardNumber",value:"372055555555550",fieldLabel:"Card Number",bodyStyle:"padding: 2px 4px 2px 4px;",width:140},{xtype:"textfield",allowBlank:false,name:"securityCode",value:"111",fieldLabel:"Security Code",bodyStyle:"padding: 2px 4px 2px 4px;",width:140},{xtype:"panel",layout:"table",style:"padding: 0; margin-bottom: 4px;",border:false,hideBorders:true,layoutConfig:{columns:4},items:[{html:"Expiration Date:",width:95},{xtype:"combo",name:"mm",style:"margin-left: 2px;",mode:"local",width:55,triggerAction:"all",editable:false,displayField:"text",valueField:"description",value:"03",emptyText:" ",store:TDS.data.months},{html:" ",width:Ext.isIE?12:12},{xtype:"combo",name:"yy",style:"margin-left: 2px;",mode:"local",width:54,triggerAction:"all",editable:false,value:"17",displayField:"text",valueField:"description",emptyText:" ",store:TDS.data.years}]},{xtype:"textfield",allowBlank:false,name:"cardHolderName",fieldLabel:"Name on Card",value:"MR abc",bodyStyle:"padding: 2px 4px 2px 4px;",width:140}]}]}]}]}]}]}],buttons:[{text:"Submit",handler:function(){var j=this.ownerCt.items.itemAt(0).getForm();if(j.isValid()){var t=j.getValues();s.config.windowData=t;this.ownerCt.hide()}}},{text:"Close",handler:function(){this.ownerCt.hide()}}]}).show()}}}},{html:"Credit Card Payment",style:"padding: 0; margin-left: 1px; margin-right: 25px;"},{xtype:"radio",name:"book",width:16,inputValue:false},{html:"Book",style:"padding: 0; margin-left: 1px; margin-right: 25px;",width:Ext.isIE?43:45},{xtype:"radio",name:"book",width:16,inputValue:true,listeners:{render:function(){var c=this.ownerCt.findParentByType("awesomewindow");var b=c.aw.data}}},{html:"Quote",style:"padding: 0; margin-left: 1px; margin-right:25px;",width:Ext.isIE?38:40}]}]}]},{xtype:"panel",layout:"table",border:false,style:"padding: 20px;",layoutConfig:{columns:8},defaults:{border:false},items:[{xtype:"button",text:"Seat Allocation",hidden:true},{width:160},{xtype:"hidden",name:"credit",itemId:"credit"},{xtype:"formredbutton",text:"Submit",cls:"x-button-orange",overCls:"x-button-orange-over",handler:function(){;var I=this.ownerCt.ownerCt.items.itemAt(0).items.itemAt(0).items.itemAt(1).items.itemAt(3).initialConfig.config.windowData;var R=this.ownerCt.ownerCt.items.itemAt(0).items.itemAt(0).items.itemAt(1).items.itemAt(1).getValue();var O=this.ownerCt.ownerCt.items.itemAt(0).items.itemAt(0).items.itemAt(1).items.itemAt(3).getValue();var h=this.findParentByType("awesomewindow").getPostDataURI();var Q=this.findParentByType("form").getPassGrid().getSelectionModel().selections.items;var J=this.findParentByType("form").getPriceCurrency();var b=this.findParentByType("form").getFlightGrid();var a=this.findParentByType("form").getFlightGrid().getSelectionModel().selections.items;var t="";if(R){t="agencyCredit"}if(O){t="creditcard"}var D=new Date();var o=I.cardType;var C=I.cardNumber;var v=I.securityCode;var i=I.mm;var e=I.yy;var p=I.cardHolderName;var x=[],d=[];for(var N=0;N<Q.length;N++){d.push(Q[N].data.dataURI)}var n={};var B=[];for(var P=0;P<a.length;P++){var f={};var q=a[P].data.offeringURI;var z=a[P].data.dateFrom;var F=a[P].data.adultRate;var T=a[P].data.adultRate;var A=a[P].data.childRate;var y=a[P].data.infantRate;var K=a[P].data.noOfSeats;var g=a[P].data.adultNo;var r=a[P].data.childNo;var H=a[P].data.infantNo;var G=d.length;var l=[],w=[],s=[],c=[];if(typeof T!="undefined"&&T!=""){l.push(T);s.push({rateURI:a[P].data.adultRate,noOfPass:a[P].data.adultNo+""})}if(typeof A!="undefined"&&A!=""){l.push(A);s.push({rateURI:a[P].data.childRate,noOfPass:a[P].data.childNo+""})}if(typeof y!="undefined"&&y!=""){l.push(y);s.push({rateURI:a[P].data.infantRate,noOfPass:a[P].data.infantNo+""})}if(typeof g!="undefined"&&g!=0){w.push(a[P].data.adultNo+"")}if(typeof r!="undefined"&&r!=0){w.push(a[P].data.childNo+"")}if(typeof H!="undefined"&&H!=0){w.push(a[P].data.infantNo+"")}for(var L=0;L<Q.length;L++){var u=Q[L].data.type;if(u=="AD"){c.push({rateURI:a[P].data.adultRate,passengerURI:Q[L].data.dataURI,additinalBaggae:Q[L].data.additinalBaggae})}if(u=="CH"){c.push({rateURI:a[P].data.childRate,passengerURI:Q[L].data.dataURI,additinalBaggae:Q[L].data.additinalBaggae})}if(u=="IN"){c.push({rateURI:a[P].data.infantRate,passengerURI:Q[L].data.dataURI,additinalBaggae:Q[L].data.additinalBaggae})}}var D=new Date();f.rateMultipleSelectedRateURI=l;f.passengers=d;f.noOfSeats=K;f.passengerLength=G;f.adultNo=g;f.childNo=r;f.infantNo=H;f.inventoryAmount=K;f.noOfPer=w;f.offeringURI=q;f.noOfPerPerRate=s;f.passengerURIs=c;f.dateFrom=z;f.rateURI=F;f.duration=1;f.cardType=o;f.cardNumber=C;f.securityCode=v;f.cardExpMM=i;f.cardExpYY=e;f.cardHolderName=p;f.payBy=t;B.push(f)}n=B;var S=[];var E=b.getStore().data;E.each(function(k,j){S.push(k.data)});var M=new Ext.LoadMask(this.findParentByType("awesomewindow").el,{msg:""});M.show();Ext.Ajax.request({url:TDS.env.dataPath+h+"/air?action=book&componentFrom=AIR&currency="+J,jsonData:n,method:"POST",callback:function(j,k,U){;if(U.status==200){var m={rateURI:this.findParentByType("form").getRateURI()};Ext.Ajax.request({url:TDS.env.dataPath+"search/air/rateOffering",method:"POST",jsonData:m,callback:function(ac,W,Y){if(W){;var X=Ext.util.JSON.decode(Y.responseText);var ab=X["air/rateOffering/collection"];if(typeof ab=="undefined"){return}var aa=[];for(var V=0;V<ab.length;V++){X[ab[V]].dataURI=ab[V];aa.push(X[ab[V]])}var Z=b.getStore();Z.loadData(aa);b.getView().refresh()}},scope:this});M.hide();this.ownerCt.close()}else{Ext.Msg.alert("Status",U.responseText);M.hide()}},scope:this})}},{width:60},{xtype:"button",text:"Remove",handler:function(){;var b=this.findParentByType("form").getFlightGrid().getSelectionModel().selections.items[0];if(!(b.data.bookStatus=="Confirmed")){this.findParentByType("form").getFlightGrid().getStore().remove(b)}}},{width:60},{xtype:"button",text:"More Flights",handler:function(){;this.findParentByType("awesomewindow").hide()}}]}]},{title:"Passenger",items:[{xtype:"panel",layout:"table",frame:true,layoutConfig:{columns:1},labelWidth:110,border:false,style:"padding: 2px;",defaultType:"textfield",items:[{xtype:"panel",width:755,height:395,border:true,style:"padding: 2px;",items:[{xtype:"editorgrid",alwaysUseCollection:true,singleSelect:true,width:735,height:375,border:false,store:new Ext.data.CollectionStore({url:"",identifier:"",fields:["type","code","nameFirst","nameLast","salutation","displayName","dateOfBirth","paxAge","gender","additinalBaggae"]}),sm:new Ext.grid.CheckboxSelectionModel({}),columns:[new Ext.grid.CheckboxSelectionModel({}),{header:"Type",dataIndex:"type",width:40,fixed:true,editor:new Ext.form.ComboBox({editable:false,forceSelection:true,mode:"local",displayField:"text",valueField:"text",triggerAction:"all",tpl:'<tpl for="."><div class="x-combo-list-item">{text}, <span style="font-style: italic; font-size: 10px; color: #999;">{description}</span></div></tpl>',store:TDS.data.passengerType})},{header:"Last Name",dataIndex:"nameLast",editor:new Ext.form.TextField({allowBlank:false}),renderer:function(a,c,b){return a.substr(0,1).toUpperCase()+a.substr(1)}},{header:"First Name",dataIndex:"nameFirst",editor:new Ext.form.TextField({allowBlank:false}),renderer:function(a,c,b){return a.substr(0,1).toUpperCase()+a.substr(1)}},{header:"Title",dataIndex:"salutation",editor:new Ext.form.ComboBox({store:TDS.data.salutations,editable:false,forceSelection:true,mode:"local",triggerAction:"all",displayField:"text",valueField:"text"})},{header:"Gender",dataIndex:"gender",editor:new Ext.form.TextField({allowBlank:false})},{header:"DOB",dataIndex:"dateOfBirth",editor:new Ext.form.DateField({allowBlank:false}),renderer:function(e,c,b){;if(typeof e!="undefined"){if(typeof e!="string"){var a=new Date();a.setTime(Ext.TimerMgr.getServerCalculatedTime());var d=Math.floor((a.getTime()-e.getTime())/(365.25*24*60*60*1000));b.set("paxAge",((d&&d>0)?d:""));return Ext.util.Format.date(e,TDS.env.dateBirthdayFormatDisplay)}else{if(b.get("paxAge")){var d=TDS.util.Format.age(e);b.set("paxAge",((d&&d>0)?d:""))}return TDS.util.Format.dateSpecial(e,TDS.env.dateBirthdayFormatDisplay)}}return TDS.util.Format.dateSpecial(e,TDS.env.dateBirthdayFormatDisplay)}},{header:"Age",dataIndex:"paxAge",editor:new Ext.form.NumberField({allowBlank:false}),renderer:function(e,c,b){if(e){return e}else{if(typeof b.get("dateOfBirth")!="undefined"){if(typeof b.get("dateOfBirth")!="string"){var a=new Date();a.setTime(Ext.TimerMgr.getServerCalculatedTime());var d=Math.floor((a.getTime()-b.get("dateOfBirth").getTime())/(365.25*24*60*60*1000));return((d&&d>0)?d:"")}else{var d=TDS.util.Format.age(b.get("dateOfBirth"));return((d&&d>0)?d:"")}}return""}}},{header:"Xtra",dataIndex:"extras",width:200,hidden:true,editor:new Ext.ux.form.SuperBoxSelect({editable:false,forceSelection:true,mode:"local",triggerAction:"all",displayField:"nameString",valueField:"offeringURI",emptyText:"Type",id:"cmb",xtype:"superboxselect",store:new Ext.data.SimpleStore({id:"dataURI",fields:["nameString","offeringURI"]}),listeners:{render:function(){var a=[];Ext.getCmp("xxx").findParentByType("tabpanel").findByType("grid")[0].getSelectionModel().selections.items.forEach(function(b){a.push(b.data)});this.getStore().loadData(a)}}}),renderer:function(c,e,a,f,d,b){if(c!=""){e.attr='ext:qtip="'+c+'"'}return c}},{header:"Additional Baggage",dataIndex:"additinalBaggae",width:150,editor:new Ext.form.ComboBox({store:new Ext.data.SimpleStore({storeId:"baggageStore",fields:["name","value"],data:[[" "," "],[1,1],[2,2]]}),mode:"local",triggerAction:"all",typeAhead:true,displayField:"name",valueField:"value",value:"1"})}],viewConfig:{forceFit:true},bbar:[{xtype:"button",text:"Add",handler:function(){var b=this.ownerCt.items.itemAt(1);var a=this.ownerCt.items.itemAt(2);a.enable();b.enable();this.disable();var d=this.ownerCt.ownerCt;var c=d.getStore();c.add([new c.recordType({type:"AD",nameFirst:"",nameLast:""})]);d.newRecordIndex=c.getCount()-1;d.startEditing(d.newRecordIndex,1);d.getSelectionModel().selectRow(d.newRecordIndex)}},{xtype:"button",text:"Cancel",disabled:true,handler:function(){var c=this.ownerCt.items.itemAt(0);var b=this.ownerCt.items.itemAt(2);c.enable();b.disable();var d=this.ownerCt.ownerCt;var a=d.getStore().getAt(d.newRecordIndex);if(a==-1||typeof a.get("dataURI")!="undefined"){return}d.getStore().remove(a);this.disable()}},{xtype:"button",text:"Save",disabled:true,handler:function(){var b=this.ownerCt.findParentByType("awesomewindow");var f=this.ownerCt.ownerCt;var e=this.ownerCt.items.itemAt(0);var d=this.ownerCt.items.itemAt(1);d.disable();this.disable();var a=f.getStore().getAt(f.newRecordIndex);var i=f.getSelectionModel().getSelections();var c="",h="";if(i.length==1){if(typeof i[0].get("dataURI")!="undefined"){c="PUT",h=TDS.env.dataPath+i[0].get("dataURI")}else{c="POST",h=TDS.env.dataPath+b.getDataURI("pnr")+"/passengers"}}Ext.Ajax.request({url:h,jsonData:i[0].data,method:c,callback:function(k,g,j){if(g){f.getStore().load();e.enable()}else{d.enable();this.enable()}},scope:this})}},{xtype:"button",text:"Addional Info",handler:function(h){var c=this.ownerCt.findParentByType("awesomewindow");var f=this.ownerCt.ownerCt;var b=f.getStore().getAt(f.newRecordIndex);var a="";var d=this.ownerCt.ownerCt.getSelectionModel().selections;if(d.length==1){a=d.items[0].get("dataURI")}TDS.innerWindow.setWindow({height:300,width:200,autoDestroy:false,title:"Passenger Profile",interfaceURI:"pnr/passenger/passengerDetails.js",sourceDataURI:a,destinationDataURI:a,closeAction:"hide",buttonOK:"Submit",callback:{fn:function(g,i,e){},scope:this}})}}],id:"xxx",listeners:{beforerender:function(){},sessioninit:function(){this.searchURI=TDS.env.dataPath+pnrDataURI+"/cruisePorts"},render:function(){var selectedFlight=this.findParentByType("tabpanel").findByType("grid")[0].getSelectionModel().selections.items;var w=this.ownerCt.findParentByType("awesomewindow");with(this.store){reader.meta.identifier=w.getDataURI("pnr")+"/passengers";proxy.conn.url=TDS.env.dataPath+w.getDataURI("pnr")+"/passengers/concise";load()}},afteredit:function(a){if(this.getSelectionModel().getSelections()[0].dirty){this.getBottomToolbar().items.itemAt(2).enable()}}}},{xtype:"panel",style:"padding: 0; margin-top: 25px; margin-bottom: 4px;",border:false,layout:"table",layoutConfig:{columns:5},defaults:{border:false},items:[{html:"",width:Ext.isIE?125:200},{xtype:"checkbox",name:"book",inputValue:false,hidden:true,listeners:{render:function(){}}},{html:"Extra Leg Room",style:"padding: 0; margin-left: 1px; margin-right: 25px;",width:Ext.isIE?43:125,hidden:true},{xtype:"checkbox",name:"quote",inputValue:true,hidden:true,listeners:{render:function(){}}},{html:"Priority Check In",style:"padding: 0; margin-left: 1px; margin-right:25px;",width:Ext.isIE?38:120,hidden:true},{html:"",width:Ext.isIE?125:200},{},{html:" ",width:Ext.isIE?43:125},{xtype:"checkbox",name:"bording",inputValue:true,hidden:true,listeners:{render:function(){}}},{html:"Priority Boarding",style:"padding: 0; margin-left: 1px; margin-right:25px;",width:Ext.isIE?38:120,hidden:true}]}]}]}]},{xtype:"panel",title:"Air Package",layout:"fit",frame:false,items:[{xtype:"panel",layout:"border",items:[{xtype:"panel",height:50,width:200,frame:true,border:false,region:"north",items:[{xtype:"panel",layout:"form",border:false,layout:"column",style:"margin-left:550px;",items:[]}]},{xtype:"panel",height:200,width:250,region:"center",border:false,frame:false,autoScroll:true,items:[{xtype:"panel",border:false,autoHeight:true,layout:"column",style:"padding-left:20px; padding-top:10px",items:[{xtype:"locationcombo",name:"locationURI",hideTrigger:false,width:120,listeners:{beforesearch:function(c){var b=this.ownerCt;var a=b.items.itemAt(4);c.searchURI=TDS.env.dataPath+"country/AS/locations/collection";c.searchIdentifier="country/AS/locations"},select:function(){var a=this.getValue();Ext.Ajax.request({url:TDS.env.dataPath+"components/air/accommodations",method:"GET",params:{locationToURI:a},success:function(b,e){var d=Ext.decode(b.responseText);var g=d.accommodation;if(typeof g=="undefined"){return}var f=[];for(var c=0;c<g.length;c++){d[g[c]].dataURI=g[c];f.push(d[g[c]])}Ext.getCmp("accommodation").getStore().loadData(f)}});Ext.Ajax.request({url:TDS.env.dataPath+"components/air/dayTours",method:"GET",params:{locationToURI:a},success:function(b,e){var d=Ext.decode(b.responseText);var g=d.sight;if(typeof g=="undefined"){return}var f=[];for(var c=0;c<g.length;c++){d[g[c]].dataURI=g[c];f.push(d[g[c]])}Ext.getCmp("SIGHTGrid").getStore().loadData(f)}});Ext.Ajax.request({url:TDS.env.dataPath+"components/air/service",method:"GET",params:{locationToURI:a},success:function(b,e){var d=Ext.decode(b.responseText);var g=d.attraction;if(typeof g=="undefined"){return}var f=[];for(var c=0;c<g.length;c++){d[g[c]].dataURI=g[c];f.push(d[g[c]])}Ext.getCmp("attractionGrid").getStore().loadData(f)}});Ext.Ajax.request({url:TDS.env.dataPath+"components/air/transfer",method:"GET",params:{locationToURI:a},success:function(b,e){var d=Ext.decode(b.responseText);var g=d.transfer;if(typeof g=="undefined"){return}var f=[];for(var c=0;c<g.length;c++){d[g[c]].dataURI=g[c];f.push(d[g[c]])}Ext.getCmp("tranfergrid").getStore().loadData(f)}})}}}]},{xtype:"panel",border:false,autoHeight:true,layout:"column",style:"padding-left:20px; padding-top:10px",items:[{xtype:"panel",width:150,border:false,items:[{html:"<b>ACCOMMODATION:</b>",border:false,style:" padding:5px"}]},{xtype:"grid",autoHeight:true,hideHeaders:true,border:false,width:450,store:new Ext.data.JsonStore({url:"",identifier:"",fields:["locationToString","name","inDate","outDate","roomType","dataURI","accommodationRatingURI","basis","rateUri","packagePrice","status","inventoryTypeURI","maximumOccupancy"]}),viewConfig:{forceFit:true},id:"accommodation",sm:new Ext.grid.CheckboxSelectionModel({singleSelect:false}),clicksToEdit:1,cm:new Ext.grid.ColumnModel([new Ext.grid.CheckboxSelectionModel({singleSelect:false,dataIndex:"CheckBoxValue"}),{header:"Destination",dataIndex:"locationToString"},{header:"Hotel",dataIndex:"name"},{header:"In Date",dataIndex:"inDate"},{header:"Out Date",dataIndex:"outDate"},{header:"Room Type",dataIndex:"roomType"},{dataIndex:"packagePrice"},{header:"Status",dataIndex:"status"}]),listeners:{render:function(){}}}]},{xtype:"panel",border:false,style:"padding-left:20px; padding-top:10px",autoHeight:true,layout:"column",items:[{xtype:"panel",width:150,border:false,items:[{html:"<b>DAY TOURS:</b>",border:false,style:" padding:5px"}]},{xtype:"grid",autoHeight:true,hideHeaders:true,border:false,width:450,height:25,store:new Ext.data.JsonStore({url:"",identifier:"",fields:["locationToString","name","inDate","departureDate","sightseeingTypeURI","dayTourType","dataURI","time","status","rateUri","rateClassUri","packagePrice","duration","departureTime","sightseeingTypeURI"]}),viewConfig:{forceFit:true},id:"SIGHTGrid",sm:new Ext.grid.CheckboxSelectionModel({singleSelect:false}),clicksToEdit:1,cm:new Ext.grid.ColumnModel([new Ext.grid.CheckboxSelectionModel({singleSelect:false,dataIndex:"CheckBoxValue"}),{header:"Destination",dataIndex:"locationToString"},{header:"Hotel",dataIndex:"name"},{header:"Out Date",dataIndex:"departureTime",renderer:function(e,d,a,f,c,b){return"Departs  "+a.get("departureTime")}},{header:"Room Type",dataIndex:"duration",renderer:function(e,d,a,f,c,b){return"Duration  "+a.get("duration")+"  Hours"}},{dataIndex:"packagePrice"},{header:"Status",dataIndex:"status"}]),listeners:{render:function(){}}}]},{xtype:"panel",border:false,style:"padding-left:20px; padding-top:10px",autoHeight:true,layout:"column",items:[{xtype:"panel",width:150,border:false,items:[{html:"<b>SERVICES:</b>",border:false,style:" padding:5px"}]},{xtype:"grid",autoHeight:true,hideHeaders:true,border:false,width:450,height:25,store:new Ext.data.JsonStore({url:"",identifier:"",fields:["locationToString","locationURI","name","attaractionTime","departureDate","attractionTypeName","rateUri","packagePrice","status","rateClassUri","dataURI","accommodationRatingURI"]}),viewConfig:{forceFit:true},id:"attractionGrid",sm:new Ext.grid.CheckboxSelectionModel({singleSelect:false}),clicksToEdit:1,cm:new Ext.grid.ColumnModel([new Ext.grid.CheckboxSelectionModel({singleSelect:false,dataIndex:"CheckBoxValue"}),{header:"Destination",dataIndex:"locationToString"},{header:"Hotel",dataIndex:"name"},{header:"attractionTypeName",dataIndex:"attractionTypeName"},{header:"Out Date",dataIndex:"departureDate"},{header:"Room Type",dataIndex:"attaractionTime"},{dataIndex:"packagePrice"},{header:"Status",dataIndex:"status"}]),listeners:{render:function(){}}}]},{xtype:"panel",border:false,autoHeight:true,layout:"column",style:"padding-left:20px; padding-top:10px",items:[{xtype:"panel",width:150,border:false,items:[{html:"<b>TRANSFER:</b>",border:false,style:" padding:5px"}]},{xtype:"grid",hideHeaders:true,autoHeight:true,border:false,width:450,height:25,store:new Ext.data.JsonStore({url:"",identifier:"",fields:["locationToString","name","inDate","departureDate","modeType","dataURI","rateClassUri","rateUri","status","packagePrice","transferModeTypeURI","accommodationRatingURI","toMode","fromMode","transferPlaceTypeFromURI","transferPlaceTypeToURI"]}),viewConfig:{forceFit:true},id:"tranfergrid",sm:new Ext.grid.CheckboxSelectionModel({singleSelect:false}),clicksToEdit:1,cm:new Ext.grid.ColumnModel([new Ext.grid.CheckboxSelectionModel({singleSelect:false,dataIndex:"CheckBoxValue"}),{header:"Destination",dataIndex:"locationToString"},{header:"Hotel",dataIndex:"modeType"},{header:"Out Date",dataIndex:"departureDate"},{header:"Room Type",dataIndex:"fromMode"},{header:"Room Type",dataIndex:"toMode"},{dataIndex:"packagePrice"},{header:"Status",dataIndex:"status"}]),listeners:{render:function(){}}}]}]},{xtype:"panel",height:60,frame:true,border:false,region:"south",items:[{xtype:"panel",style:" padding-left:400px",layout:"table",layoutConfig:{columns:4},items:[{xtype:"button",text:"Modify",width:200,handler:function(){if(Ext.getCmp("accommodation").getSelectionModel().getSelections().length>0){Ext.getCmp("tab").items.itemAt(3).setDisabled(false);Ext.getCmp("tab").setActiveTab(3);var f=Ext.getCmp("tab").items.itemAt(3).items.itemAt(0).items.itemAt(0).items;var c=Ext.getCmp("accommodation").getSelectionModel().getSelections()[0].data;f.itemAt(1).setValue(c.locationToString);f.itemAt(11).setValue(c.accommodationRatingURI);f.itemAt(6).setValue(c.name);f.itemAt(13).setValue(c.basis);f.itemAt(8).setValue(c.maximumOccupancy);f.itemAt(3).setValue(c.inventoryTypeURI);f.itemAt(16).setValue(TDS.util.Format.dateFormatNew(c.inDate));Ext.getCmp("tab").items.itemAt(3).items.itemAt(0).items.itemAt(1).items.itemAt(0).items.itemAt(0).items.itemAt(1).setValue(TDS.util.Format.dateFormatNew(c.outDate));var e=Math.round(Math.abs((new Date(c.inDate).getTime()-new Date(c.outDate).getTime())/(86400000)));Ext.getCmp("tab").items.itemAt(3).items.itemAt(0).items.itemAt(1).items.itemAt(0).items.itemAt(0).items.itemAt(3).setValue(e)}else{if(Ext.getCmp("SIGHTGrid").getSelectionModel().getSelections().length>0){Ext.getCmp("tab").items.itemAt(4).setDisabled(false);Ext.getCmp("tab").setActiveTab(4);var d=Ext.getCmp("tab").items.itemAt(4).items.itemAt(0).items.itemAt(0).items;var c=Ext.getCmp("SIGHTGrid").getSelectionModel().getSelections()[0].data;d.itemAt(1).setValue(c.locationToString);d.itemAt(6).setValue(c.rateClassUri);d.itemAt(11).setValue(c.name);d.itemAt(16).setValue(TDS.util.Format.dateFormatNew(c.departureDate));Ext.getCmp("tab").items.itemAt(4).items.itemAt(0).items.itemAt(1).items.itemAt(0).items.itemAt(0).items.itemAt(1).setValue(c.departureTime)}else{if(Ext.getCmp("attractionGrid").getSelectionModel().getSelections().length>0){Ext.getCmp("tab").items.itemAt(5).setDisabled(false);Ext.getCmp("tab").setActiveTab(5);var a=Ext.getCmp("tab").items.itemAt(5).items.itemAt(0).items;var c=Ext.getCmp("attractionGrid").getSelectionModel().getSelections()[0].data;a.itemAt(0).items.itemAt(1).setValue(c.locationToString);a.itemAt(0).items.itemAt(6).setValue(c.rateClassUri);a.itemAt(0).items.itemAt(11).setValue(c.name);a.itemAt(0).items.itemAt(16).setValue(TDS.util.Format.dateFormatNew(c.departureDate));Ext.getCmp("tab").items.itemAt(5).items.itemAt(0).items.itemAt(1).items.itemAt(0).items.itemAt(0).items.itemAt(1).setValue(c.attaractionTime)}else{if(Ext.getCmp("tranfergrid").getSelectionModel().getSelections().length>0){Ext.getCmp("tab").items.itemAt(6).setDisabled(false);Ext.getCmp("tab").setActiveTab(6);var b=Ext.getCmp("tab").items.itemAt(6).items.itemAt(0).items;var c=Ext.getCmp("tranfergrid").getSelectionModel().getSelections()[0].data;b.itemAt(0).items.itemAt(1).setValue(c.locationToString);b.itemAt(0).items.itemAt(16).setValue(c.transferModeTypeURI);b.itemAt(0).items.itemAt(18).setValue(c.rateClassUri);b.itemAt(0).items.itemAt(21).setValue(c.transferPlaceTypeFromURI);b.itemAt(0).items.itemAt(11).setValue(TDS.util.Format.dateFormatNew(c.departureDate));b.itemAt(1).items.itemAt(0).items.itemAt(0).items.itemAt(1).setValue(c.transferPlaceTypeToURI)}}}}}},{width:50},{xtype:"button",text:"ADD",width:100,id:"book",handler:function(){}}]}]}]}]},{title:"Accommodation",layout:"form",frame:true,items:[{xtype:"panel",layout:"form",autoScroll:true,listeners:{render:function(a){}},items:[{xtype:"panel",layout:"table",style:" padding-top: 10px;padding-right: 20px;padding-left: 20px; ",layoutConfig:{columns:5},items:[{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 20px; ",html:"City :"},{xtype:"textfield",name:"locationURI",readOnly:true,width:137},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 15px; padding-left: 50px; ",html:"Room Type :"},{xtype:"combo",name:"inventoryTypeURI",mode:"local",id:"roomType",width:150,listWidth:150,triggerAction:"all",editable:false,displayField:"displayName",valueField:"dataURI",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"accommodation/inventorytypes/collection",identifier:"accommodation/inventorytypes",fields:["name","displayName","dataURI"]})},{border:false},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 20px;  ",html:"Hotel :"},{xtype:"combo",name:"hotelName",displayField:"name",valueField:"dataURI",listWidth:120,width:120,selectOnFocus:true,triggerAction:"all",enableKeyEvents:true,editable:false,typeAhead:true,lazyRender:true,store:new Ext.data.Store({url:TDS.env.dataPath+"components/accommodation",identifier:"hotels?postHotel=false",fields:["name","nameString","accommodationRatingURI"],autoLoad:false,reader:new Ext.data.CollectionReader({identifier:"hotels",fields:["name","nameString","accommodationRatingURI"]})}),listeners:{beforequery:function(b){var d=this.findParentByType("awesomewindow").getData("rateURI");var a=this.findParentByType("awesomewindow").getDataURI("supplierURI");var c=this.ownerCt.items.itemAt(11);this.getStore().removeAll();this.getStore().proxy.conn.method="POST",this.getStore().proxy.conn.url=TDS.env.dataPath+"components/air/accommodation",this.getStore().load({})},select:function(d,a,b){var c=this.findParentByType("panel").findByType("datefield")[0];var e=this.ownerCt.items.itemAt(1);c.setValue(TDS.util.Format.dateFormatNew(a.data.inDate));this.findParentByType("panel").findByType("combo")[0].setValue("");this.findParentByType("panel").findByType("combo")[3].setValue("");this.findParentByType("panel").findByType("combo")[2].setValue(a.data.accommodationRatingURI)},beforerender:function(a){}}},{style:"padding-bottom: 10px;padding-top: 10px;padding-right: 25px; padding-left: 50px; ",html:"Max In Room :"},{xtype:"textfield",name:"maxInRoom",width:150,readOnly:true,listeners:{}},{border:false},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 20px;  ",html:"Rating :"},{xtype:"combo",id:"rating",name:"accommodationRatingURI",hideTrigger:true,readOnly:true,enableKeyEvents:false,mode:"local",fieldLabel:"Rating",width:100,triggerAction:"all",editable:false,displayField:"name",valueField:"dataURI",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"accommodation/ratings/collection",identifier:"accommodation/ratings",fields:["name","dataURI"]}),listeners:{}},{style:"padding-bottom: 10px;padding-top: 10px;padding-right: 25px; padding-left: 50px; ",html:"Basis :"},{xtype:"combo",width:150,name:"basisURI",displayField:"name",valueField:"name",listWidth:150,mode:"local",selectOnFocus:true,triggerAction:"all",enableKeyEvents:true,editable:false,typeAhead:true,lazyRender:true,store:new Ext.data.Store({url:TDS.env.dataPath+"components/basis",identifier:"rateBasis",fields:["name","rateId","id","inventoryTypeURI"],reader:new Ext.data.CollectionReader({identifier:"rateBasis",fields:["name","rateId","id","inventoryTypeURI"]})}),listeners:{beforequery:function(b){var d=this.findParentByType("awesomewindow").getData("rateURI");var c=this.findParentByType("panel").findByType("combo")[1].getValue();var a=this.findParentByType("panel").findByType("combo")[0].getValue();this.getStore().proxy.conn.method="POST",this.getStore().proxy.conn.url=TDS.env.dataPath+"components/air/basis",this.getStore().load({params:{hotel:c,roomType:a}})},select:function(d,a,b){var c=this.findParentByType("awesomewindow").getData("rateURI")}}},{border:false},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 20px;  ",html:"In Date :"},{xtype:"datefield",width:100,format:"dMy",name:"inDate",id:"inDate",enableKeyEvents:true,showToday:false,menuListeners:Ext.applyIf({select:function(d,c){Ext.form.DateField.prototype.menuListeners.select.call(this,d,c);var b=this.getValue();var a=this.findParentByType("panel").ownerCt.findByType("datefield")[1].getValue();var e=this.findParentByType("panel").ownerCt.findByType("textfield")[9];if((a-b)>=0){e.setValue((a-b)/86400000)}else{e.setValue("")}}},Ext.form.DateField.prototype.menuListeners)},{html:"No. of Rooms :",style:"padding-bottom: 10px;padding-top: 10px;padding-right: 25px; padding-left: 50px; "},{xtype:"combo",width:150,excludeSubmit:true,name:"noOfRoom",value:1,enableKeyEvents:true,minChars:1,enableKeyEvents:true,mode:"local",listWidth:150,editable:false,typeAhead:true,excludeFromSession:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"text",valueField:"text",store:new Ext.data.SimpleStore({fields:["text","text"],data:[["1","1"],["2","2"],["3","3"],["4","4"]]})},{xtype:"button",text:"Guests",style:" padding-left: 120px; "}]},{xtype:"panel",layout:"column",style:" padding-right: 15px; padding-left: 20px; ",height:150,items:[{xtype:"panel",columnWidth:0.55,height:150,items:[{xtype:"panel",layout:"table",layoutConfig:{columns:2},items:[{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 20px; padding-left: 18px; ",html:"Out Date :"},{fieldLabel:"Out Date :",xtype:"datefield",width:100,format:"dMy",name:"outDate",readOnly:true,menuListeners:Ext.applyIf({select:function(d,c){Ext.form.DateField.prototype.menuListeners.select.call(this,d,c);var a=this.getValue();var b=this.findParentByType("panel").ownerCt.ownerCt.ownerCt.findByType("datefield")[0].getValue();var e=this.findParentByType("panel").ownerCt.findByType("textfield")[1];if((a-b)>=0){e.setValue((a-b)/86400000)}else{e.setValue("")}}},Ext.form.DateField.prototype.menuListeners)},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 20px; padding-left: 20px; ",html:"Nights :"},{xtype:"textfield",name:"night",width:100}]},{},{xtype:"panel",style:"padding-top: 5px;padding-left: 10px;",id:"AAA",width:400,height:80,autoScroll:true,itemSelector:"rule-item",items:[{xtype:"dataview",title:"Test",autoHeight:true,multiSelect:true,overItemCls:"x-view-over",itemSelector:"div.thumb-wrap",trackOver:true,emptyText:"No images to display",tpl:new Ext.XTemplate(['<br><div class="thumb-wrap"><table class="preHotels" border=1;>',"<thead>",'<tr style="background-color: #d0def0;">','<tpl for="list">','<th style="padding-bottom: 2px; width: 60px; position:inherit; ">{date} </th>',"</tpl>","</tr>","</thead>","<tr >",'<tpl for="list">','<td style="  ">OK{unreservedAvailable}</td>',"</tpl>","</tr>","<tr >",'<tpl for="list">','<td ><input type="checkbox" class="rule-item" id= "{date}"></td>',"</tpl>","</tr>","</table></div>"]),listeners:{containerclick:function(c,b,f,a,e,d){}}}]}]},{xtype:"panel",style:"padding-bottom: 10px;padding-right: 25px; padding-left: 70px;padding-top:5px; ",id:"BBB",columnWidth:0.45,height:150,items:[{tpl:new Ext.XTemplate(['<div style = "padding-top:10px;padding-left:20px;"><b><font size="2">Room : 1</b><div>',"<br><table  border=0;>","<thead>",'<tr><th style=" width: 300px;">Guest</th><th style=" width: 150px;">Type</th><th style=" width: 150px;">Age</th></tr>',"</thead>","</table>"])}],listeners:{render:function(){this.body.setStyle("background","white")}}}]},{xtype:"panel",layout:"column",style:" padding-left: 100px; ",items:[{style:"padding-top: 4px;",html:"Status :"},{xtype:"textfield",width:80,readOnly:true},{html:"Adjusted Amount :",style:" padding-left: 25px;  "},{xtype:"textfield",width:80,name:"packagePrice",readOnly:true}]},{xtype:"panel",layout:"table",style:" padding-left: 250px; padding-top: 20px; ",border:true,hideBorders:true,layoutConfig:{columns:4},items:[{xtype:"button",text:"Select",id:"updates",handler:function(){}},{xtype:"button",text:"Availability",style:" padding-left: 50px;",id:"avail",handler:function(){var b={};var c=this.ownerCt.findParentByType("awesomewindow").aw;this.ownerCt.findParentByType("awesomewindow").getDataURI("offering");this.ownerCt.findParentByType("awesomewindow").getDataURI("pnr");var e=Ext.getCmp("inDate").getValue();var a=Ext.getCmp("roomType").getValue();var d=Ext.Ajax.request({url:TDS.env.dataPath+"components/air/availabilty",method:"POST",params:{offeringId:Ext.getCmp("accommodation").getSelectionModel().getSelections()[0].get("dataURI"),roomType:a,inDate:e,dateDays:6,numberToReserve:1},success:function(f,g){var h=Ext.decode(f.responseText);Ext.getCmp("AAA").items.itemAt(0).tpl.overwrite(Ext.getCmp("AAA").body,h)},scope:this})}},{xtype:"button",text:"Clear",id:"clear",style:" padding-left: 50px;",handler:function(){var a=this.findParentByType("form").getForm();a.findField("roomType").reset();a.findField("hotelName").reset();a.findField("maxInRoom").reset();a.findField("accommodationRatingURI").reset();a.findField("basisURI").reset();a.findField("inDate").reset();a.findField("noOfRoom").reset();a.findField("outDate").reset();a.findField("night").reset();a.findField("packagePrice").reset();var b=[];Ext.getCmp("AAA").items.itemAt(0).tpl.overwrite(Ext.getCmp("AAA").body,b)}},{xtype:"button",text:"Description",style:" padding-left: 50px;",handler:function(){}}]}]}]},{title:"Day Tours",layout:"form",frame:true,items:[{xtype:"panel",layout:"form",autoScroll:true,listeners:{render:function(a){}},items:[{xtype:"panel",layout:"table",style:" padding-top: 10px;padding-right: 20px;padding-left: 20px; ",layoutConfig:{columns:5},totalPaxPerRoomCalc:function(){var b=this.items.itemAt(3).items.itemAt(0).getValue();var d=this.items.itemAt(8).items.itemAt(0).getValue();b=b?b:0;d=d?d:0;this.items.itemAt(13).setValue(b+d)},items:[{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 20px; ",html:"City :"},{xtype:"textfield",name:"locationURI",readOnly:true,width:122},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 100px; ",html:"Adults:"},{xtype:"panel",layout:"fit",width:100,items:[{xtype:"combo",name:"adultNo",width:30,value:1,store:[0,1,2,3,4,5,6,7,8,9,10],name:"A1",triggerAction:"all",readOnly:true,width:42,listeners:{select:function(){this.ownerCt.ownerCt.totalPaxPerRoomCalc()}}}]},{border:false},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 20px;  ",html:"Type :"},{xtype:"combo",id:"rate",name:"rateClassURI",listWidth:120,width:120,selectOnFocus:true,triggerAction:"all",enableKeyEvents:true,editable:false,typeAhead:true,lazyRender:true,mode:"local",displayField:"name",valueField:"dataURI",tpl:TDS.util.Templates.ComboNoLabel,store:TDS.data.getStore({dataURI:TDS.env.dataPath+"rate/classes/collection",identifier:"rate/classes",fields:["name","dataURI"]}),listeners:{}},{style:"padding-bottom: 10px;padding-top: 10px;padding-right: 25px; padding-left: 100px; ",html:"Child :"},{xtype:"panel",layout:"fit",width:100,items:[{xtype:"combo",store:[0,1,2,3,4,5],name:"C1",triggerAction:"all",readOnly:true,width:40,listeners:{select:function(){this.ownerCt.ownerCt.totalPaxPerRoomCalc();var c=this.ownerCt.ownerCt.items.itemAt(9).items;var b=this.getValue();for(var a=0;a<5;a++){if(a<b){c.itemAt(a).show(true)}else{c.itemAt(a).hide(true)}}}}}]},{border:false},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 20px;  ",html:"Tour Name :"},{xtype:"combo",name:"tourName",displayField:"name",valueField:"dataURI",id:"d",listWidth:120,width:120,selectOnFocus:true,triggerAction:"all",enableKeyEvents:true,editable:false,typeAhead:true,lazyRender:true,store:new Ext.data.Store({url:TDS.env.dataPath+"components/accommodation",identifier:"tours",fields:["name","nameString"],autoLoad:false,reader:new Ext.data.CollectionReader({identifier:"tours",fields:["name","nameString"]})}),listeners:{beforequery:function(b){var d=this.findParentByType("awesomewindow").getData("rateURI");var a=this.findParentByType("awesomewindow").getDataURI("supplierURI");var c=this.ownerCt.items.itemAt(11);this.getStore().removeAll();this.getStore().proxy.conn.method="POST",this.getStore().proxy.conn.url=TDS.env.dataPath+"components/air/dayTour",this.getStore().load({})}}},{style:"padding-bottom: 10px;padding-top: 10px;padding-right: 25px; padding-left: 100px; ",html:"Total Pax :"},{xtype:"numberfield",name:"totalPax",width:99},{border:false},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 20px;  ",html:"Dept Date :"},{xtype:"datefield",width:100,format:"dMy",name:"deptDate",id:"deptDate"},{border:false},{xtype:"button",text:"Passenger"},{border:false}]},{xtype:"panel",layout:"column",style:" padding-right: 15px; padding-left: 20px; ",height:150,items:[{xtype:"panel",columnWidth:0.55,height:150,items:[{xtype:"panel",layout:"table",layoutConfig:{columns:2},items:[{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 55px; padding-left: 20px; ",html:"Time :"},{xtype:"textfield",width:100,name:"time",readOnly:true}]},{},{xtype:"panel",style:"padding-top: 5px;padding-left: 10px;",id:"EEE",width:400,height:100,autoScroll:true,tpl:new Ext.XTemplate(['<br><table class="dayTours" border=1;>',"<thead>",'<tr style="background-color: #d0def0;">','<tpl for="list">','<th style="padding-bottom: 2px; width: 50px; position:inherit; ">{date}</th>',"</tpl>","</tr>","</thead>","<tr >",'<tpl for="list">','<td style="  ">OK{unreservedAvailable}</td>',"</tpl>","</tr>","<tr >",'<tpl for="list">','<td ><input type="checkbox" class=" x-form-checkbox x-form-field" id= "{date}"></td>',"</tpl>","</tr>","</table>"])}]},{xtype:"panel",style:"padding-bottom: 10px;padding-right: 25px; padding-left: 120px; ",id:"FFF",columnWidth:0.45,height:150,items:[{tpl:new Ext.XTemplate(["<br><table  border=0;>","<thead>",'<tr><th style=" width: 300px;">Passenger</th><th style=" width: 150px;">Type</th><th style=" width: 150px;">Age</th></tr>',"</thead>","</table>"])}],listeners:{render:function(){}}}]},{xtype:"panel",layout:"column",style:" padding-left: 100px; ",items:[{style:"padding-top: 4px;",html:"Status :"},{xtype:"textfield",width:80,readOnly:true},{html:"Adjusted Amount :",style:" padding-left: 25px;  "},{xtype:"textfield",width:80,name:"packagePrice",readOnly:true}]},{xtype:"panel",layout:"table",style:" padding-left: 250px; padding-top: 20px; ",border:true,hideBorders:true,layoutConfig:{columns:4},items:[{xtype:"button",text:"Select",id:"updates",handler:function(){}},{xtype:"button",text:"Availability",style:" padding-left: 50px;",id:"availss",handler:function(){var a={};var b=this.ownerCt.findParentByType("awesomewindow").aw;this.ownerCt.findParentByType("awesomewindow").getDataURI("offering");this.ownerCt.findParentByType("awesomewindow").getDataURI("pnr");var d=Ext.getCmp("deptDate").getValue();var c=Ext.Ajax.request({url:TDS.env.dataPath+"components/air/availabilty/daytour",method:"POST",params:{offeringId:Ext.getCmp("d").getValue(),paxtype:Ext.getCmp("rate").getValue(),inDate:d,dateDays:6,numberToReserve:1},success:function(e,f){var g=Ext.decode(e.responseText);Ext.getCmp("EEE").tpl.overwrite(Ext.getCmp("EEE").body,g)},scope:this})}},{xtype:"button",text:"Clear",style:" padding-left: 50px;",handler:function(){var a=this.findParentByType("tabpanel").getActiveTab().findByType("combo");a[0].reset();a[1].reset();a[2].reset();a[3].reset();var c=this.findParentByType("tabpanel").getActiveTab().findByType("textfield");c[5].reset();c[6].reset();c[7].reset();var b=[];Ext.getCmp("EEE").tpl.overwrite(Ext.getCmp("EEE").body,b)}},{xtype:"button",text:"Description",style:" padding-left: 50px;",handler:function(){}}]}]}]},{title:"Services",layout:"form",frame:true,items:[{xtype:"panel",layout:"form",autoScroll:true,listeners:{render:function(a){}},items:[{xtype:"panel",layout:"table",style:" padding-top: 10px;padding-right: 20px;padding-left: 20px; ",layoutConfig:{columns:5},totalPaxPerRoomCalc:function(){var b=this.items.itemAt(3).items.itemAt(0).getValue();var d=this.items.itemAt(8).items.itemAt(0).getValue();b=b?b:0;d=d?d:0;this.items.itemAt(13).setValue(b+d)},items:[{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 20px; ",html:"City :"},{xtype:"textfield",name:"locationURI",readOnly:true,width:122},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 100px; ",html:"Adults:"},{xtype:"panel",layout:"fit",width:100,items:[{xtype:"combo",name:"adultNo",width:30,value:1,store:[0,1,2,3,4,5,6,7,8,9,10],name:"A1",triggerAction:"all",readOnly:true,width:42,listeners:{select:function(){this.ownerCt.ownerCt.totalPaxPerRoomCalc()}}}]},{border:false},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 20px;  ",html:"Type :"},{xtype:"combo",name:"rateClassURI",id:"rate1",listWidth:120,width:120,selectOnFocus:true,triggerAction:"all",enableKeyEvents:true,editable:false,typeAhead:true,lazyRender:true,mode:"local",displayField:"name",valueField:"dataURI",tpl:TDS.util.Templates.ComboNoLabel,store:TDS.data.getStore({dataURI:TDS.env.dataPath+"rate/classes/collection",identifier:"rate/classes",fields:["name","dataURI"]})},{style:"padding-bottom: 10px;padding-top: 10px;padding-right: 25px; padding-left: 100px; ",html:"Child :"},{xtype:"panel",layout:"fit",width:100,items:[{xtype:"combo",store:[0,1,2,3,4,5],name:"C1",triggerAction:"all",readOnly:true,width:40,listeners:{select:function(){this.ownerCt.ownerCt.totalPaxPerRoomCalc();var c=this.ownerCt.ownerCt.items.itemAt(9).items;var b=this.getValue();for(var a=0;a<5;a++){if(a<b){c.itemAt(a).show(true)}else{c.itemAt(a).hide(true)}}}}}]},{border:false},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 20px;  ",html:"Service Name :"},{xtype:"combo",width:120,name:"serviceName",displayField:"name",valueField:"dataURI",id:"f",listWidth:120,selectOnFocus:true,triggerAction:"all",enableKeyEvents:true,editable:false,typeAhead:true,lazyRender:true,store:new Ext.data.Store({url:TDS.env.dataPath+"components/accommodation",identifier:"tours",fields:["name","nameString","dataURI"],autoLoad:false,reader:new Ext.data.CollectionReader({identifier:"attraction",fields:["name","nameString","dataURI"]})}),listeners:{beforequery:function(b){var d=this.findParentByType("awesomewindow").getData("rateURI");var a=this.findParentByType("awesomewindow").getDataURI("supplierURI");var c=this.ownerCt.items.itemAt(11);this.getStore().removeAll();this.getStore().proxy.conn.method="POST",this.getStore().proxy.conn.url=TDS.env.dataPath+"components/air/services",this.getStore().load({})}}},{style:"padding-bottom: 10px;padding-top: 10px;padding-right: 25px; padding-left: 100px; ",html:"Total Pax :"},{xtype:"textfield",width:99,name:"totalPax"},{border:false},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 20px;  ",html:"Dept Date :"},{xtype:"datefield",width:120,format:"dMy",name:"deptDate",id:"deptDate1"},{border:false},{xtype:"button",text:"Passenger"},{border:false}]},{xtype:"panel",layout:"column",style:" padding-right: 15px; padding-left: 20px; ",height:150,items:[{xtype:"panel",columnWidth:0.55,height:150,items:[{xtype:"panel",layout:"table",layoutConfig:{columns:2},items:[{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 67px; padding-left: 20px; ",html:"Time :"},{xtype:"combo",allowBlank:false,name:"time",mode:"local",fieldLabel:"Time",width:120,listWidth:120,triggerAction:"all",editable:false,displayField:"name",valueField:"value",store:TDS.data.dayTimeStore}]},{},{xtype:"panel",style:"padding-top: 5px;padding-left: 10px;",id:"ggg",width:400,height:100,autoScroll:true,tpl:new Ext.XTemplate(['<br><table class="services" border=1;>',"<thead>",'<tr style="background-color: #d0def0;">','<tpl for="list">','<th style="padding-bottom: 2px; width: 50px; position:inherit; ">{date}</th>',"</tpl>","</tr>","</thead>","<tr >",'<tpl for="list">','<td style="  ">OK{unreservedAvailable}</td>',"</tpl>","</tr>","<tr >",'<tpl for="list">','<td ><input type="checkbox" class=" x-form-checkbox x-form-field" id= "{date}" ></td>',"</tpl>","</tr>","</table>"])}]},{xtype:"panel",style:"padding-bottom: 10px;padding-right: 25px; padding-left: 120px; ",id:"hhh",columnWidth:0.45,height:150,items:[{tpl:new Ext.XTemplate(["<br><table  border=0;>","<thead>",'<tr><th style=" width: 300px;">Passenger</th><th style=" width: 150px;">Type</th><th style=" width: 150px;">Age</th></tr>',"</thead>","</table>"])}],listeners:{render:function(){}}}]},{xtype:"panel",layout:"column",style:" padding-left: 100px; ",items:[{style:"padding-top: 4px;",html:"Status :"},{xtype:"textfield",width:80,readOnly:true},{html:"Adjusted Amount :",style:" padding-left: 25px;  "},{xtype:"textfield",width:80,name:"packagePrice",readOnly:true}]},{xtype:"panel",layout:"table",style:" padding-left: 250px; padding-top: 20px; ",border:true,hideBorders:true,layoutConfig:{columns:4},items:[{xtype:"button",text:"Select",handler:function(){}},{xtype:"button",text:"Availability",style:" padding-left: 50px;",id:"availsss",handler:function(){var a={};var b=this.ownerCt.findParentByType("awesomewindow").aw;this.ownerCt.findParentByType("awesomewindow").getDataURI("offering");this.ownerCt.findParentByType("awesomewindow").getDataURI("pnr");var d=Ext.getCmp("deptDate1").getValue();var c=Ext.Ajax.request({url:TDS.env.dataPath+"components/air/availabilty/attraction",method:"POST",params:{offeringId:Ext.getCmp("f").getValue(),paxtype:Ext.getCmp("rate1").getValue(),inDate:d,dateDays:6,numberToReserve:1},success:function(e,f){var g=Ext.decode(e.responseText);Ext.getCmp("ggg").tpl.overwrite(Ext.getCmp("ggg").body,g)},scope:this})}},{xtype:"button",text:"Clear",style:" padding-left: 50px;",handler:function(){var b=this.findParentByType("tabpanel").getActiveTab().findByType("textfield");b[1].reset();b[2].reset();b[3].reset();b[4].reset();b[5].reset();b[6].reset();b[7].reset();var a=[];Ext.getCmp("ggg").tpl.overwrite(Ext.getCmp("ggg").body,a)}},{xtype:"button",text:"Description",style:" padding-left: 50px;",handler:function(){}}]}]}]},{title:"Transfers",layout:"form",frame:true,items:[{xtype:"panel",layout:"form",autoScroll:true,listeners:{render:function(a){}},items:[{xtype:"panel",layout:"table",style:" padding-top: 10px;padding-right: 20px;padding-left: 20px; ",layoutConfig:{columns:5},totalPaxPerRoomCalc:function(){var b=this.items.itemAt(3).items.itemAt(0).getValue();var d=this.items.itemAt(8).items.itemAt(0).getValue();b=b?b:0;d=d?d:0;this.items.itemAt(13).setValue(b+d)},items:[{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 20px; ",html:"City :"},{xtype:"textfield",name:"locationURI",readOnly:true,width:137},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 100px; ",html:"Adults:"},{xtype:"panel",layout:"fit",width:100,items:[{xtype:"combo",name:"adultNo",width:30,value:1,store:[0,1,2,3,4,5,6,7,8,9,10],name:"A1",triggerAction:"all",readOnly:true,width:42,listeners:{select:function(){this.ownerCt.ownerCt.totalPaxPerRoomCalc()}}}]},{border:false},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 20px;  ",html:"Arrival Details :"},{xtype:"textfield",name:"arrivalDetails",width:137},{style:"padding-bottom: 10px;padding-top: 10px;padding-right: 25px; padding-left: 100px; ",html:"Child :"},{xtype:"panel",layout:"fit",width:100,items:[{xtype:"combo",store:[0,1,2,3,4,5],name:"C1",triggerAction:"all",readOnly:true,width:40,listeners:{select:function(){this.ownerCt.ownerCt.totalPaxPerRoomCalc();var c=this.ownerCt.ownerCt.items.itemAt(9).items;var b=this.getValue();for(var a=0;a<5;a++){if(a<b){c.itemAt(a).show(true)}else{c.itemAt(a).hide(true)}}}}}]},{border:false},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 20px;  ",html:"Date :"},{xtype:"datefield",width:120,format:"dMy",name:"deptDate",id:"deptDate3"},{style:"padding-bottom: 10px;padding-top: 10px;padding-right: 25px; padding-left: 100px; ",html:"Total Pax :"},{xtype:"textfield",width:99,name:"totalPax"},{border:false},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 25px; padding-left: 20px;  ",html:"Mode :"},{xtype:"combo",width:120,id:"modeType",name:"transferModeTypeURI",mode:"local",triggerAction:"all",editable:false,displayField:"name",valueField:"dataURI",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"transfer/modetypes/collection",identifier:"transfer/modetypes",fields:["name","dataURI"]})},{style:"padding-bottom: 10px;padding-top: 10px;padding-right: 25px; padding-left: 100px; ",html:"Type :"},{xtype:"combo",width:100,name:"rateClassURI",id:"rate2",listWidth:100,selectOnFocus:true,triggerAction:"all",enableKeyEvents:true,editable:false,typeAhead:true,lazyRender:true,mode:"local",displayField:"name",valueField:"dataURI",tpl:TDS.util.Templates.ComboNoLabel,store:TDS.data.getStore({dataURI:TDS.env.dataPath+"rate/classes/collection",identifier:"rate/classes",fields:["name","dataURI"]})},{border:false},{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 70px; padding-left: 20px; ",html:"From :"},{xtype:"combo",name:"transferPlaceTypeFromURI",mode:"local",fieldLabel:"From*",width:120,listWidth:120,triggerAction:"all",editable:false,displayField:"name",valueField:"dataURI",tpl:TDS.util.Templates.ComboNoLabel,store:TDS.data.getStore({dataURI:TDS.env.dataPath+"transfer/placetypes/collection",identifier:"transfer/placetypes",fields:["name","dataURI"]})},{border:false},{xtype:"button",text:"Passenger"},{border:false}]},{xtype:"panel",layout:"column",style:" padding-right: 15px; padding-left: 20px; ",height:115,items:[{xtype:"panel",columnWidth:0.55,height:115,items:[{xtype:"panel",layout:"table",layoutConfig:{columns:2},items:[{style:"padding-bottom: 10px;padding-top: 10px; padding-right: 83px; padding-left: 20px; ",html:"To :"},{xtype:"combo",name:"transferPlaceTypeToURI",mode:"local",fieldLabel:"To*",width:120,listWidth:120,triggerAction:"all",editable:false,displayField:"name",valueField:"dataURI",tpl:TDS.util.Templates.ComboNoLabel,store:TDS.data.getStore({dataURI:TDS.env.dataPath+"transfer/placetypes/collection",identifier:"transfer/placetypes",fields:["name","dataURI"]})}]},{},{xtype:"panel",style:"padding-top: 5px;padding-left: 10px;",id:"iii",width:400,height:100,autoScroll:true,tpl:new Ext.XTemplate(['<br><table class="transfer" border=1;>',"<thead>",'<tr style="background-color: #d0def0;">','<tpl for="list">','<th style="padding-bottom: 2px; width: 50px; position:inherit; ">{date}</th>',"</tpl>","</tr>","</thead>","<tr >",'<tpl for="list">','<td style="  ">OK{unreservedAvailable}</td>',"</tpl>","</tr>","<tr >",'<tpl for="list">','<td ><input type="checkbox" class=" x-form-checkbox x-form-field" id= "{date}"></td>',"</tpl>","</tr>","</table>"])}]},{xtype:"panel",style:"padding-bottom: 10px;padding-right: 25px; padding-left: 120px; ",id:"jjj",columnWidth:0.45,height:100,items:[{tpl:new Ext.XTemplate(["<br><table  border=0;>","<thead>",'<tr><th style=" width: 300px;">Passenger</th><th style=" width: 150px;">Type</th><th style=" width: 150px;">Age</th></tr>',"</thead>","</table>"])}],listeners:{render:function(){}}}]},{xtype:"panel",layout:"column",style:" padding-left: 100px; ",items:[{style:"padding-top: 4px;",html:"Status :"},{xtype:"textfield",width:80,readOnly:true},{html:"Adjusted Amount :",style:" padding-left: 25px;  "},{xtype:"textfield",width:80,name:"packagePrice",readOnly:true}]},{xtype:"panel",layout:"table",style:" padding-left: 250px; padding-top: 20px; ",border:true,hideBorders:true,layoutConfig:{columns:4},items:[{xtype:"button",text:"Select",id:"updates",handler:function(){}},{xtype:"button",text:"Availability",style:" padding-left: 50px;",id:"availss",handler:function(){var a={};var b=this.ownerCt.findParentByType("awesomewindow").aw;this.ownerCt.findParentByType("awesomewindow").getDataURI("offering");this.ownerCt.findParentByType("awesomewindow").getDataURI("pnr");var d=Ext.getCmp("deptDate3").getValue();var c=Ext.Ajax.request({url:TDS.env.dataPath+"components/air/availabilty/transfer",method:"POST",params:{offeringId:Ext.getCmp("tranfergrid").getSelectionModel().getSelections()[0].get("dataURI"),modeype:Ext.getCmp("modeType").getValue(),paxtype:Ext.getCmp("rate2").getValue(),inDate:d,dateDays:6,numberToReserve:1},success:function(e,f){var g=Ext.decode(e.responseText);Ext.getCmp("iii").tpl.overwrite(Ext.getCmp("iii").body,g)},scope:this})}},{xtype:"button",text:"Clear",style:" padding-left: 50px;",handler:function(){var b=this.findParentByType("tabpanel").getActiveTab().findByType("textfield");b[1].reset();b[2].reset();b[3].reset();b[4].reset();b[5].reset();b[6].reset();b[7].reset();b[8].reset();b[9].reset();var a=[];Ext.getCmp("iii").tpl.overwrite(Ext.getCmp("iii").body,a)}},{xtype:"button",text:"Description",style:" padding-left: 50px;",handler:function(){}}]}]}]}],listeners:{render:function(){this.items.itemAt(3).setDisabled(true);this.items.itemAt(4).setDisabled(true);this.items.itemAt(5).setDisabled(true);this.items.itemAt(6).setDisabled(true)}}}]}