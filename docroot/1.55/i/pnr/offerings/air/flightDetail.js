{xtype:"form",border:false,fileUpload:true,markDataDirtyOnLoad:true,height:300,width:1200,initialcall:true,tbar:["Record Locator: ",{html:"",name:"nameLike",enableKeyEvents:true,width:120}," ","TTL:",{xtype:"datefield",name:"ttlDate",showToday:false,format:"dMy",minValue:Ext.TimerMgr.getServerCalculatedDate().clearTime(),enableKeyEvents:true,width:120},"->",{xtype:"button",text:"Confirm Flights",disabled:true,handler:function(){;var a=this.ownerCt.ownerCt.items.itemAt(0).getSelectionModel().selections.items;var c=a[0].data.rloc;var b={status:TDS.data.componentStatus.STATUS_CONFIRMED};Ext.Ajax.request({url:TDS.env.dataPath+"pnr/"+c+"/flightconfirm",method:"PUT",jsonData:b,callback:function(f,d,e){if(d){}},scope:this})}},{xtype:"button",text:"Cancel Flights",disabled:true,handler:function(){;var a=this.ownerCt.ownerCt.items.itemAt(0).getSelectionModel().selections.items;var c=a[0].data.rloc;var b={status:TDS.data.componentStatus.STATUS_CANCELLED};Ext.Ajax.request({url:TDS.env.dataPath+"pnr/"+c+"/flightconfirm",method:"PUT",jsonData:b,callback:function(f,d,e){if(d){}},scope:this})}},{xtype:"button",text:"Hide Cancelled Flights",allowDepress:true,enableToggle:true,toggleHandler:function(a,b){}}],items:[{xtype:"grid",width:1200,height:300,border:false,enableColumnHide:false,enableColumnMove:false,enableColumnResize:false,enableHdMenu:false,viewConfig:{forceFit:true},rowspan:2,sm:new Ext.grid.CheckboxSelectionModel(),store:new Ext.data.JsonStore({fields:["dataURI","offeringURI","rloc","passengersTotal","timeHeldUntil","description","type","supplierURI","name","dateFrom","dateTo","pax","status","createdDate","createdByLogin","createdByUserFullNameString","updatedDate","updatedByLogin","updatedByUserFullNameString","supplierName","locationToString","locationFromString","airportToString","airportFromString","bookingReferenceNumber","pricingPriceCurrency","pricingPriceSell","pricingPriceIsNett","pricingPriceCommission","departTime","arrivalTime","noOfStops","airCraft","class","airportFromIataString","airportToIataString","externalPNRCode","TTLDate"]}),columns:[new Ext.grid.CheckboxSelectionModel(),{header:"Type",dataIndex:"type",hidden:true,renderer:function(a){if(a===TDS.data.componentType.TYPE_OWN){return"Own arrangement"}else{if(a===TDS.data.componentType.TYPE_MANUAL){return"Manual entry"}}return a.substring(0,1).toUpperCase()+a.substring(1).toLowerCase()}},{header:"Airline",dataIndex:"supplierName",width:140},{header:"RLOC",dataIndex:"rloc",width:140},{header:"Flt No",dataIndex:"name",width:60},{header:"Class",dataIndex:"class",width:130},{header:"From",dataIndex:"locationToString",width:150,renderer:function(c,b,a){return"<b>"+a.get("airportFromIataString")+"</b> ("+a.get("airportFromString")+")"}},{header:"To",dataIndex:"locationToString",width:150,renderer:function(c,b,a){return"<b>"+a.get("airportToIataString")+"</b> ("+a.get("airportToString")+")"}},{header:"Date",dataIndex:"dateTo",sortable:true,width:100,renderer:TDS.util.Format.dateSpecialRenderer(TDS.env.dateFormatDisplay)},{header:"Dep",dataIndex:"departTime",width:50},{header:"Arr",dataIndex:"arrivalTime",width:50},{header:"Stops",dataIndex:"noOfStops",width:60},{header:"Aircraft",dataIndex:"airCraft",width:100},{header:"Status",dataIndex:"status",width:80}],listeners:{rowclick:function(g,j,f){;var l=this.ownerCt.getTopToolbar();var k=l.items.itemAt(6);var a=l.items.itemAt(7);var h=this.getSelectionModel().selections.items;var b=this.getSelectionModel().selections.length;this.getView().refresh();for(var d=0;d<b-1;d++){if(h[d].data.rloc!=h[d+1].data.rloc&&h[d].data.status!=h[d+1].data.status){this.getView().refresh()}}if(b>0){var c=h[0].data.status;if(c==TDS.data.componentStatus.STATUS_CONFIRMED){k.enable()}if(c==TDS.data.componentStatus.STATUS_CANCELLED){a.enable()}}else{k.disable(true);a.disable(true)}}}}],listeners:{render:function(){;var b=this.ownerCt.initialConfig.dataURI+"/air/components/collection";var a=this.ownerCt.initialConfig.dataURI+"/air/components";var c=this.items.itemAt(0).store;Ext.Ajax.request({url:TDS.env.dataPath+b,method:"GET",callback:function(l,e,g){if(e){;var f=Ext.util.JSON.decode(g.responseText);var k=f[a];if(typeof k=="undefined"){return}var j=[];for(var d=0;d<k.length;d++){f[k[d]].dataURI=k[d];j.push(f[k[d]])}var h=c;h.loadData(j)}},scope:this.ownerCt.ownerCt})}}}