{xtype:"panel",layout:Ext.isIE?"fit":"",autoScroll:true,bodyStyle:"padding: 8px;",requireStores:[{dataURI:TDS.env.dataPath+"car/types/collection",identifier:"car/types",fields:["name","dataURI"]}],items:{xtype:"awesomegrid",searchURI:TDS.env.dataPath+"search/cars",pinnable:true,enableRowExpander:true,calcualteDays:function(){var a=this.topToolbar.items.itemAt(10).getValue();var e=this.topToolbar.items.itemAt(12).getValue();var d=this.topToolBar2.items.itemAt(8).getValue();var c=this.topToolBar2.items.itemAt(10).getValue();e?e:0;var b=0;if(a&&d){if(a==d){b=1}else{if(a<d){b=(d-a)/86400000;if(e<c){b+=1}else{b+=0}}}}this.topToolBar2.items.itemAt(13).setValue(b)},tbar:["PickUp Country/City:","","",{xtype:"combo",name:"countryDepotURI1",emptyText:"Type a country...",excludeFromSession:true,tpl:TDS.util.Templates.ComboNoLabel,minChars:1,enableKeyEvents:true,mode:"local",width:120,typeAhead:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"name",valueField:"dataURI",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["dataURI","name","isoCode"]}),appendData:[{name:"",dataURI:""}],listeners:{select:function(){this.ownerCt.ownerCt.topToolBar2.items.itemAt(1).setValue(this.getValue())}}}," ",{xtype:"locationcombo",name:"locationDepotURI1",excludeFromSession:true,hideTrigger:false,listeners:{beforesearch:function(d){var c=this.ownerCt;var b=c.items.itemAt(3);var a=b.getValue().substring(b.getValue().lastIndexOf("/")+1);if(a==""){b.markInvalid("Please select a country.");return false}d.searchURI=TDS.env.dataPath+"country/"+a+"/locations/collection";d.searchIdentifier="country/"+a+"/locations"},select:function(){this.ownerCt.ownerCt.topToolBar2.items.itemAt(3).setValue(this.getValue())}}}," ","Location:",{xtype:"combo",name:"fromplaceURI",forceSubmit:true,excludeFromSession:true,hideTrigger:false,mode:"local",width:110,triggerAction:"all",editable:false,displayField:"value",valueField:"value",store:TDS.data.carPlace,listeners:{beforesearch:function(a){}}}," ",{xtype:"datefield",name:"datePointer",showToday:false,width:80,format:"dMy",value:new Date(),minValue:Ext.TimerMgr.getServerCalculatedDate().clearTime(),listeners:{extraselect:function(){this.ownerCt.ownerCt.calcualteDays();var a=this.getValue();a.setDate(a.getDate()+1);this.ownerCt.ownerCt.topToolBar2.items.itemAt(8).setMinValue(a)}}}," ",{xtype:"combo",name:"pickUpTime",mode:"local",width:60,triggerAction:"all",editable:false,displayField:"numeric",valueField:"numeric",emptyText:"Time",store:TDS.data.time,listeners:{select:function(){this.ownerCt.ownerCt.calcualteDays()}}},"->",{text:"Help",xtype:"redbutton",cls:"x-button-blue",overCls:"x-button-blue-over",opened:false,toggle:false,handler:function(){TDS.needHelp("Search View Help","23");if(!this.opened){this.opened=true;TDS.needHelp("Search View Help","23")}else{this.opened=false;TDS.helpwindow.hide()}}}],tbar2:["DropOff Country/City:",{xtype:"combo",name:"countryArrivalURI",emptyText:"Type a country...",excludeFromSession:true,minChars:1,enableKeyEvents:true,mode:"local",width:120,typeAhead:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"name",valueField:"dataURI",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["dataURI","name","isoCode"]}),appendData:[{name:"",dataURI:""}]}," ",{xtype:"locationcombo",name:"locationArrivalURI",excludeFromSession:true,hideTrigger:false,listeners:{beforesearch:function(d){var c=this.ownerCt;var b=c.items.itemAt(1);var a=b.getValue().substring(b.getValue().lastIndexOf("/")+1);if(a==""){b.markInvalid("Please select a country.");return false}d.searchURI=TDS.env.dataPath+"country/"+a+"/locations/collection";d.searchIdentifier="country/"+a+"/locations"}}}," ","Location:",{xtype:"combo",name:"toplaceURI",forceSubmit:true,excludeFromSession:true,hideTrigger:false,mode:"local",width:110,triggerAction:"all",editable:false,displayField:"value",valueField:"value",store:TDS.data.carPlace,listeners:{beforesearch:function(a){}}}," ",{xtype:"datefield",name:"dropOffDate",emptyText:"Date",excludeFromSession:true,enableKeyEvents:true,showToday:false,width:80,format:"dMy",listeners:{extraselect:function(){this.ownerCt.ownerCt.calcualteDays()}}}," ",{xtype:"combo",name:"dropOffTime",mode:"local",width:60,triggerAction:"all",editable:false,displayField:"numeric",valueField:"numeric",emptyText:"Time",store:TDS.data.time,listeners:{select:function(){this.ownerCt.ownerCt.calcualteDays()}}}," ","Days:",{xtype:"numberfield",width:60,enableKeyEvents:true,name:"days"}],tbar3:["Type:",{xtype:"combo",name:"carTypeURI",mode:"local",width:120,tpl:TDS.util.Templates.ComboNoLabel,triggerAction:"all",editable:false,displayField:"name",valueField:"dataURI",emptyText:"Vehicle type",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"car/types/collection",identifier:"car/types",fields:["name","dataURI"]})}," ","Vehicle Size:",{xtype:"combo",name:"carVehicleSizeURI",mode:"local",width:120,tpl:TDS.util.Templates.ComboNoLabel,triggerAction:"all",editable:false,excludeFromSession:true,displayField:"name",valueField:"dataURI",emptyText:"Vehicle Size",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"car/vehicleSizes/collection",identifier:"car/vehicleSizes",fields:["name","dataURI"]})}," ","No. of seats:",{xtype:"omnicrementer",name:"capacityPeople"}," ","Auto Transmission:",{xtype:"checkbox",name:"automaticTransmission"}," "," ","Unlimited Kilometers:",{xtype:"checkbox",name:"unlimitedKilometers"}," "," ","Age:",{xtype:"omnicrementer",value:0,enableKeyEvents:true,name:"minimumAgeRequired"}],store:new Ext.data.JsonStore({url:"",id:"dataURI",fields:["pinned","dataURI","supplierURI","nameString","automaticTransmission","capacityPeople","minimumAgeRequired","codeSupplier","carTypeURI","conversionCurrency","convertedPricingPriceSell","termsAndConditions","noPrePaymentRequired","pytInFull","fullPytPriorDays","depositWithin","balancePriorToDeparture","depositWithinDays","depositPerOption","balancePriorToDepartureDay","graphicImgPath","carVehicleSizeURI","supplierDetails","pricingPriceIsNett"]}),sm:new Ext.grid.RowSelectionModel(),cm:new Ext.grid.ColumnModel([{header:"Supplier",dataIndex:"supplierURI",sortable:true,renderer:function(e,d,a,f,c,b){d.attr='ext:qtip="'+a.get("supplierDetails").replace(/\"/g,"'")+'"';return TDS.util.Format.displayResourceConciseName(e)}},{header:"Vehicle",dataIndex:"nameString",sortable:true},{header:"Vehicle code",dataIndex:"codeSupplier",sortable:true,menuDisabled:true,width:100,fixed:true},{header:"Vehicle type",dataIndex:"carTypeURI",sortable:true,renderer:TDS.util.Format.displayResourceNameRenderer()},{header:"Transmission",width:100,fixed:true,dataIndex:"automaticTransmission",renderer:function(a){if(a){return"Automatic"}return"Manual"}},{header:"No. of seats",width:80,fixed:true,dataIndex:"capacityPeople"},{header:"Minimum age",width:80,fixed:true,dataIndex:"minimumAgeRequired"},{header:"Daily rate",dataIndex:"convertedPricingPriceSell",width:120,fixed:true,sortable:true,renderer:function(c,b,a){return TDS.util.Price.formatPrice(c,a.data.conversionCurrency)+" ("+(a.data.pricingPriceIsNett?"Nett":"Gross")+")"}}]),sm:new Ext.grid.RowSelectionModel(),viewConfig:{forceFit:true},getRowInterface:function(a,c,b){return"pnr/offerings/car/layout.js"},listeners:{sessioninit:function(){var a=this.ownerCt.findParentByType("pnrpanel");this.appendQueryParams.currency=a.getPNRCurrency()}}}}