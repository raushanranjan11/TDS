{xtype:"panel",layout:Ext.isIE?"fit":"",autoScroll:true,bodyStyle:"padding: 8px;",requireStores:[{dataURI:TDS.env.dataPath+"sightseeing/types/collection",identifier:"sightseeing/types",fields:["name","dataURI"]},{dataURI:TDS.env.dataPath+"rate/classes/collection",identifier:"rate/classes",fields:["name","dataURI"]},{dataURI:TDS.env.dataPath+"rate/pers/collection",identifier:"rate/pers",fields:["name","dataURI"]},{dataURI:TDS.env.dataPath+"rate/occupancies/collection",identifier:"rate/occupancies",fields:["name","dataURI"]}],items:{xtype:"awesomesearchgrid",searchOfferingType:TDS.data.componentType.TYPE_SIGHTSEEING.toUpperCase(),enableRowExpander:true,pinnable:true,tbar:["Available"," ",{xtype:"datefield",name:"datePointer",excludeFromSession:true,value:TDS.env.defaultDateSearchGrid,enableKeyEvents:true,showToday:false,width:80,format:"dMy",minValue:Ext.TimerMgr.getServerCalculatedDate().clearTime()},"&plusmn;",{xtype:"omnicrementer",name:"dateDays",width:60,editable:false}," ","days"," ","-"," ","Adults:",{xtype:"omnicrementer",name:"noOfAdult",enableKeyEvents:true,width:60,listeners:{trigger:function(d,c){var b=d.ownerCt.items.itemAt(14).getValue()+d.ownerCt.items.itemAt(17).getValue()+d.getValue();d.ownerCt.items.itemAt(20).setValue(b)}}}," ","Child:",{xtype:"omnicrementer",name:"noOfChild",width:60,listeners:{trigger:function(d,c){var b=d.ownerCt.items.itemAt(11).getValue()+d.ownerCt.items.itemAt(17).getValue()+d.getValue();d.ownerCt.items.itemAt(20).setValue(b)}}}," ","Infants:",{xtype:"omnicrementer",name:"noOfInfant",width:60,listeners:{trigger:function(d,c){var b=d.ownerCt.items.itemAt(11).getValue()+d.ownerCt.items.itemAt(14).getValue()+d.getValue();d.ownerCt.items.itemAt(20).setValue(b)}}}," ","Total PAX:",{xtype:"textfield",name:"totalPax",id:"maximumOccupancyId",value:0,width:60,readOnly:true}," ","-"," ",{xtype:"combo",name:"ownContent",mode:"local",width:110,triggerAction:"all",editable:false,excludeFromSession:true,hidden:true,displayField:"description",valueField:"value",emptyText:"content type",value:false,store:TDS.data.countentType,listeners:{render:function(){if(TDS.env.user.isArenaOne()){this.show()}}}},"->",{text:"Help",xtype:"redbutton",cls:"x-button-blue",overCls:"x-button-blue-over",opened:false,toggle:false,handler:function(){TDS.needHelp("Search View Help","23");if(!this.opened){this.opened=true;TDS.needHelp("Search View Help","23")}else{this.opened=false;TDS.helpwindow.hide()}}}],tbar2:["Tour Name:",{xtype:"textfield",name:"nameLike",enableKeyEvents:true,width:160}," ","ARENA Code:",{xtype:"textfield",name:"codeLike",enableKeyEvents:true,width:80}," ","Type:",{xtype:"combo",name:"sightseeingTypeURI",mode:"local",tpl:TDS.util.Templates.ComboNoLabel,width:220,triggerAction:"all",editable:false,displayField:"name",valueField:"dataURI",emptyText:"Type",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"sightseeing/types/collection",identifier:"sightseeing/types",fields:["name","dataURI"]}),appendData:[{name:"",dataURI:""}]}],tbar3:["Location:",{xtype:"combo",name:"countryToURI",emptyText:"Type a country...",excludeFromSession:true,tpl:TDS.util.Templates.ComboNoLabel,minChars:1,enableKeyEvents:true,mode:"local",width:120,typeAhead:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"name",valueField:"dataURI",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["dataURI","name","isoCode"]}),appendData:[{name:"",dataURI:""}]}," ",{xtype:"locationcombo",name:"locationToURI",excludeFromSession:true,hideTrigger:false,listeners:{beforesearch:function(d){var c=this.ownerCt;var b=c.items.itemAt(1);var a=b.getValue().substring(b.getValue().lastIndexOf("/")+1);if(a==""){b.markInvalid("Please select a country.");return false}d.searchURI=TDS.env.dataPath+"country/"+a+"/locations/collection";d.searchIdentifier="country/"+a+"/locations"}}}],store:new Ext.data.JsonStore({url:"",id:"dataURI",fields:["dataURI","pinned","nameString","supplierURI","code","locationToString","locationsString","conversionCurrency","convertedPricingPriceSell","descriptionString","primaryHref","addressString","locationPickup","locationDropoff","departureTime","duration","sightseeingTypeURI","termsAndConditions","noPrePaymentRequired","pytInFull","fullPytPriorDays","depositWithin","balancePriorToDeparture","depositWithinDays","depositPerOption","balancePriorToDepartureDay","graphicImgPath","supplierDetails","pricingPriceIsNett"]}),sm:new Ext.grid.RowSelectionModel(),cm:new Ext.grid.ColumnModel([{header:"Supplier",dataIndex:"supplierURI",sortable:true,renderer:function(e,d,a,f,c,b){d.attr='ext:qtip="'+a.get("supplierDetails").replace(/\"/g,"'")+'"';return TDS.util.Format.displayResourceConciseName(e)}},{header:"Name",dataIndex:"nameString",sortable:true},{header:"ARENA Code",dataIndex:"code",width:80,fixed:true,sortable:true},{header:"Location",dataIndex:"locationToString",sortable:true},{header:"Pickup",dataIndex:"locationPickup",sortable:true},{header:"Drop-off",dataIndex:"locationDropoff",sortable:true},{header:"Departs",dataIndex:"departureTime",sortable:true},{header:"Trip time",dataIndex:"duration",sortable:true},{header:"Advertised rate",dataIndex:"convertedPricingPriceSell",width:120,fixed:true,sortable:true,renderer:function(c,b,a){return TDS.util.Price.formatPrice(c,a.data.conversionCurrency)+" ("+(a.data.pricingPriceIsNett?"Nett":"Gross")+")"}}]),viewConfig:{forceFit:true},getRowInterface:function(a,c,b){return"pnr/offerings/sightseeing/layout.js"},listeners:{sessioninit:function(){var a=this.ownerCt.findParentByType("pnrpanel");var b=this.getTopToolbar().items.itemAt(11);b.setValue(a.getPassengerCount());this.appendQueryParams.currency=a.getPNRCurrency()}}}}