{xtype:"panel",layout:Ext.isIE?"fit":"",autoScroll:true,bodyStyle:"padding: 8px;",requireStores:[{dataURI:TDS.env.dataPath+"tour/types/collection",identifier:"tour/types",fields:["name","dataURI"]},{dataURI:TDS.env.dataPath+"tour/classes/collection",identifier:"tour/classes",fields:["name","dataURI"]},{dataURI:TDS.env.dataPath+"rate/classes/collection",identifier:"rate/classes",fields:["name","dataURI"]},{dataURI:TDS.env.dataPath+"rate/pers/collection",identifier:"rate/pers",fields:["name","dataURI"]},{dataURI:TDS.env.dataPath+"rate/occupancies/collection",identifier:"rate/occupancies",fields:["name","dataURI"]}],items:{xtype:"awesomegrid",searchURI:TDS.env.dataPath+"search/tours",enableRowExpander:true,pinnable:true,allowPagination:true,tbar:["Available"," ",{xtype:"datefield",name:"datePointer",excludeFromSession:true,value:TDS.env.defaultDateSearchGrid,enableKeyEvents:true,id:"datePointerId",showToday:true,width:80,format:"dMy",minValue:Ext.TimerMgr.getServerCalculatedDate().clearTime()},"&plusmn;",{xtype:"omnicrementer",name:"dateDays",width:60,editable:false}," ","days"," ","-"," ","Adults:",{xtype:"omnicrementer",name:"noOfAdult",enableKeyEvents:true,width:60,listeners:{trigger:function(d,c){var b=d.ownerCt.items.itemAt(14).getValue()+d.ownerCt.items.itemAt(17).getValue()+d.getValue();d.ownerCt.items.itemAt(20).setValue(b)}}}," ","Child:",{xtype:"omnicrementer",name:"noOfChild",width:60,listeners:{trigger:function(d,c){var b=d.ownerCt.items.itemAt(11).getValue()+d.ownerCt.items.itemAt(17).getValue()+d.getValue();d.ownerCt.items.itemAt(20).setValue(b)}}}," ","Infants:",{xtype:"omnicrementer",name:"noOfInfant",width:60,listeners:{trigger:function(d,c){var b=d.ownerCt.items.itemAt(11).getValue()+d.ownerCt.items.itemAt(14).getValue()+d.getValue();d.ownerCt.items.itemAt(20).setValue(b)}}}," ","Total PAX:",{xtype:"textfield",name:"totalPax",id:"maximumOccupancyId",value:0,width:60,readOnly:true}," "," ","-"," ",{xtype:"combo",name:"ownContent",mode:"local",width:110,triggerAction:"all",editable:false,excludeFromSession:true,hidden:true,displayField:"description",valueField:"value",emptyText:"content type",value:false,store:TDS.data.countentType,listeners:{render:function(){if(TDS.env.user.isArenaOne()){this.show()}}}},"->",{xtype:"redbutton",text:"Showing 0 to 25",cls:"x-button-green",overCls:"x-button-green-over"},"-",{xtype:"redbutton",text:"Next 25",cls:"x-button-blue-tour",overCls:"x-button-blue-over-tour",handler:function(){var a=this.ownerCt.ownerCt;a.next25();this.ownerCt.items.itemAt(18).td.innerHTML="Showing "+a.startLimit+" to "+(a.startLimit+25)}},"-",{xtype:"redbutton",text:"Previous 25",cls:"x-button-orange",overCls:"x-button-orange-over",handler:function(){var a=this.ownerCt.ownerCt;a.previous25();if(a.startLimit>=0){this.ownerCt.items.itemAt(18).td.innerHTML="Showing "+a.startLimit+" to "+(a.startLimit+25)}}}," ",{text:"Help",xtype:"redbutton",cls:"x-button-blue",overCls:"x-button-blue-over",opened:false,toggle:false,handler:function(){TDS.needHelp("Search View Help","23");if(!this.opened){this.opened=true;TDS.needHelp("Search View Help","23")}else{this.opened=false;TDS.helpwindow.hide()}}}],tbar2:["Tour Name:",{xtype:"textfield",name:"nameLike",enableKeyEvents:true,width:160}," ","ARENA Code:",{xtype:"textfield",name:"codeLike",enableKeyEvents:true,width:80}," ","Type:",{xtype:"combo",name:"tourTypeURI",id:"ID_OF_tourTypeURI",mode:"local",width:220,tpl:TDS.util.Templates.ComboNoLabel,triggerAction:"all",editable:false,displayField:"name",valueField:"dataURI",emptyText:"Type",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"tour/types/collection",identifier:"tour/types",fields:["name","dataURI"]}),appendData:[{name:"",dataURI:""}]}],tbar3:["From: ",{xtype:"combo",name:"countryFromURI",emptyText:"Type a country...",excludeFromSession:true,tpl:TDS.util.Templates.ComboNoLabel,minChars:1,enableKeyEvents:true,mode:"local",width:120,typeAhead:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"name",valueField:"dataURI",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["dataURI","name","isoCode"]}),appendData:[{name:"",dataURI:""}]}," ",{xtype:"locationcombo",name:"locationFromURI",excludeFromSession:true,hideTrigger:false,listeners:{beforesearch:function(d){var c=this.ownerCt;var b=c.items.itemAt(1);var a=b.getValue().substring(b.getValue().lastIndexOf("/")+1);if(a==""){b.markInvalid("Please select a country.");return false}d.searchURI=TDS.env.dataPath+"country/"+a+"/locations/collection";d.searchIdentifier="country/"+a+"/locations"}}}," ",{xtype:"button",icon:"images/arrow-black.gif",cls:"x-btn-icon",hidden:true,tooltip:"Click here to swap the from and to locations",handler:function(){var c=this.ownerCt;var h=c.items.itemAt(1);var a=c.items.itemAt(3);var d=c.items.itemAt(8);var f=c.items.itemAt(10);var i=h.getValue();var b=a.getValue();var e=d.getValue();var g=f.getValue();h.setValue(e);a.setValue(g);d.setValue(i);f.setValue(b)}}," ","To:",{xtype:"combo",name:"countryToURI",emptyText:"Type a country...",excludeFromSession:true,tpl:TDS.util.Templates.ComboNoLabel,minChars:1,enableKeyEvents:true,mode:"local",width:120,typeAhead:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"name",valueField:"dataURI",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["dataURI","name","isoCode"]}),appendData:[{name:"",dataURI:""}]}," ",{xtype:"locationcombo",name:"locationToURI",excludeFromSession:true,hideTrigger:false,listeners:{beforesearch:function(d){var c=this.ownerCt;var b=c.items.itemAt(8);var a=b.getValue().substring(b.getValue().lastIndexOf("/")+1);if(a==""){b.markInvalid("Please select a country.");return false}d.searchURI=TDS.env.dataPath+"country/"+a+"/locations/collection";d.searchIdentifier="country/"+a+"/locations"}}}," ","-"," "],store:new Ext.data.JsonStore({url:"",id:"dataURI",fields:["dataURI","pinned","nameString","supplierURI","code","locationFromString","locationToString","locationsString","conversionCurrency","convertedPricingPriceSell","descriptionString","primaryHref","addressString","tourClassURI","tourTypeURI","termsAndConditions","noPrePaymentRequired","pytInFull","fullPytPriorDays","depositWithin","balancePriorToDeparture","depositWithinDays","depositPerOption","balancePriorToDepartureDay","graphicImgPath","supplierDetails","tourTypesString","duration","pricingPriceIsNett"]}),sm:new Ext.grid.RowSelectionModel(),cm:new Ext.grid.ColumnModel([{header:"Supplier",dataIndex:"supplierURI",sortable:true,renderer:function(e,d,a,f,c,b){d.attr='ext:qtip="'+a.get("supplierDetails").replace(/\"/g,"'")+'" ext:qwidth="320"';return TDS.util.Format.displayResourceConciseName(e)}},{header:"Name",dataIndex:"nameString",sortable:true},{header:"ARENA Code",dataIndex:"code",width:80,fixed:true,sortable:true},{header:"From",dataIndex:"locationFromString",sortable:true},{header:"To",dataIndex:"locationToString",sortable:true},{header:"Duration",dataIndex:"duration",sortable:true,width:80,fixed:true},{header:"Advertised rate",dataIndex:"convertedPricingPriceSell",width:120,fixed:true,sortable:true,renderer:function(c,b,a){return TDS.util.Price.formatPrice(c,a.data.conversionCurrency)+" ("+(a.data.pricingPriceIsNett?"Nett":"Gross")+")"}}]),viewConfig:{forceFit:true},getRowInterface:function(a,c,b){return"pnr/offerings/tour/layout.js"},listeners:{sessioninit:function(){var a=this.ownerCt.findParentByType("pnrpanel");var b=this.topToolbar.items.itemAt(2);var c=this.getTopToolbar().items.itemAt(11);c.setValue(a.getPassengerCount());this.appendQueryParams.currency=a.getPNRCurrency()}}}}