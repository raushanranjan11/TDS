{xtype:"panel",layout:Ext.isIE?"fit":"",autoScroll:true,bodyStyle:"padding: 8px;",items:{xtype:"awesomegrid",searchURI:TDS.env.dataPath+"search/rails",pinnable:true,enableRowExpander:true,tbar:["Available"," ",{xtype:"datefield",name:"datePointer",excludeFromSession:true,value:new Date(),enableKeyEvents:true,showToday:false,width:80,format:"dMy",minValue:Ext.TimerMgr.getServerCalculatedDate().clearTime()},"&plusmn;",{xtype:"omnicrementer",name:"dateDays",width:60,editable:false}," ","days"," ","-"," ","Adults:",{xtype:"omnicrementer",name:"noOfAdult",enableKeyEvents:true,width:60,listeners:{trigger:function(d,c){var b=d.ownerCt.items.itemAt(14).getValue()+d.ownerCt.items.itemAt(17).getValue()+d.getValue();d.ownerCt.items.itemAt(20).setValue(b)}}}," ","Child:",{xtype:"omnicrementer",name:"noOfChild",width:60,listeners:{trigger:function(d,c){var b=d.ownerCt.items.itemAt(11).getValue()+d.ownerCt.items.itemAt(17).getValue()+d.getValue();d.ownerCt.items.itemAt(20).setValue(b)}}}," ","Infants:",{xtype:"omnicrementer",name:"noOfInfant",width:60,listeners:{trigger:function(d,c){var b=d.ownerCt.items.itemAt(11).getValue()+d.ownerCt.items.itemAt(14).getValue()+d.getValue();d.ownerCt.items.itemAt(20).setValue(b)}}}," ","Total PAX:",{xtype:"textfield",name:"totalPax",id:"maximumOccupancyId",value:0,width:60,readOnly:true},"->",{text:"Help",xtype:"redbutton",cls:"x-button-blue",overCls:"x-button-blue-over",opened:false,toggle:false,handler:function(){TDS.needHelp("Search View Help","23");if(!this.opened){this.opened=true;TDS.needHelp("Search View Help","23")}else{this.opened=false;TDS.helpwindow.hide()}}}],tbar2:["Service:",{xtype:"textfield",name:"nameLike",enableKeyEvents:true,width:120}," ","From: ",{xtype:"combo",name:"countryFromURI",emptyText:"Type a country...",tpl:TDS.util.Templates.ComboNoLabel,excludeFromSession:true,minChars:1,enableKeyEvents:true,mode:"local",width:120,typeAhead:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"name",valueField:"dataURI",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["dataURI","name","isoCode"]}),appendData:[{name:"",dataURI:""}]}," ",{xtype:"locationcombo",name:"locationFromURI",excludeFromSession:true,hideTrigger:false,listeners:{beforesearch:function(d){var c=this.ownerCt;var b=c.items.itemAt(4);var a=b.getValue().substring(b.getValue().lastIndexOf("/")+1);if(a==""){b.markInvalid("Please select a country.");return false}d.searchURI=TDS.env.dataPath+"country/"+a+"/locations/collection";d.searchIdentifier="country/"+a+"/locations"}}}," ",{xtype:"button",icon:"images/arrow-black.gif",cls:"x-btn-icon",tooltip:"Click here to swap the departure and arrival locations",handler:function(){var c=this.ownerCt;var h=c.items.itemAt(4);var a=c.items.itemAt(6);var d=c.items.itemAt(11);var f=c.items.itemAt(13);var i=h.getValue();var b=a.getValue();var e=d.getValue();var g=f.getValue();h.setValue(e);a.setValue(g);d.setValue(i);f.setValue(b)}}," ","To:",{xtype:"combo",name:"countryToURI",emptyText:"Type a country...",excludeFromSession:true,tpl:TDS.util.Templates.ComboNoLabel,minChars:1,enableKeyEvents:true,mode:"local",width:120,typeAhead:true,triggerAction:"all",forceSelection:true,selectOnFocus:true,displayField:"name",valueField:"dataURI",store:TDS.data.getStore({dataURI:TDS.env.dataPath+"countries/collection",identifier:"countries",fields:["dataURI","name","isoCode"]}),appendData:[{name:"",dataURI:""}]}," ",{xtype:"locationcombo",name:"locationToURI",excludeFromSession:true,hideTrigger:false,listeners:{beforesearch:function(d){var c=this.ownerCt;var b=c.items.itemAt(11);var a=b.getValue().substring(b.getValue().lastIndexOf("/")+1);if(a==""){b.markInvalid("Please select a country.");return false}d.searchURI=TDS.env.dataPath+"country/"+a+"/locations/collection";d.searchIdentifier="country/"+a+"/locations"}}}],tbar3:[{xtype:"hidden",name:"weeklyScheduleDaysCSV",value:"",getValue:function(){var d="";if(typeof this.ownerCt!="undefined"){var a=this.ownerCt.ownerCt;var c=[a.findField("weeklyScheduleSunday"),a.findField("weeklyScheduleMonday"),a.findField("weeklyScheduleTuesday"),a.findField("weeklyScheduleWednesday"),a.findField("weeklyScheduleThursday"),a.findField("weeklyScheduleFriday"),a.findField("weeklyScheduleSaturday")];for(var b=0;b<c.length;b++){if(c[b].checked){d+=c[b].value+","}}if(d.substr(-1)==","){d=d.substring(0,d.length-1)}}return d}},"Schedule:"," ",{xtype:"checkbox",name:"weeklyScheduleSunday",value:1,excludeSubmit:true},"Sun"," ",{xtype:"checkbox",name:"weeklyScheduleMonday",value:2,excludeSubmit:true},"Mon"," ",{xtype:"checkbox",name:"weeklyScheduleTuesday",value:3,excludeSubmit:true},"Tue"," ",{xtype:"checkbox",name:"weeklyScheduleWednesday",value:4,excludeSubmit:true},"Wed"," ",{xtype:"checkbox",name:"weeklyScheduleThursday",value:5,excludeSubmit:true},"Thu"," ",{xtype:"checkbox",name:"weeklyScheduleFriday",value:6,excludeSubmit:true},"Fri"," ",{xtype:"checkbox",name:"weeklyScheduleSaturday",value:7,excludeSubmit:true},"Sat"," ","Class:",{xtype:"combo",name:"rateClassURI",mode:"local",width:110,triggerAction:"all",editable:false,displayField:"name",valueField:"dataURI",store:new Ext.data.Store()}],store:new Ext.data.JsonStore({url:"",id:"dataURI",fields:["pinned","dataURI","supplierURI","nameString","codeSupplier","locationFromString","locationToString","stopOversString","departureTime","arrivalTime","duration","stopOvers","termsAndConditions","noPrePaymentRequired","pytInFull","fullPytPriorDays","depositWithin","balancePriorToDeparture","depositWithinDays","depositPerOption","balancePriorToDepartureDay","graphicImgPath"]}),sm:new Ext.grid.RowSelectionModel(),cm:new Ext.grid.ColumnModel([{header:"Service",dataIndex:"nameString",sortable:true},{header:"Service No.",dataIndex:"codeSupplier",sortable:true},{header:"From",dataIndex:"locationFromString",sortable:true},{header:"To",dataIndex:"locationToString",sortable:true},{header:"Departs",dataIndex:"departureTime",sortable:true},{header:"Arrives",dataIndex:"arrivalTime",sortable:true},{header:"Trip time",dataIndex:"duration",sortable:true},{header:"Stops",dataIndex:"stopOvers",sortable:true}]),viewConfig:{forceFit:true},getRowInterface:function(a,c,b){return"pnr/offerings/rail/layout.js"},listeners:{sessioninit:function(){var a=this.ownerCt.findParentByType("pnrpanel");var b=this.getTopToolbar().items.itemAt(11);b.setValue(a.getPassengerCount());this.appendQueryParams.currency=a.getPNRCurrency()}}}}