{xtype:"form",border:false,width:500,trackResetOnLoad:true,beforeSubmit:function(d){var e=this.findParentByType("awesomewindow");var f=e.aw.data;d.credit=false;d.paymentOnly=true;d.componentArray=f.componentArray;d.amount=parseFloat(d.amount);return d},beforeDataLoad:function(b){return b},items:{xtype:"tabpanel",border:false,defaults:{border:false},activeTab:0,layoutOnTabChange:true,height:425,items:[{title:"Details",items:[{xtype:"panel",style:"padding-right: 5px;padding-left: 5px; margin-bottom: 4px; padding-top: 5px;",items:{xtype:"panel",layout:"form",labelWidth:100,border:false,style:"padding: 5px; ",defaultType:"textfield",items:[{xtype:"panel",style:"padding: 0; margin-bottom: 4px; padding-top: 5px;",border:false,layout:"table",layoutConfig:{columns:4},defaults:{border:false},items:[{html:"Supplier:",width:Ext.isIE?108:105},{xtype:"fieldlabel",name:"supplierName",width:150,readOnly:true}]},{xtype:"panel",style:"padding: 0; margin-bottom: 4px; padding-top: 5px;",border:false,layout:"table",layoutConfig:{columns:7},defaults:{border:false},items:[{html:"Transaction:",width:Ext.isIE?108:105},{xtype:"combo",name:"paymentType",width:120,editable:false,forceSelection:true,mode:"local",triggerAction:"all",displayField:"name",valueField:"dataURI",readOnly:true,store:["Deposit Payment","Full Payment","Balance of Payment","Part Payment"],listeners:{render:function(){var b=this;setTimeout(function(){b.setValue("Payment")},100)}}},{bodyStyle:"padding: 0 4px;"},{html:"Method:"},{xtype:"combo",name:"passengerNameRecordTransactionMethodURI",hidden:false,mode:"local",width:100,triggerAction:"all",editable:false,displayField:"name",valueField:"dataURI",listeners:{beforerender:function(){var b=this.ownerCt.findParentByType("awesomewindow");this.store=new Ext.data.CollectionStore({autoLoad:true,identifier:"pnr/transactionMethods",url:TDS.env.dataPath+"pnr/transactionMethods/collection",fields:["dataURI","code","type","name","description","amount","credit"]})},select:function(){var n=this.findParentByType("awesomewindow");var l=this.ownerCt.ownerCt.ownerCt.ownerCt.ownerCt.ownerCt.getForm();var o="";var k=(n.aw.data.dataURI).split("/")[0];var m=(n.aw.data.dataURI).split("/")[1];var j=this.getRawValue();if(j=="BPAY"){Ext.Ajax.request({url:TDS.env.dataPath+"pnr/"+m,success:function(c,b){var a=Ext.decode(c.responseText);o=a.numericCode;l.findField("numericCode").setValue(o)}});this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(0).setVisible(true);this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(1).setVisible(false);this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(3).setVisible(false);this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(2).setVisible(false)}if(j=="BITCOIN"){var n=this.findParentByType("awesomewindow");var i="";var l=this.ownerCt.ownerCt.ownerCt.ownerCt.ownerCt.ownerCt.getForm();var j=this.getRawValue();Ext.Ajax.request({url:TDS.env.dataPath+n.aw.data.supplierURI+"/bitcoin",success:function(c,b){var a=Ext.decode(c.responseText);i=a.financialBitcoinAddress}});this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(0).setVisible(false);this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(1).setVisible(true);this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(3).setVisible(false);this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(2).setVisible(false);var h=new Date().add(Date.SECOND,600).format(TDS.env.dateFormat);this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(1).items.itemAt(3).items.itemAt(2).activate(h)}if(j=="Credit Card"){this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(3).setVisible(false);this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(2).setVisible(true);this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(1).setVisible(false);this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(0).setVisible(false)}if(j=="Account ID"){this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(3).setVisible(true);this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(2).setVisible(false);this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(1).setVisible(false);this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(0).setVisible(false)}if(j=="Ripple"){this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(2).setVisible(false);this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(1).setVisible(false);this.ownerCt.ownerCt.ownerCt.ownerCt.items.itemAt(1).items.itemAt(0).setVisible(false)}}}},{bodyStyle:"padding: 0 4px;"},{xtype:"hidden",name:"credit",value:"false"}]},{name:"description",fieldLabel:"Description",width:360},{xtype:"panel",style:"padding: 0; margin-bottom: 4px; padding-top: 5px;",border:false,layout:"table",layoutConfig:{columns:4},defaults:{border:false},items:[{html:"Amount:",width:Ext.isIE?108:105},{xtype:"textfield",name:"currency",width:50,readOnly:true},{bodyStyle:"padding: 0 4px;"},{xtype:"textfield",name:"amount",width:100}]},{xtype:"panel",border:false,layout:"table",layoutConfig:{columns:2},items:[{border:false,html:"<p>Notes:</p>"},{border:false},{xtype:"textarea",fieldLabel:"Notes",name:"notes",width:465,height:60},{border:false,width:"0px"}]}]}},{xtype:"panel",layout:"form",border:false,items:[{xtype:"panel",name:"bpay",hidden:true,border:false,layout:"table",layoutConfig:{columns:2},defaults:{border:false},items:[{columnWidth:0.2,style:" padding-left: 5px; ",html:'<img src ="images/bpay.jpg" height="145" width="100" />'},{xtype:"panel",border:true,style:"padding-right: 5px;padding-left: 5px; position:relative;bottom:5px;",items:[{xtype:"panel",style:"padding-bottom: 30px;padding-top: 5px;padding-right: 5px;padding-left: 5px;",border:false,layout:"table",layoutConfig:{columns:3},items:[{html:'<font color="blue">Biller Code:</font>',border:false},{xtype:"textfield",width:225},{border:false},{html:'<font color="blue">References:</font>',border:false},{xtype:"panel",style:"padding-bottom: 0px;padding-top: 5px;padding-right: 0px;padding-left: 0px;",border:false,layout:"table",layoutConfig:{columns:3},items:[{xtype:"numberfield"},{border:false,width:"8px"},{xtype:"textfield",width:70,name:"numericCode",readOnly:true}]},{border:false}]},{style:"position:relative;bottom: 20px ; padding-right: 5px; padding-left: 5px;",html:"<font size = 2px;>When making a BPAY payment through your bank,it is essential to include both reference number for payment identification. </font>",border:false}]}]},{xtype:"panel",name:"TEST",hidden:true,border:false,layout:"table",style:"padding-bottom: 5px;padding-top: 0px;padding-right: 20px;padding-left: 20px;",layoutConfig:{columns:2},defaults:{border:false},items:[{columnWidth:0.5,html:'<img src ="images/bitcoin.png" height="50" width="50" />',style:"padding-bottom: 8px;padding-top: 0px;padding-right:00px;padding-left: 00px;"},{html:"<u>Pay by Bitcoin<u>",style:" margin-bottom: 15px;  font-weight: bold; font-size: 200%;  ",border:false},{html:"Pay BTC:",border:false,style:"padding-bottom: 5px;padding-top: 5px;padding-right:0px;padding-left: 20px;"},{xtype:"panel",layout:"table",style:"padding-bottom: 5px;padding-top: 5px;padding-right:0px;padding-left: 0px;",layoutConfig:{columns:3},defaults:{border:false},items:[{xtype:"textfield",readOnly:true,name:"bitCoinAmount",width:150},{width:"5px"},{xtype:"timerlabel",text:"",style:"font-size: 11px;font-weight: bold;color:blue ",activate:function(b){var c=this.ownerCt.ownerCt;var a=Ext.TimerMgr.start(new Ext.Timer({useServerTime:false,expireTime:b,interval:1000}));this.setTimer(a)},listeners:{timerrefresh:function(a,b){this.setText('<b>Pay within  <font color="blue"> '+b+"</font></b>",false)}}}]},{html:"Address :",border:false,style:"padding-bottom: 8px;padding-top: 5px;padding-right:0px;padding-left: 20px;"},{xtype:"textfield",name:"address",width:275},{xtype:"button",name:"copyAddress",text:"Convert",style:"position:relative; left:  65px;  padding-bottom: 8px;padding-top: 10px;   ",listeners:{click:function(){var e=this.findParentByType("awesomewindow").initialConfig.data;var b=e.dataURI;var a=this.ownerCt.items.items[5].getValue();var d=this.ownerCt.items.items[3].items.items[0];var f=this.ownerCt.items.items[5];var c=this.ownerCt.items.items[8].el.dom;Ext.Ajax.request({url:TDS.env.dataPath+b+"/bitcoin",jsonData:{amount:e.amount},method:"POST",callback:function(j,g,i){if(g){var h=Ext.decode(i.responseText);d.setValue(h.bitCoinAmount);f.setValue(h.subBitcoinAddress);c.innerHTML='<img  src="'+h.qrImage+'"style="width: 65px; height: 65px;border: none;" id="iframe1"  ></img >'}else{}},scope:this})}}},{xtype:"button",name:"copyAddress",text:"Copy Address",style:"position:relative; left:  90px;     ",listeners:{click:function(){var a=this.ownerCt.items.items[5];this.initialConfig.value=a.getValue()}}},{xtype:"panel",columnWidth:0.5,html:" ",style:"padding-bottom: 8px;padding-top: 0px;  position:absolute; top:   0px;left:280px;"}]},{xtype:"panel",name:"credit",hidden:true,border:true,layout:"form",style:"padding-right: 5px;padding-left: 5px; margin-bottom: 4px; padding-top: 5px;",defaults:{border:false},items:[{xtype:"panel",style:"padding: 0px; margin-bottom: 4px; padding-top: 5px;",border:false,layout:"table",layoutConfig:{columns:2},defaults:{border:false},items:[{html:"Card Type:",width:Ext.isIE?108:105,style:"padding:5px;"},{xtype:"combo",name:"cardType",width:150,listWidth:167,displayField:"displayName",valueField:"otaCode",selectOnFocus:true,triggerAction:"all",enableKeyEvents:true,editable:false,typeAhead:true,store:new Ext.data.CollectionStore({url:"",fields:["otaCode","displayName"]}),listeners:{beforequery:function(qe){var dataURI=this.findParentByType("awesomewindow").getData("dataURI"),supplierURI=this.findParentByType("awesomewindow").getData("supplierURI");var store=this.getStore();with(store){proxy.conn.url=TDS.env.dataPath+supplierURI+"/creditCards/collection";reader.meta.identifier=supplierURI+"/creditCards";proxy.conn.method="GET"}}}},{html:"Name on Card:",width:Ext.isIE?108:105,style:"padding:5px;"},{xtype:"textfield",name:"cardName",width:235,style:"  margin-top: 5px;"},{html:"Card Number:",width:Ext.isIE?108:105,style:"padding:5px;"},{xtype:"textfield",name:"cardNumber",width:235,style:"  margin-top: 5px;"},{html:"Expire Date:",width:Ext.isIE?108:105,style:"padding:5px;"},{xtype:"panel",width:300,style:"padding: 0px; margin-bottom: 4px; padding-top: 5px;",border:false,layout:"table",layoutConfig:{columns:3},defaults:{border:false},items:[{xtype:"combo",width:100},{bodyStyle:"padding: 0 60px;"},{xtype:"combo",width:100}]},{html:"CCV:",width:Ext.isIE?108:105,style:"padding:10px;"},{xtype:"combo",name:"ccv",width:150}]}]},{xtype:"panel",name:"account",hidden:true,border:true,layout:"form",style:"padding-right: 5px;padding-left: 5px; margin-bottom: 4px; padding-top: 5px;",defaults:{border:false},items:[{xtype:"panel",style:"padding: 0px; margin-bottom: 4px; padding-top: 5px;",border:false,layout:"table",layoutConfig:{columns:2},defaults:{border:false,bodyStyle:"padding:10px;"},items:[{html:"Account Name:",width:Ext.isIE?108:105},{xtype:"textfield",name:"accountName",width:150},{html:"Account Number:",width:Ext.isIE?108:105},{xtype:"textfield",name:"accountNumber",width:150},{html:"Pin:",width:Ext.isIE?108:105},{xtype:"textfield",name:"pin",width:150}]}]}]}]}]}}