{xtype:"panel",border:false,bodyStyle:"padding: 8px;",items:{xtype:"dataview",style:"overflow: auto;",store:new Ext.data.SimpleStore({fields:["name","quantity","price","priceGross","priceCommission","priceIsNett","extrasId","dataURI","chkboxCount","chkrequired","priceCurrency","PINgrossAmount","markupamount","PINnettAmount","endTotalNettAmount","endTotalGrossAmount","perComm"]}),tpl:new Ext.XTemplate("<html>","<body>",'<tpl for="." >',"<tpl if=\"values.chkboxCount == '0'\">",'<form name="extraform#{dataURI}" id="extraform#{dataURI}" action="" method="post">',"</tpl>","</tpl>",'<table class="x-tds-dataview" style="width: 80%;">',"<thead>","<tr>",'<th style="padding-bottom: 2px; width: 2%;" ></th>','<th style="padding-bottom: 2px; width: 60%;" ><center>Extras</center></th>','<th style="padding-bottom: 2px; width: 10%;" ><center>Quantity</center></th>','<th style="padding-bottom: 2px; width: 10%;" ><center>%</center></th>','<th style="padding-bottom: 2px; width: 10%;" ><center>Comm</center></th>','<th style="padding-bottom: 2px; width: 10%; " ><center>Gross</center></th>',"</tr>","</thead>",'<tpl for=".">','<tr class="x-tds-dataview-item">','<td style="width: 2%;">','<input type="checkbox" name="checkField#{dataURI}" {chkrequired} id="checkField#{extrasId}#{dataURI}" value ={extrasId}>','<input type="textbox" hidden="true" name="chktext" value={extrasId}>','<input type="textbox"  hidden="true" name="dataURI" value={dataURI}></td>','<td style="width: 60%;" nowrap=nowrap>{name}</td>','<td style="width: 10%;" align="center">{quantity}</td>','<td style="width: 10%;" align="center">{perComm}%</td>','<td style="width: 10%;" align="center">{priceCommission}</td>','<td style="width: 10%;" align="center">{priceCurrency}&nbsp;{PINgrossAmount}</td>',"</tr>","</tpl>",'<tr style="height: 10%;">',"</tr>",'<tr style="height: 10%;">',"</tr>","<tr>",'<td style="width: 0%;" align="right"></td>','<td style="width: 60%;" align="right"><b>Total:</b></td>','<td style="width: 10%;"></td>','<td style="width: 5%;" align="right"></td>','<td style="width: 5%;" align="right"><b></b></td>','<td style="width: 5%;" align="right"><div id="totalExtraGross"></div></td>',"</tr>",'<tpl for="." >',"<tpl if=\"values.chkboxCount == '0'\">",'<tr class="x-tds-dataview-item">','<th colspan="8">',"Extras Per person","</th>","</tr>","</tpl>","</tpl>","</table>","</form>","</body>","</html>"),itemSelector:"tr.x-tds-dataview-item",emptyText:"No extras selected."},listeners:{render:function(){var c=this.ownerCt.findParentByType("tabpanel");var a=c.getDetail("dataURI");var b=this.items.itemAt(0).store;Ext.Ajax.request({url:TDS.env.dataPath+a+"/extras/collection",method:"GET",callback:function(t,n,p){if(n){try{var j=Ext.decode(p.responseText)}catch(E){}if(j){var h=[];var g=j[a+"/extras"];var y=0;var G=0;var D=0;var z=0;var C=0;var I="";var w="";var A=0;var v=0;for(var B=0;B<g.length;B++){y=B;var H=j[g[B]];var k=g[B].split("/");var m=k[5];var f=j[H.extraURI];A=A+H.pricingPriceSell;var u=TDS.util.Price.calculateFixedGrossNettPrice({pricingPriceCurrency:H.pricingPriceCurrency,pricingPriceSell:H.pricingPriceSell,pricingPriceCommission:H.pricingPriceCommission,pricingPriceIsNett:H.pricingPriceIsNett});var F=TDS.util.Price.calculateGrossNettPrice({homeCurrency:f.homeCurrency,pricingPriceSell:f.pricingPriceSell,markup:u.priceCommission,pricingPriceCommission:H.pricingPriceCommission,pricingPriceIsNett:f.pricingPriceIsNett},true);v=v+F.priceNett;var J=u.priceCurrency;var d=u.priceCommission;var l="enabled";if(f.required){l="disabled"}if(H.pricingPriceIsNett){D=H.pricingPriceSell;D=(D);G=H.pricingPriceSell}else{G=H.pricingPriceSell;D=H.pricingPriceSell}if(d==0){d=""}var q=Math.round(((H.pricingPriceCommission*100)/H.pricingPriceSell));z=z+G;var x=f.priceIsCredit;if(f.name=="Discount"){C=C-D}else{C=C+D}if(g.length-1==B){I=z;w=C}h[h.length]=[f.name,H.quantity,u.priceFormatted,F.priceFormatted,F.priceCommission,F.priceNett,m,a,y,l,J,D.toFixed(2),d,G.toFixed(2),I,w,q,x]}b.loadData(h)}document.getElementById("totalExtraGross").innerHTML="<b>"+J+"&nbsp;"+w.toFixed(2)+"</b>";document.getElementById("totalExtraNett").innerHTML="<b>"+J+"&nbsp;"+I.toFixed(2)+"(nett)</b>"}},scope:this})}}}