{xtype:"panel",border:false,bodyStyle:"padding: 8px;",items:{xtype:"dataview",tpl:new Ext.XTemplate('<div style="height: 140px; overflow: auto;">','<table class="tds-availability-rates" style="table-layout: fixed;" cellspacing="0" cellpadding="0" border="0">','<tpl for=".">','<tr class="tds-availability-rates-row">','<td style="width: 16px;"><div class="x-grid3-cell-inner{typeCls}" style="height: 10px;"></div></td>','<td style="width: 100px;"><div class="x-grid3-cell-inner">{activityTime}</div></td>','<td style="width: 100px;"><div class="x-grid3-cell-inner">{message}</div></td>','<td style="width: 140px;"><div class="x-grid3-cell-inner">{userFullNameString}</div></td>',"<td style=\"width: 100%;\"><div class=\"x-grid3-cell-inner\"  ondblclick=\"TDS.helpwindow.setWindow({buttonOK : false,modal : true,title: 'Queues description',data:{description:'{changeDescriptionWithHTMLTags}',pageSection:''},displayCenter:true,interfaceURI: 'help/preview.js'});\" >{changeDescription}</div></td>","</tr>","</tpl>","</table>","</div>"),autoHeight:true,singleSelect:true,itemSelector:"tr.tds-availability-rates-row",emptyText:'<p style="padding: 10px;">No messages to display.</p>',prepareData:function(b){if(b.type==TDS.data.componentActivityLogType.REQUEST_NOTE_TO_AGENT||b.type==TDS.data.componentActivityLogType.BOOKING_NOTE_TO_AGENT||b.type==TDS.data.componentActivityLogType.CANCELLATION_NOTE_TO_AGENT){if(TDS.env.user.isAgencyUser()){b.typeCls=" x-tds-cell-note-recv"}else{if(TDS.env.user.isSupplier()){b.typeCls=" x-tds-cell-note-sent"}}}else{if(b.type==TDS.data.componentActivityLogType.REQUEST_NOTE_TO_SUPPLIER||b.type==TDS.data.componentActivityLogType.BOOKING_NOTE_TO_SUPPLIER||b.type==TDS.data.componentActivityLogType.CANCELLATION_NOTE_TO_SUPPLIER){if(TDS.env.user.isAgencyUser()){b.typeCls=" x-tds-cell-note-sent"}else{if(TDS.env.user.isSupplier()){b.typeCls=" x-tds-cell-note-recv"}}}else{if(b.type==TDS.data.componentActivityLogType.REQUEST_NOTE||b.type==TDS.data.componentActivityLogType.BOOKING_NOTE||b.type==TDS.data.componentActivityLogType.CANCELLATION_NOTE){b.typeCls=" x-tds-cell-note"}else{b.typeCls=" x-tds-cell-info"}}}var d=b.messageForAgency;var c="";if(TDS.env.user.isAgencyUser()){if(!d){c="Sent"}else{c="Received"}}else{if(d){c="Sent"}else{c="Received"}}b.message=c;b.activityTime=TDS.util.Format.dateSpecial(b.activityTime,TDS.env.dateTimeFormatDisplay);b.changeDescriptionWithHTMLTags=b.changeDescription;b.changeDescription=Ext.util.Format.stripTags(b.changeDescription);return b},listeners:{beforerender:function(){var c=this.ownerCt.findParentByType("tabpanel");var d=c.getDetail("dataURI");this.store=new Ext.data.CollectionStore({autoLoad:true,url:TDS.env.dataPath+d+"/messages/collection",identifier:d+"/messages",fields:["dataURI","activityTime","type","changeDescription","offeringNameString","passengerNameRecordComponentURI","passengerNameRecordURI","statusBefore","statusAfter"]})}}}}