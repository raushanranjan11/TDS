{xtype:"panel",height:250,border:false,frame:false,osiDataURI:"",osiCollectionIdentifier:"",items:[{xtype:"grid",width:1200,height:90,style:" margin-bottom: 5px;",border:true,enableColumnHide:false,enableColumnMove:false,enableColumnResize:false,enableHdMenu:false,viewConfig:{forceFit:true},sm:new Ext.grid.CheckboxSelectionModel(),store:new Ext.data.JsonStore({fields:["createdDate","text","flightName"]}),columns:[new Ext.grid.CheckboxSelectionModel(),{header:"Date",dataIndex:"createdDate",width:100,renderer:TDS.util.Format.dateSpecialRenderer(TDS.env.dateFormatDisplay)},{header:"Flight No",dataIndex:"flightName",width:50},{header:"Other Service Information(max 99 character)",dataIndex:"text",width:800}],listeners:{beforerender:function(){var a=this.ownerCt.ownerCt.ownerCt.ownerCt.osiStore;this.store=a}}},{xtype:"panel",height:120,border:false,deleteOSI:function(){this.ownerCt.items.itemAt(1).items.itemAt(2).items.itemAt(0).el.dom.innerHTML="";var f=this.ownerCt.items.itemAt(0).getSelections();if(f.length>0){var e=[];for(var d=0;d<f.length;d++){var b=f[d].data.dataURI;e[d]=b.substring(b.lastIndexOf("/")+1,b.length)}this.ownerCt.ownerCt.el.mask("","x-mask-loading");var c={selectedOSIs:e};var g=TDS.env.dataPath+this.ownerCt.osiDataURI+"/OSI/delete/air";Ext.Ajax.request({url:g,method:"POST",jsonData:c,callback:this.submitAirOSIResponse,scope:this})}else{Ext.Msg.alert("Alert","Select OSI to proceed.")}},sendOSI:function(){this.ownerCt.items.itemAt(1).items.itemAt(2).items.itemAt(0).el.dom.innerHTML="";var b=this.items.itemAt(0).getValue();this.ownerCt.ownerCt.el.mask("","x-mask-loading");var c=this.items.itemAt(1).items.itemAt(1).getValue();if(c==null||c==""){Ext.Msg.alert("Alert","Select Flight to proceed.");this.ownerCt.ownerCt.el.unmask()}else{var a={submitDataAsParams:true,selectedComponent:c,osiText:b};var d=TDS.env.dataPath+this.ownerCt.osiDataURI+"/OSI/add/air";Ext.Ajax.request({url:d,method:"POST",jsonData:a,callback:this.submitAirOSIResponse,scope:this})}},submitAirOSIResponse:function(d,m,b){if(m){var j=Ext.util.JSON.decode(b.responseText);var h=j[this.ownerCt.osiCollectionIdentifier];if(typeof h=="undefined"){return}var l=[];for(var g=0;g<h.length;g++){j[h[g]].dataURI=h[g];l.push(j[h[g]])}var c=this.ownerCt.items.itemAt(0);var a=c.store;a.loadData(l);c.getView().refresh();this.ownerCt.items.itemAt(1).items.itemAt(2).items.itemAt(0).el.dom.innerHTML="<font color='#2c2c2c'>Process completed succesfully.</font>"}else{if(b.status==500){try{var f=new Array();f=b.responseText.split("UniversalRecordFaultMessage:");f=f[1].split("at com.tds.core.resource.pnr");this.ownerCt.items.itemAt(1).items.itemAt(2).items.itemAt(0).el.dom.innerHTML="<font color='#ff0000'>"+f[0]+"</font>"}catch(k){this.ownerCt.items.itemAt(1).items.itemAt(2).items.itemAt(0).el.dom.innerHTML="<font color='#ff0000'>Internal error try after some time.</font>";this.ownerCt.ownerCt.el.unmask()}}}this.ownerCt.ownerCt.el.unmask()},items:[{xtype:"textarea",name:"",forceSubmit:true,mode:"local",width:900,height:60,triggerAction:"all",editable:false,enableKeyEvents:true,displayField:"name",valueField:"",style:"margin-left: 50px; margin-bottom: 10px;",listeners:{keyup:function(){var b=99-this.getValue().length;if(b<=0){this.setValue(this.getValue().substring(0,98));this.ownerCt.items.itemAt(2).items.itemAt(0).el.dom.innerHTML="Remaining character (<font color='#ff0000'>"+0+"</font>)"}else{this.ownerCt.items.itemAt(2).items.itemAt(0).el.dom.innerHTML="Remaining character (<font color='#ff0000'>"+b+"</font>)"}}}},{xtype:"panel",height:25,width:1200,layout:"table",border:false,bodyStyle:"padding-left: 650px;",layoutConfig:{columns:4},items:[{xtype:"label",html:"Flights: ",width:100},{xtype:"combo",name:"flight",forceSubmit:true,mode:"local",width:100,fieldLabel:"Flight",triggerAction:"all",editable:false,displayField:"name",valueField:"dataURI",store:new Ext.data.SimpleStore({storeId:"OSI-STORE-flightStore",fields:["dataURI","name"],data:[]}),style:"margin-left: 5px;",listeners:{beforerender:function(){var a=this.ownerCt.ownerCt.ownerCt.ownerCt;var b=a.ownerCt.ownerCt.flightStore;this.store=b;this.ownerCt.ownerCt.ownerCt.osiDataURI=a.ownerCt.ownerCt.pnrDataURI;this.ownerCt.ownerCt.ownerCt.osiCollectionIdentifier=a.ownerCt.ownerCt.osiCollectionIdentifier}}},{xtype:"button",text:"Send",style:"margin-left: 10px;",handler:function(){var b=this.ownerCt.ownerCt.items.itemAt(0).getValue();if(b.length>99){Ext.Msg.alert("Other Service Information Alert"," Entered ("+b.length+" Character), allowed maximum 99 character .")}else{if(b==""){Ext.Msg.alert("Other Service Information Alert"," Enter OSI text to proceed.")}else{this.ownerCt.ownerCt.sendOSI()}}}},{xtype:"button",text:"Delete",style:"margin-left: 10px;",handler:function(){var c=this;var b=this.ownerCt.ownerCt.ownerCt.items.itemAt(0).getSelections();if(b.length>0){Ext.Msg.show({title:"Confirmation",msg:"Are you sure, want to delete the selected OSI.",buttons:Ext.Msg.YESNO,fn:function(d){if(d=="yes"){a()}},animEl:"elId",icon:Ext.MessageBox.QUESTION})}else{Ext.Msg.alert("Other Service Information Alert","No OSI Selected, Selecte atleat one to proceed.")}function a(){c.ownerCt.ownerCt.deleteOSI()}}}]},{xtype:"panel",height:20,width:1200,border:false,items:[{border:false,height:60,width:1200,html:""}]}]}]}