{xtype:"panel",height:250,border:false,frame:false,ssrDataURI:"",ssrCollectionIdentifier:"",items:[{xtype:"panel",height:120,border:false,frame:false,items:[{xtype:"grid",width:1200,height:110,border:true,enableColumnHide:false,enableColumnMove:false,enableColumnResize:false,enableHdMenu:false,viewConfig:{forceFit:true},sm:new Ext.grid.CheckboxSelectionModel(),store:new Ext.data.JsonStore({fields:["dataURI","carrier","createdDate","ssr","ssrDiscription","status","key","passengerURI","segmentReference","passengerName"]}),columns:[new Ext.grid.CheckboxSelectionModel(),{header:"Date",dataIndex:"createdDate",width:100,renderer:TDS.util.Format.dateSpecialRenderer(TDS.env.dateFormatDisplay)},{header:"Code",dataIndex:"ssr",width:50},{header:"dataURI",dataIndex:"dataURI",hidden:true,width:50},{header:"Special Service Request",dataIndex:"ssrDiscription",width:500},{header:"Flight No",dataIndex:"carrier",width:100},{header:"Passenger",dataIndex:"passengerName",width:300},{header:"Status",dataIndex:"status",width:100}]}],listeners:{beforerender:function(){var a=this.ownerCt.ownerCt.ownerCt.ownerCt.ssrStore;this.items.itemAt(0).store=a}}},{xtype:"panel",height:120,border:false,items:[{xtype:"panel",height:30,width:1200,layout:"table",border:false,bodyStyle:"padding-left: 20px;",layoutConfig:{columns:10},deleteSsr:function(){this.ownerCt.ownerCt.el.mask("","x-mask-loading");var e=this.ownerCt.ownerCt.items.itemAt(0).items.itemAt(0).getSelections();var h=[];var d=[];for(var c=0;c<e.length;c++){var f=e[c].data.dataURI;h[c]=f.substring(f.lastIndexOf("/")+1,f.length);d[c]=e[c].data.segmentReference}var b={selectedSSR:h,componentSelected:d};var g=TDS.env.dataPath+this.ownerCt.ownerCt.ssrDataURI+"/delete/air/SSR";Ext.Ajax.request({url:g,method:"POST",jsonData:b,callback:this.submitAirAddSsrResponse,scope:this})},sendSsr:function(){this.ownerCt.items.itemAt(2).items.itemAt(0).el.dom.innerHTML="";this.ownerCt.ownerCt.el.mask("","x-mask-loading");var b=this.items.itemAt(1).getValue();var d=this.items.itemAt(3).getValue();var f=this.items.itemAt(5).getValue();var c=this.items.itemAt(7).getValue();if(b==null||b==""||d==null||d==""||f==null||f==""){Ext.Msg.alert("Alert","Select Flight, Passenger and SSR to proceed.");this.ownerCt.ownerCt.el.unmask()}else{var g="";if(f=="DOCO"||f=="DOCA"){g="SSR "+f+" BA HK1/"+this.ownerCt.items.itemAt(1).items.itemAt(2).getValue()}else{if(f=="TKNM"||f=="DOCS"||f=="INFT"){g=this.ownerCt.items.itemAt(1).items.itemAt(2).getValue()}}var a={submitDataAsParams:true,selectedComponent:b,selectedPassenger:d,selectedSsr:f,freeFormText:g,addTomaster:c};var e=TDS.env.dataPath+this.ownerCt.ownerCt.ssrDataURI+"/add/air/SSR";Ext.Ajax.request({url:e,method:"POST",jsonData:a,callback:this.submitAirAddSsrResponse,scope:this})}},submitAirAddSsrResponse:function(d,m,b){if(m){var j=Ext.util.JSON.decode(b.responseText);var h=j[this.ownerCt.ownerCt.ssrCollectionIdentifier];if(typeof h=="undefined"){return}var l=[];for(var g=0;g<h.length;g++){j[h[g]].dataURI=h[g];l.push(j[h[g]])}var c=this.ownerCt.ownerCt.items.itemAt(0).items.itemAt(0);var a=c.store;a.loadData(l);c.getView().refresh();this.ownerCt.items.itemAt(2).items.itemAt(0).el.dom.innerHTML="<font color='#2c2c2c'>Process completed succesfully.</font>"}else{if(b.status==500){try{var f=new Array();f=b.responseText.split("UniversalRecordFaultMessage:");f=f[1].split("at com.tds.core.resource.pnr");this.ownerCt.items.itemAt(2).items.itemAt(0).el.dom.innerHTML="<font color='#ff0000'>"+f[0]+"</font>"}catch(k){this.ownerCt.items.itemAt(2).items.itemAt(0).el.dom.innerHTML="<font color='#ff0000'>Internal error try after some time.</font>";this.ownerCt.ownerCt.el.unmask()}}}this.ownerCt.ownerCt.el.unmask()},items:[{xtype:"label",html:"Flights: ",width:100},{xtype:"combo",name:"flight",forceSubmit:true,mode:"local",width:100,fieldLabel:"Flight",triggerAction:"all",editable:false,displayField:"name",valueField:"dataURI",store:new Ext.data.SimpleStore({storeId:"LAST-STORE-flightStore",fields:["dataURI","name"],data:[]}),style:"margin-left: 5px;",listeners:{beforerender:function(){var a=this.ownerCt.ownerCt.ownerCt.ownerCt;var b=a.ownerCt.ownerCt.flightStore;this.store=b}}},{xtype:"label",html:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Passengers: ",width:400,bodyStyle:"padding-left: 50px;"},{xtype:"combo",name:"passenger",forceSubmit:true,mode:"local",width:200,fieldLabel:"passenger",triggerAction:"all",editable:false,displayField:"displayName",valueField:"dataURI",store:new Ext.data.SimpleStore({storeId:"LAST-STORE-passStore",fields:["dataURI","displayName"],data:[]}),style:"margin-left: 5px;",listeners:{beforerender:function(){var a=this.ownerCt.ownerCt.ownerCt.ownerCt;var b=a.ownerCt.ownerCt.passengerStore;this.store=b;this.ownerCt.ownerCt.ownerCt.ssrDataURI=a.ownerCt.ownerCt.pnrDataURI;this.ownerCt.ownerCt.ownerCt.ssrCollectionIdentifier=a.ownerCt.ownerCt.ssrCollectionIdentifier}}},{xtype:"label",html:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SSR: ",width:400,bodyStyle:"padding-left: 50px;"},{xtype:"combo",name:"passengerSsr",forceSubmit:true,mode:"local",width:300,triggerAction:"all",editable:false,displayField:"text",valueField:"value",store:TDS.data.passengerSSRTravelPort,style:"margin-left: 5px;",listeners:{select:function(){var b=this.getValue();var a=this.ownerCt.ownerCt.items.itemAt(1);if(b=="DOCO"){a.items.itemAt(0).el.dom.innerHTML='Ex: <font  color="#ff0000">//V/9891404/LONDON/14MAR07/USA-1SMITH/JOHNMR</font><br><font color="#555555">//V/ designates a Visa as the alternate document, London is the place of issue, and DDMMMYY is the date of issue.</font>';a.show()}else{if(b=="DOCA"){a.items.itemAt(0).el.dom.innerHTML='Ex: <font  color="#ff0000">/R/US/1600 SMITH ST/HOUSTON/TX/77001</font><br><font color="#555555">/R/ designates residence and /US/ designates the country code of the address. The format of the address after the country code is to delimit each address element with a "/".</font>';a.show()}else{if(b=="TKNM"){a.items.itemAt(0).el.dom.innerHTML=' <font  color="#555555">must include ticket number.*</font><br>';a.show()}else{if(b=="DOCS"){a.items.itemAt(0).el.dom.innerHTML='<font  color="#555555">Required in specific format.*</font><br>';a.show()}else{if(b=="INFT"){a.items.itemAt(0).el.dom.innerHTML='Ex: <font  color="#ff0000">05JAN12</font><br><font  color="#555555"> NEED INFANT BIRTH DATE IN FREEFORM TEXT - ENTER AS DDMMMYY </font><br>';a.show()}else{a.items.itemAt(0).el.dom.innerHTML="";a.hide()}}}}}}}},{xtype:"label",html:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add to Master"},{xtype:"checkbox",style:"margin-left: 10px;"},{xtype:"button",text:"Send",style:"margin-left: 10px;",handler:function(){var c=this.ownerCt.items.itemAt(5).getValue();var a=this.ownerCt.ownerCt.items.itemAt(1);var b=a.items.itemAt(2).getValue();if(c=="DOCO"||c=="DOCA"||c=="TKNM"||c=="DOCS"){if(b==""){Ext.Msg.alert("Alert","enter The SSR text to proceed.")}else{this.ownerCt.sendSsr()}}else{this.ownerCt.sendSsr()}}},{xtype:"button",text:"Delete",style:"margin-left: 10px;",handler:function(){var c=this;var b=this.ownerCt.ownerCt.ownerCt.items.itemAt(0).items.itemAt(0).getSelections();if(b.length>0){Ext.Msg.show({title:"Confirmation",msg:"Are you sure, want to delete the selected SSR.",buttons:Ext.Msg.YESNO,fn:function(d){if(d=="yes"){a()}},animEl:"elId",icon:Ext.MessageBox.QUESTION})}else{Ext.Msg.alert("Alert","Select SSR which needs to be deleted.")}function a(){c.ownerCt.deleteSsr()}}}]},{xtype:"panel",width:1200,layout:"table",border:false,hidden:true,bodyStyle:"padding-left: 20px;",layoutConfig:{columns:3},items:[{border:false,width:600,html:""},{border:false,html:"SSR Text:&nbsp;&nbsp;",style:"margin-left: 55px;"},{xtype:"textfield",width:300,emptyText:"SSR Text"}]},{xtype:"panel",height:20,width:1200,border:false,items:[{border:false,height:60,width:1200,html:""}]}]}]}