{xtype:"form",border:false,getReminderFieldset:function(){return this.items.itemAt(0).items.itemAt(1).items.itemAt(0).items.itemAt(0)},beforeSubmit:function(b){if(!this.getReminderFieldset().collapsed){var d=this.getForm().findField("alarmDate");var c=this.getForm().findField("alarmTime");var f=new Date.parseDate(c.getValue(),"g:i A");var e=d.getValue();e.clearTime();var a=e.add(Date.HOUR,f.format("H")).add(Date.MINUTE,f.format("i"));b.timeHeldUntil=a.format(TDS.env.dateFormat);b.status="Set"}return b},beforeDataLoad:function(b){if(b.timeHeldUntil){var a=new Date.parseDate(b.timeHeldUntil,TDS.env.dateFormat);b.alarmDate=a;b.alarmTime=a;if(b.status=="Set"){this.getReminderFieldset().collapsed=false}}return b},items:[{xtype:"tabpanel",activeTab:0,layoutOnTabChange:true,height:300,defaults:{bodyStyle:"padding: 6px 4px 6px 4px;"},items:[{title:"Details",items:[{xtype:"panel",layout:"form",border:false,labelWidth:70,defaults:{style:"padding: 2px 4px 2px 4px;"},items:[{xtype:"textfield",name:"name",fieldLabel:"Name",bodyStyle:"padding: 2px 4px 2px 4px;",width:185},{xtype:"datefield",name:"dateFrom",fieldLabel:"Date from",enableKeyEvents:true,width:100,format:"dMy",minValue:"01/01/06"},{xtype:"datefield",name:"dateTo",fieldLabel:"Date to",enableKeyEvents:true,width:100,format:"dMy",minValue:"01/01/06"}]},{xtype:"fieldset",title:"Description",height:160,border:false,layout:"form",items:{xtype:"htmleditor",name:"description",height:120,hideLabel:true,labelSeparator:"",anchor:"100%",enableLinks:false,enableLists:false,enableSourceEdit:false,enableFontSize:false,enableFont:false,enableColors:false,enableAlignments:false}}]},{title:"Alarm",items:[{xtype:"panel",layout:"form",border:false,labelWidth:70,defaults:{style:"padding: 2px 4px 2px 4px;"},items:[{xtype:"fieldset",checkboxName:"setReminder",checkboxToggle:true,title:"Set reminder",autoHeight:true,labelWidth:110,collapsed:true,items:[{xtype:"datefield",name:"alarmDate",fieldLabel:"Date",showToday:false,width:80,format:"dMy",minValue:"01/01/06",listeners:{render:function(){if(TDS.env.serverTime){this.setMinValue(new Date(TDS.env.serverTime).clearTime())}}}},{xtype:"timefield",fieldLabel:"Time",name:"alarmTime",increment:30}]}]}]}]}]}