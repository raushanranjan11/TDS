{xtype:"panel",header:true,autoHeight:true,border:false,bodyStyle:"padding: 2px;",refreshGrid:function(){var a=this.ownerCt.findParentByType("awesomegrid");a.submitQuery(true)},items:[{layout:"column",border:false,items:[{xtype:"fieldset",height:170,columnWidth:0.6,autoScroll:true,layout:"fit",style:"padding: 2px; margin-right: 2px;",listeners:{render:function(){;var e=this.ownerCt.findParentByType("ajaxpanel");var c=Date.parseDate(e.rowRecordData.createdDate,TDS.env.dateFormat);var f=Date.parseDate(e.rowRecordData.updatedDate,TDS.env.dateFormat);var b=e.rowRecordData.ownArrangementPending;var a="";if(b){a="Arrangements Pending"}var d=['<div style="height:134px; overflow-y: auto;">',"<br/>",'<table class="x-tds-dataview"  border=1 cellpadding = 1 cellspacing=0  width="100%">',"<tr>",' <th width="25%">City</th>',' <th width="25%">Arrival Date</th>',' <th width="25%">City </th>',' <th width="25">Departure Date</th>',"</tr>","<tr>",' <td width="25%">'+e.rowRecordData.locationFromString+"</td>",' <td width="25%">'+TDS.util.Format.dateSpecial(e.rowRecordData.dateFrom,TDS.env.dateFormatDisplay)+"</td>",' <td width="25%">'+e.rowRecordData.locationToString+" </td>",' <td width="25%">'+TDS.util.Format.dateSpecial(e.rowRecordData.dateTo,TDS.env.dateFormatDisplay)+"</td>","</tr>","</table>",'<table style="width: 100%;" border=0 cellpadding = 1 cellspacing=0  >',"<tr>",'<td style="padding: 2px; width: 50%;"><div  style="height:150px; width:100%; border: solid 1px;  float:left; overflow-y: scroll; overflow-x: hidden;"><b><u>Notes:</u> <br> </b></div></th>','<td style="padding: 2px; width: 50%;"><div  style="height:150px; width:100%; border: solid 1px;  float:left; overflow-y: scroll; overflow-x: hidden;"><b><br><br><br><center><font size="3">'+a+"</font></center></b></div></th>","</tr>","</table>","</div>"];this.items.itemAt(0).html=d}},items:[{tbar:["->",{xtype:"button",buttonAlign:"right",text:"Additional Info",handler:function(){var b=this.ownerCt.findParentByType("ajaxpanel");var a=b.rowRecordData.dataURI;if(!a){return}TDS.window.setWindow({title:"Accommodation PNR",interfaceURI:"pnr/components/generic/additionalInfo.js",sourceDataURI:a+"/additionalInfo",destinationDataURI:a+"/additionalInfo"})}}],xtype:"panel",border:false,autoHeight:true,minHeight:140,autoScroll:true}]},{columnWidth:0.4,xtype:"grid",border:true,enableRowExpander:false,sessionExpandedRows:false,height:170,autoScroll:true,border:false,enableColumnHide:false,enableColumnMove:false,enableColumnResize:false,enableHdMenu:false,store:new Ext.data.JsonStore({url:"",id:"dataURI",fields:["dataURI","displayName","code","dateOfBirth","addressString","phoneNumber1","emailAddress","gender","status"]}),columns:[{header:"Name",dataIndex:"displayName",width:200,sortable:true,renderer:function(e,d,a,f,c,b){d.attr='ext:qtip= "Click to view details"';return e}},{header:"Type",dataIndex:"code",width:80},{header:"Gender",dataIndex:"gender",renderer:TDS.util.Format.gender,width:100},{header:"DOB",dataIndex:"dateOfBirth",width:100,renderer:TDS.util.Format.dateSpecialRenderer(TDS.env.dateBirthdayFormatDisplay)},{header:"Age",dataIndex:"dateOfBirth",renderer:TDS.util.Format.age,width:80}],viewConfig:{forceFit:true},listeners:{cellclick:function(c,g,d,f){if(d==0){var b=c.getStore().getAt(g);var a=b.get("dataURI");TDS.window.setWindow({buttonOK:false,title:"Passenger details",destinationDataURI:a,interfaceURI:"pnr/passenger/viewDetails.js",sourceDataURI:a})}},render:function(){this.getEl().swallowEvent(["columnmove","columnresize","headerclick","click","mouseout","rowclick","rowmousedown","rowblclick","cellblclick","sortchange","mouseup","mousedown"]);var b=this.ownerCt.findParentByType("ajaxpanel");var a=b.rowRecordData.dataURI;Ext.Ajax.request({url:TDS.env.dataPath+a+"/passengers/collection/concise",method:"GET",callback:function(f,l,d){if(l){var j=Ext.util.JSON.decode(d.responseText);var h=j[a+"/passengers"];if(typeof h=="undefined"){return}var k=[];for(var g=0;g<h.length;g++){j[h[g]].dataURI=h[g];k.push(j[h[g]])}var e=this;var c=e.store;c.loadData(k);e.getView().refresh()}},scope:this})}}},{xtype:"panel",autoHeight:true,border:false,width:150,defaults:{minWidth:100,style:"padding-bottom: 2px;"},items:[{xtype:"button",text:"Edit",handler:function(){var c=this.ownerCt.ownerCt.ownerCt;var b=this.ownerCt.findParentByType("ajaxpanel");var a=b.rowRecordData.dataURI;if(!a){return}TDS.window.setWindow({title:"Own arrangement details",interfaceURI:"pnr/components/own/create.js",sourceDataURI:a,destinationDataURI:a,buttonOK:"Submit",callback:{fn:function(d){if(d){c.refreshGrid()}},scope:this}})}},{xtype:"button",text:"Delete",handler:function(){var c=this.ownerCt.ownerCt.ownerCt;var b=this.ownerCt.findParentByType("ajaxpanel");var a=b.rowRecordData.dataURI;if(!a){return}TDS.window.setWindow({title:"Remove own arrangement",message:"Are you sure you want to remove this component?",destinationDataURI:a,data:{status:TDS.data.componentStatus.STATUS_DELETE},callback:{fn:function(d){if(d){c.refreshGrid()}},scope:this}})}},{xtype:"button",hidden:true,text:"Reset alarm",handler:function(){var c=this.ownerCt.ownerCt.ownerCt;var b=this.ownerCt.findParentByType("ajaxpanel");var a=b.rowRecordData.dataURI;if(!a){return}TDS.window.setWindow({title:"Reset alarm",interfaceURI:"pnr/components/own/alarm-reset.js",sourceDataURI:a,destinationDataURI:a,mergeData:true,data:{status:TDS.data.componentStatus.STATUS_SET},buttonOK:"Submit",callback:{fn:function(d){if(d){c.refreshGrid()}},scope:this}})}},{xtype:"button",text:"Cancel alarm",hidden:true,handler:function(){var c=this.ownerCt.ownerCt.ownerCt;var b=this.ownerCt.findParentByType("ajaxpanel");var a=b.rowRecordData.dataURI;if(!a){return}TDS.window.setWindow({title:"Dismiss alarm",message:"Are you sure you want to dismiss this alarm?",destinationDataURI:a,data:{status:TDS.data.componentStatus.STATUS_OK},callback:{fn:function(d){if(d){c.refreshGrid()}},scope:this}})}},{xtype:"timerlabel",hidden:true,runOnExpire:function(t){var p=this.ownerCt;with(p){items.itemAt(2).hide();items.itemAt(3).hide()}this.setText("Alarm has expired.")},listeners:{render:function(){var ap=this.ownerCt.findParentByType("ajaxpanel");var p=this.ownerCt;var status=ap.rowRecordData.status;if(status.toLowerCase()===TDS.data.componentStatus.STATUS_SET.toLowerCase()){var dataURI=ap.rowRecordData.dataURI;var timeHeldUntil=ap.rowRecordData.timeHeldUntil;if(!dataURI&&!timeHeldUntil){return}with(p){items.itemAt(2).show();items.itemAt(3).show()}var timer=new Ext.Timer({id:dataURI,expireTime:timeHeldUntil});var t=Ext.TimerMgr.start(timer);this.show();this.setTimer(t)}}}}]}]}]}