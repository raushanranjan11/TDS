{xtype:"form",width:850,border:false,beforeSubmit:function(b){b=this.getForm().getValues();return b},items:[{xtype:"tabpanel",activeTab:0,deferredRender:false,layoutOnTabChange:true,height:350,defaults:{bodyStyle:"padding: 6px 4px 6px 4px;"},listeners:{render:function(){}},items:[{title:"Details",items:[{xtype:"panel",layout:"form",border:false,labelWidth:120,defaults:{style:"padding: 2px 4px 2px 4px;"},listeners:{render:function(){this.findByType("label")[1].setText(this.findParentByType("awesomewindow").initialConfig.scope.findParentByType("tabpanel").getDetail("supplierName"));this.findByType("label")[3].setText(TDS.util.Format.dateSpecial(this.findParentByType("awesomewindow").initialConfig.scope.findParentByType("tabpanel").getDetail("dateFrom"),TDS.env.dateFormatDisplay));var a=this.findParentByType("awesomewindow").initialConfig.scope.findParentByType("tabpanel").getDetail("cruisePackage");this.findByType("label")[5].setText(this.findParentByType("awesomewindow").initialConfig.scope.findParentByType("tabpanel").initialConfig.config.cruiseName);;if(a==0){this.findByType("radio")[0].setValue(true)}else{this.findByType("radio")[1].setValue(true)}}},items:[{xtype:"panel",layout:"table",style:" padding-left: 34px;padding-top:5px; ",border:false,layoutConfig:{columns:4},items:[{xtype:"label",style:"font-size: 12px;font-weight: bold;",text:"Supplier :"},{xtype:"label",style:"font-size: 12px;font-weight: bold;",text:"Supplier Name"},{xtype:"label",text:"Date/Time : ",style:"padding-left:400px;font-size: 12px;font-weight: bold;"},{xtype:"label",text:""}]},{xtype:"panel",layout:"table",style:" padding-left: 34px;padding-top:5px; ",border:false,layoutConfig:{columns:4},items:[{xtype:"label",style:"font-size: 12px;font-weight: bold;",text:"Cruise  :"},{xtype:"label",style:"font-size: 12px;font-weight: bold;",text:"Cruise Name"},{xtype:"hidden",name:"offerStatus",listeners:{render:function(a){var b=this.findParentByType("awesomewindow").initialConfig.scope.config.statusOffer;a.setValue(b);}}},{xtype:"hidden",name:"cPNRdataURI",listeners:{render:function(a){this.setValue(this.findParentByType("awesomewindow").initialConfig.scope.config.cPNRdataURI)}}}]},{xtype:"panel",layout:"table",style:" padding-left: 320px;padding-top:5px; ",border:false,hideBorders:true,layoutConfig:{columns:6},items:[{xtype:"radio",name:"isCruisePackage",boxLabel:"Cruise Only",inputValue:false},{width:50},{xtype:"radio",name:"isCruisePackage",boxLabel:"Cruise Package",inputValue:true}]},{xtype:"panel",layout:"form",style:" padding-left: 10px;padding-top:5px; ",height:150,items:[{xtype:"grid",height:150,border:false,enableHdMenu:false,viewConfig:{},stateful:true,stateId:"grid",store:new Ext.data.JsonStore({url:"",identifier:"",fields:["nameString","maximumOccupancy","status","obstruct","dataURI","expireDate","position","totalPax","deckNo","price","name","deal","priceDouble","priceQuad","priceSingle","priceTriple","stateRoomType","stateRoomNumber","nameString","cdataURI","categoryName"]}),sm:new Ext.grid.RowSelectionModel({singleSelect:true}),cm:new Ext.grid.ColumnModel([{header:"Category",width:100,fixed:true,renderer:function(g,d,c,f,h,e){var b=c.get("categoryName");return b}},{header:"  Stateroom Type",dataIndex:"stateRoomType",width:100},{header:"Stateroom No.",dataIndex:"stateRoomNumber",width:100},{header:"Deck",dataIndex:"deckNo",width:60},{header:"Position",dataIndex:"position",width:60},{header:"Obstruct",dataIndex:"obstruct",width:80,fixed:true,renderer:function(g,d,c,f,h,e){var b=c.get("obstruct");if(g==true){return"YES"}else{return"NO"}}},{header:"Pax",width:70,dataIndex:"maximumOccupancy"},{header:"Total Price",width:80,dataIndex:"priceDouble",renderer:function(e,d,a,f,c,b){if(a.get("maximumOccupancy")==1){return(a.get("maximumOccupancy")*a.get("priceSingle"))}if(a.get("maximumOccupancy")==2){return(a.get("maximumOccupancy")*a.get("priceDouble"))}if(a.get("maximumOccupancy")==3){return(a.get("maximumOccupancy")*a.get("priceTriple"))}if(a.get("maximumOccupancy")==4){return(a.get("maximumOccupancy")*a.get("priceQuad"))}}},{header:"Status",dataIndex:"status",width:80,fixed:true,renderer:function(e,d,a,f,c,b){return e}},{header:"Offer Expires",width:80,dataIndex:"expireDate",renderer:Ext.util.Format.dateRenderer("dMy")}]),listeners:{beforerender:function(){},render:function(c){var a=this.findParentByType("awesomewindow").getDataURI("component");Ext.Ajax.request({url:TDS.env.dataPath+a+"/offerList",method:"GET",callback:function b(l,e,g){var f=Ext.util.JSON.decode(g.responseText);var k=f.offerList;if(typeof k=="undefined"){return}var j=[];for(var d=0;d<k.length;d++){f[k[d]].dataURI=k[d];j.push(f[k[d]])}var h=this.store;h.loadData(j)},scope:this})}}}]},{xtype:"panel",width:500,height:50,border:true,defaults:{style:"padding-left:20px;"},style:"padding-left:300px;padding-top:20px;",layout:"table",layoutConfig:{columns:6},items:[{width:20},{xtype:"radio",name:"accept",inputValue:TDS.data.componentStatus.STATUS_CONFIRMED},{html:"<b>Accept</b>",border:false,style:"padding-left:20px;padding-right:20px;"},{xtype:"radio",style:"padding-left:30px;",name:"accept",inputValue:TDS.data.componentStatus.STATUS_CANCELLED},{html:"<b>Reject</b>",border:false,style:"padding-left:20px;padding-right:20px;"}]}]}]},{title:"Passengers",items:{xtype:"panel",layout:"form",border:false,labelWidth:140,items:[{xtype:"panel",layout:"form",border:false,labelWidth:120,defaults:{style:"padding: 2px 4px 2px 4px;"},listeners:{render:function(){this.findByType("label")[1].setText(this.findParentByType("awesomewindow").initialConfig.scope.findParentByType("tabpanel").getDetail("supplierName"));this.findByType("label")[3].setText(TDS.util.Format.dateSpecial(this.findParentByType("awesomewindow").initialConfig.scope.findParentByType("tabpanel").getDetail("updatedDate"),TDS.env.dateTimeFormatDisplay));var a=this.findParentByType("awesomewindow").initialConfig.scope.findParentByType("tabpanel").getDetail("cruisePackage");a?this.findByType("label")[5].setText("Cruise Package"):this.findByType("label")[5].setText("Cruise")}},items:[{xtype:"panel",layout:"table",style:" padding-left: 34px;padding-top:5px; ",border:false,layoutConfig:{columns:4},items:[{xtype:"label",style:"font-size: 12px;font-weight: bold;",text:"Supplier :"},{xtype:"label",style:"font-size: 12px;font-weight: bold;",text:"Supplier Name"},{xtype:"label",text:"Date/Time : ",style:"padding-left:400px;font-size: 12px;font-weight: bold;"},{xtype:"label",text:""}]},{xtype:"panel",layout:"table",style:" padding-left: 34px;padding-top:5px; ",border:false,layoutConfig:{columns:4},items:[{xtype:"label",style:"font-size: 12px;font-weight: bold;",text:"Cruise  :"},{xtype:"label",style:"font-size: 12px;font-weight: bold;",text:"Cruise Name"}]},{xtype:"panel",layout:"form",style:" padding-left: 10px;padding-top:5px; ",height:200,items:[{xtype:"grid",id:"rates",height:200,border:false,enableHdMenu:false,viewConfig:{},stateful:true,stateId:"grid",store:new Ext.data.JsonStore({url:"",id:"dataURI",fields:["dataURI","displayName","code","dateOfBirth","addressString","phoneNumber1","emailAddress","gender","status","type"]}),columns:[{header:"Passenger",dataIndex:"displayName",width:200,sortable:true,renderer:function(e,d,a,f,c,b){d.attr='ext:qtip= "Click to view details"';return e}},{header:"Type",dataIndex:"code",width:80},{header:"Gender",dataIndex:"gender",renderer:TDS.util.Format.gender,width:100},{header:"DOB",dataIndex:"dateOfBirth",width:100,renderer:TDS.util.Format.dateSpecialRenderer(TDS.env.dateBirthdayFormatDisplay)},{header:"Age",dataIndex:"dateOfBirth",renderer:TDS.util.Format.age,width:80},{header:"CR/PK",dataIndex:"cruisePackage",width:80},{header:"Price",dataIndex:"totalPrice",width:80},{header:"Status",dataIndex:"status",width:100}],viewConfig:{forceFit:true},listeners:{beforerender:function(){},render:function(){var c=this.bottomToolbar;this.getSelectionModel().on("rowselect",function(){if(this.ownerCt.getSelections().length>0){c.items.itemAt(1).setDisabled(false)}},c);this.getSelectionModel().on("rowdeselect",function(){if(this.ownerCt.getSelections().length==0){c.items.itemAt(1).setDisabled(true)}},c);this.getEl().swallowEvent(["columnmove","columnresize","headerclick","click","mouseout","rowclick","rowmousedown","rowblclick","cellblclick","sortchange","mouseup","mousedown"]);var b=this.findParentByType("awesomewindow").initialConfig.scope.findParentByType("tabpanel");var a=b.getDetail("dataURI");Ext.Ajax.request({url:TDS.env.dataPath+a+"/passengers/collection/concise",method:"GET",callback:function(g,m,e){if(m){var k=Ext.util.JSON.decode(e.responseText);var j=k[a+"/passengers"];if(typeof j=="undefined"){return}var l=[];for(var h=0;h<j.length;h++){k[j[h]].dataURI=j[h];l.push(k[j[h]])}var f=this;var d=f.store;d.loadData(l);f.getView().refresh()}},scope:this})}}}]}]}]}},{title:"Extras",items:{xtype:"panel",layout:"form",border:false,labelWidth:140,items:[]}}]}]}