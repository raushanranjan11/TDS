{xtype:"form",border:false,layout:"fit",markDataDirtyOnLoad:true,items:[{xtype:"panel",border:false,layout:"column",defaults:{height:170,border:true,bodyStyle:"padding: 0 0 0 0;"},items:[{xtype:"panel",columnWidth:0.4,height:190,bodyStyle:"padding: 4px;",items:[{xtype:"tabpanel",activeTab:0,layoutOnTabChange:true,autoScroll:true,height:190,listeners:{render:function(){}},items:[{title:"General Info",layout:"form",height:160,width:100,items:{xtype:"htmleditor",id:"html2",name:"description",height:150,width:20,hideLabel:true,labelSeparator:"",anchor:"100%",enableLinks:false,enableLists:false,enableSourceEdit:false,enableFontSize:false,enableFont:false,enableColors:false,enableAlignments:false,listeners:{render:function(a){a.onDisable();a.getToolbar().hide()}}}},{title:"Included",layout:"form",items:{xtype:"htmleditor",name:"descIncluded",height:150,hideLabel:true,labelSeparator:"",anchor:"100%",enableLinks:false,enableLists:false,enableSourceEdit:false,enableFontSize:false,enableFont:false,enableColors:false,enableAlignments:false,listeners:{render:function(a){a.onDisable();a.getToolbar().hide()}}}},{title:"Port Info",layout:"fit"},{title:"Ports",items:[{xtype:"panel",layout:"form",autoScroll:true,border:true,style:"padding: 4px;overflow: auto;height: 150px;",items:[{xtype:"panel",width:500,height:100,border:true,style:"padding: 2px;",autoScroll:true,items:[{xtype:"awesomegrid",alwaysUseCollection:true,width:490,border:true,store:new Ext.data.JsonStore({url:"",id:"dataURI",fields:["travelDate","portName","travelDateDisp","arrival","departure","cruiseOfferingURI","dataURI"]}),sm:new Ext.grid.RowSelectionModel(),columns:[{header:"Day/Date",dataIndex:"travelDateDisp",renderer:function(c,b,a){if(a.get("travelDateDisp")!=""&&a.get("travelDateDisp")!=null){return c}else{var d=TDS.util.Format.dateSpecial(a.get("travelDate"),TDS.env.dateFormatDisplay);return d}}},{header:"Ports",dataIndex:"portName"},{header:"Arr",dataIndex:"arrival"},{header:"Dep",dataIndex:"departure"}],viewConfig:{forceFit:true},listeners:{beforerender:function(){},sessioninit:function(){},render:function(){}}}]},{id:"port1",html:"deckImage",style:"  padding-left:10px; ",border:false}]}]},{title:"Ship Info",items:[{xtype:"panel",layout:"column",width:500,height:160,border:true,style:"padding: 2px;",autoScroll:true,items:[{xtype:"panel",columnWidth:0.5,height:160,autoScroll:true,border:true,items:[{id:"ship1",html:"shipImage",border:true,autoScroll:true}]},{xtype:"panel",columnWidth:0.5,height:130,xtype:"htmleditor",name:"notes",height:150,width:150,hideLabel:true,labelSeparator:"",anchor:"100%",enableLinks:false,enableLists:false,enableSourceEdit:false,enableFontSize:false,enableFont:false,enableColors:false,enableAlignments:false,style:"padding: 10px;",listeners:{render:function(a){a.onDisable();a.getToolbar().hide()}}}]}]}],listeners:{render:function(){}}}]},{xtype:"panel",bodyStyle:"padding: 8px;",columnWidth:0.25,detailsTpl:new Ext.XTemplate("<p><b>Ship</b>: {shipName}</p>","<p><b>Departure city:</b> {locationFromString}</p>","<p><b>Arrival city:</b> {locationToString}</p>","<p><b>Duration:</b> {duration}</p>","<p><b>Class:</b> {cruiseClass}</p>","<p><b>Address:</b> {addressString}</p>","<p><b>Website:</b> {website}</p>")},{xtype:"panel",columnWidth:0.25,height:150,detailsTpl:new Ext.XTemplate('<div style="height:160px; width:100%; overflow-x:auto ; overflow-y: scroll; padding-left:0px;"><u><b><center>Description</center></b></u><br>{descriptionString}<div>')},{xtype:"panel",columnWidth:0.08,bodyStyle:"margin-left: 10px; margin-top: 40px;",border:false,items:{xtype:"button",text:"Print",minWidth:70,winExist:false,a:"",handler:function(){if(!this.winExist){this.winExist=true;var b=window.open("","Information Priview","height=500,width=800,left=10,top=10,resizable=yes,scrollbars=yes,toolbar=yes,menubar=no,location=no,directories=no,status=yes");b.focus();var g=this.ownerCt.findParentByType("tabpanel");var c=g.getDetail("name");var h=g.getDetail("dateFrom");h=TDS.util.Format.dateSpecial(h,TDS.env.dateFormatDisplay);var f=g.getDetail("duration");var e="";if(c!=""){e="<u><b>Name:</b></u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+c+"<br>"}if(h!=""){e+="<u><b>Departure:</b></u>&nbsp;&nbsp;"+h+"<br>"}if(f!=""&&typeof f!="undefined"){e+="<u><b>Duration:</b></u>&nbsp;&nbsp;&nbsp;&nbsp;"+f+"<br>"}var d=this.descriptionString;if(typeof d=="undefined"){d=""}else{d="<br><u><b>Description:</b></u></br>"+d}b.document.write(e+d.innerHTML);b.location.reload();b.focus();b.print();b.close();this.winExist=false}else{b.focus()}}}}]}],listeners:{render:function(){var c=this.ownerCt.findParentByType("tabpanel");var a=c.getDetail("offeringURI");var b=this;Ext.Ajax.request({url:TDS.env.dataPath+a,method:"GET",callback:function(f,l,d){if(l){try{var h=Ext.decode(d.responseText)}catch(j){}if(h){var k=b.items.itemAt(0);var m=k.items.itemAt(0);var i=k.items.itemAt(1);var g=k.items.itemAt(2);b.getForm().items.itemAt(0).setValue(h.description);b.getForm().items.itemAt(1).setValue(h.descIncluded);b.getForm().items.itemAt(2).setValue(h.notes);Ext.getCmp("port1").html='<center><img border="0" id="shipImageId" name="shipImage" src=../'+h.portGraphicImgPath+" ></center>";Ext.getCmp("ship1").html='<center style=" overflow:auto;"><img border="0"  id="shipImageId" name="shipImage" src=../'+h.shipInfoGraphicImgPath+" ></center>";if(i){i.detailsTpl.overwrite(i.body,{website:h.primaryHref,addressString:h.addressString,shipName:h.shipName,locationFromString:h.locationFromString,locationToString:h.locationToString,duration:h.duration,cruiseClass:TDS.util.Format.displayResourceName(h.cruiseClassURI)})}if(g){k.items.itemAt(3).items.itemAt(0).descriptionString=h.descriptionString;g.detailsTpl.overwrite(g.body,{descriptionString:h.descriptionString})}}}}})}}}