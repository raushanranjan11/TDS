{xtype:"panel",layout:Ext.isIE?"fit":"",autoScroll:true,bodyStyle:"padding: 8px;",tbar:["->",{xtype:"redbutton",text:"Create",handler:function(){var a=this.ownerCt.findParentByType("form");var b=this.ownerCt.ownerCt.items.itemAt(0);TDS.window.setWindow({title:"Create rail pass",information:"Please enter details of the new pass for this offering.",interfaceURI:"rail/offering/pass/create.js",postDataURI:a.getDataURI()+"/pass",requiredData:[{id:"supplier",dataURI:a.getSupplierURI()}],callback:{fn:function(c){if(c){this.submitQuery(true)}var d=Ext.StoreMgr.lookup(a.getDataURI()+"/pass");if(d){d.reload()}},scope:b}})}},{xtype:"button",text:"Copy",handler:function(){var b=this.ownerCt.findParentByType("form");var d=this.ownerCt.ownerCt.items.itemAt(0);var c=d.selModel.getSelected();if(!c){return}var a=c.get("dataURI");TDS.window.setWindow({title:"Copy rail pass",information:"This interface will create a new pass with the following details, you may edit these details before you submit.",interfaceURI:"rail/offering/pass/create.js",sourceDataURI:a,postDataURI:b.getDataURI()+"/pass",requiredData:[{id:"supplier",dataURI:b.getSupplierURI()}],buttonOK:"Submit",callback:{fn:function(e){if(e){var f=Ext.StoreMgr.lookup(b.getDataURI()+"/pass");if(f){f.reload()}this.submitQuery(true)}},scope:d}})}}],items:[{xtype:"awesomegrid",pinnable:true,enableRowExpander:false,tbar:["Pass name:",{xtype:"textfield",name:"nameLike",enableKeyEvents:true,width:120}," ","Type:",{xtype:"combo",name:"rateClassURI",mode:"local",width:110,triggerAction:"all",editable:false,displayField:"name",valueField:"dataURI",tpl:TDS.util.Templates.ComboNoLabel,store:TDS.data.getStore({dataURI:TDS.env.dataPath+"rate/classes/collection",identifier:"rate/classes",fields:["name","dataURI"]}),appendData:[{name:"All",dataURI:""}]}],store:new Ext.data.JsonStore({url:"",id:"dataURI",fields:["dataURI","pinned","name","code","homeCurrency","pricingPriceSell","pricingPriceIsNett","pricingPriceCommission","groupName","rateClassURI","rateOccupancyURI","ratePerURI","active","maximumOccupancy","validity","countriesString"]}),sm:new Ext.grid.RowSelectionModel(),cm:new Ext.grid.ColumnModel([{header:"Name",dataIndex:"name",sortable:true,width:250,fixed:true,flex:2},{header:"Countries",dataIndex:"countriesString",sortable:true,flex:3},{header:"No",dataIndex:"maximumOccupancy",flex:0.5,width:50,fixed:true,sortable:true},{header:"Validity",dataIndex:"validity",flex:1,width:250,fixed:true,sortable:true},{header:"Pax",dataIndex:"rateClassURI",flex:0.5,width:100,fixed:true,sortable:true,renderer:TDS.util.Format.displayResourceNameRenderer()},{header:"Class",dataIndex:"rateOccupancyURI",flex:1,width:100,fixed:true,sortable:true,renderer:TDS.util.Format.displayResourceNameRenderer()},{header:"Pricing",dataIndex:"pricingPriceSell",flex:1,width:150,fixed:true,sortable:true,renderer:TDS.util.Price.homeCurrencyGrossNettPriceRenderer}]),viewConfig:{forceFit:true},listeners:{toolbarinit:function(){var a=this.ownerCt.findParentByType("ajaxpanel");this.searchURI=TDS.env.dataPath+a.baseDataURI+"/pass"},rowdblclick:function(d,h,f){var b=this.ownerCt.findParentByType("form");var c=d.getStore().getAt(h);var a=c.get("dataURI");TDS.window.setWindow({title:"Update rail pass",interfaceURI:"rail/offering/pass/edit.js",sourceDataURI:a,destinationDataURI:a,buttonOK:"Submit",callback:{fn:function(e){if(e){var g=Ext.StoreMgr.lookup(b.getDataURI()+"/pass");if(g){g.reload()}this.submitQuery(true)}},scope:d}})}}}]}