{xtype:"panel",layout:Ext.isIE?"fit":"",autoScroll:true,bodyStyle:"padding: 8px;",tbar:[" ","->",{xtype:"redbutton",text:"Create",handler:function(){var d=this.ownerCt.findParentByType("form");var f=this.ownerCt.ownerCt.items.itemAt(0);var e=d.getData("nameString");TDS.window.setWindow({title:"Create rail rate",information:"Please enter details of the new rate for this offering.",interfaceURI:"railPass/offering/rate/create.js",postDataURI:d.getDataURI()+"/rates",data:{offeringName:e,name:e},requiredData:[{id:"supplier",dataURI:d.getSupplierURI()}],callback:{fn:function(a){if(a){this.submitQuery(true)}var b=Ext.StoreMgr.lookup(d.getDataURI()+"/rates");if(b){b.reload()}},scope:f}})}},{xtype:"button",text:"Copy",handler:function(){var j=this.ownerCt.findParentByType("form");var h=this.ownerCt.ownerCt.items.itemAt(0);var i=h.selModel.getSelected();var f=j.getData("nameString");if(!i){return}var g=i.get("dataURI");TDS.window.setWindow({title:"Copy rail rate",information:"This interface will create a new rate with the following details, you may edit these details before you submit.",interfaceURI:"railPass/offering/rate/create.js",sourceDataURI:g,postDataURI:j.getDataURI()+"/rates",data:{offeringName:f},requiredData:[{id:"supplier",dataURI:j.getSupplierURI()}],buttonOK:"Submit",callback:{fn:function(a){if(a){var b=Ext.StoreMgr.lookup(j.getDataURI()+"/rates");if(b){b.reload()}this.submitQuery(true)}},scope:h}})}}," ",{xtype:"button",text:"Archive",disabled:true,handler:function(){var g=this.ownerCt.findParentByType("form");var j=this.ownerCt.ownerCt.items.itemAt(0);var k=j.selModel.getSelected();if(!k){return}var h=k.get("dataURI");var i=this.getText();var l=!(j.topToolbar.items.itemAt(3).checked);TDS.window.setWindow({title:i,message:"Are you sure you want to "+i+" ?",destinationDataURI:h,data:{archived:l},callback:{fn:function(a){if(a){j.submitQuery(true)}},scope:j}})}}],items:[{xtype:"awesomegrid",pinnable:true,enableRowExpander:false,tbar:["Pax Type:",{xtype:"combo",name:"rateClassURI",mode:"local",width:110,triggerAction:"all",editable:false,displayField:"text",valueField:"value",store:TDS.data.passType}," ",{xtype:"checkbox",name:"archived",boxLabel:"Show only Archived",handler:function(){var c=this.ownerCt.ownerCt.ownerCt.ownerCt;var d=c.items.itemAt(0).topToolbar;d.items.itemAt(5).disable(true)}}],store:new Ext.data.JsonStore({url:"",id:"dataURI",fields:["dataURI","pinned","name","code","homeCurrency","pricingPriceSell","pricingPriceIsNett","pricingPriceCommission","groupName","passClass","ageRange","days","months","validityDays","validityMonths","saverMin","saverMax","passType","nameString","active","special","packagepricingPriceSell","packagepricingPriceIsNett","packagepricingPriceCommission"]}),sm:new Ext.grid.RowSelectionModel(),cm:new Ext.grid.ColumnModel([{header:"Pax Type",dataIndex:"passType",sortable:true},{header:"Age",dataIndex:"ageRange",sortable:true,width:40},{header:"Class",dataIndex:"passClass",sortable:true},{header:"Saver Min/Max",dataIndex:"saverMin",sortable:true,renderer:function(f,g,h){var a=h.get("saverMin")+" Min - "+h.get("saverMax")+" Max";if((h.get("saverMin")==0||h.get("saverMin")=="")&&(h.get("saverMax")==0||h.get("saverMax")=="")){return""}else{return a}}},{header:"Validity",dataIndex:"validityDays",sortable:true,renderer:function(f,g,h){var a=h.get("validityDays")+" Days in "+h.get("validityMonths")+" Months";if(h.get("validityDays")==0&&h.get("validityMonths")==0){return""}else{return a}}},{header:"Days",dataIndex:"days",sortable:true,renderer:function(f,g,h){var a=h.get("days")+" Days  "+h.get("months")+" Months";if(h.get("months")==0&&h.get("days")==0){return""}else{return a}}},{header:"Active",dataIndex:"active",sortable:true,renderer:TDS.util.Format.booleanRenderer},{header:"Special",dataIndex:"special",sortable:true,renderer:TDS.util.Format.booleanRenderer},{header:"Pricing",dataIndex:"pricingPriceSell",sortable:true,renderer:TDS.util.Price.homeCurrencyGrossNettPriceRenderer},{header:"Package Pricing",dataIndex:"packagepricingPriceSell",sortable:true,renderer:TDS.util.Price.homeCurrencyPackageGrossNettPriceRenderer},{header:"Own Availibility",editable:false,dataIndex:"",width:60,renderer:function(f,d,e){if(e.get("shareAvailabilitywith")==""){return'<input type="password" name="" style="border:#FFFFFF; display:compact; font:Verdana; font-weight: bold; background: none; div {text-align: lert; }; color:#ff0000" disabled value = "a">'}}}]),viewConfig:{forceFit:true},listeners:{toolbarinit:function(){var b=this.ownerCt.findParentByType("ajaxpanel");this.searchURI=TDS.env.dataPath+b.baseDataURI+"/rates"},render:function(){this.getSelectionModel().on("rowselect",function(){var f=this.items.itemAt(3).checked;var d=this.ownerCt.ownerCt.ownerCt;var e=d.items.itemAt(0).topToolbar;if(!f){e.items.itemAt(5).setDisabled(false)}else{e.items.itemAt(5).setDisabled(true)}},this.getTopToolbar());this.getSelectionModel().on("rowdeselect",function(){var c=this.ownerCt.ownerCt.ownerCt;var d=c.items.itemAt(0).topToolbar;d.items.itemAt(5).setDisabled(true)},this.getTopToolbar())},rowdblclick:function(l,j,k){var n=this.ownerCt.findParentByType("form");var m=l.getStore().getAt(j);var e=n.getData("nameString");var g=m.get("dataURI");TDS.window.setWindow({title:"Update rail rate",interfaceURI:"railPass/offering/rate/edit.js",sourceDataURI:g,destinationDataURI:g,data:{offeringName:e},buttonOK:"Submit",requiredData:[{id:"offeringName",name:e}],callback:{fn:function(a){if(a){var b=Ext.StoreMgr.lookup(n.getDataURI()+"/rates");if(b){b.reload()}this.submitQuery(true)}},scope:l}})}}}],listeners:{render:function(){var c=this.ownerCt.findParentByType("form");var d=c.getData("nameString");this.topToolbar.items.itemAt(0).td.innerHTML="<font color='#003399'><b>"+d+"</b></font>"}}}